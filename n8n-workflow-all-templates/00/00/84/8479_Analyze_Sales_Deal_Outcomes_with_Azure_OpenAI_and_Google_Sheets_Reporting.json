{
  "id": "INCHeFIxjP8eus8J",
  "meta": {
    "site": "https://github.com/zengfr/n8n-workflow-all-templates",
    "name": "Analyze Sales Deal Outcomes with Azure OpenAI and Google Sheets Reporting",
    "wechat": "youandme10086",
    "id": 8479,
    "update_time": "2025-11-10"
  },
  "name": "Feedback save and report generation",
  "tags": [],
  "nodes": [
    {
      "id": "e47ac8b4-ccb8-49df-82f0-05fdbff7828a",
      "name": "Extract Notes/Emails",
      "type": "n8n-nodes-base.code",
      "position": [
        16,
        112
      ],
      "parameters": {},
      "typeVersion": 2
    },
    {
      "id": "9cb26417-5674-44cb-ab6f-28c44b168094",
      "name": "Parse AI Response",
      "type": "n8n-nodes-base.code",
      "position": [
        1264,
        -224
      ],
      "parameters": {},
      "typeVersion": 2
    },
    {
      "id": "60a74709-38da-48d6-9227-eeed1734c0f6",
      "name": "Save to Google Sheets",
      "type": "n8n-nodes-base.googleSheets",
      "position": [
        1488,
        -96
      ],
      "parameters": {},
      "typeVersion": 4
    },
    {
      "id": "3f508420-a1a3-4a46-b07b-a6bd0664f789",
      "name": "Fetch Google Sheet Data",
      "type": "n8n-nodes-base.googleSheets",
      "position": [
        448,
        480
      ],
      "parameters": {},
      "typeVersion": 4
    },
    {
      "id": "5bb2b739-60d9-4043-9771-979ad1c593da",
      "name": "Filter Recent Data",
      "type": "n8n-nodes-base.code",
      "position": [
        1232,
        416
      ],
      "parameters": {},
      "typeVersion": 2
    },
    {
      "id": "a06f354f-3cdc-47bf-9ef3-c25b76135778",
      "name": "Send Email Digest",
      "type": "n8n-nodes-base.emailSend",
      "position": [
        1472,
        416
      ],
      "webhookId": "2fd9cd32-4351-49a0-ba18-310a17f086b5",
      "parameters": {},
      "typeVersion": 2
    },
    {
      "id": "073e3c65-5662-4c40-8f7c-abb1b5d54030",
      "name": "When clicking ‘Execute workflow’",
      "type": "n8n-nodes-base.manualTrigger",
      "position": [
        -432,
        112
      ],
      "parameters": {},
      "typeVersion": 1
    },
    {
      "id": "38f26876-4138-49fc-8f79-93ac5ad7876d",
      "name": "Get row(s) in sheet",
      "type": "n8n-nodes-base.googleSheets",
      "position": [
        -208,
        112
      ],
      "parameters": {},
      "typeVersion": 4.6
    },
    {
      "id": "dd009347-1c1e-4d77-880f-98a1268feab6",
      "name": "AI Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "position": [
        432,
        -368
      ],
      "parameters": {},
      "typeVersion": 2.1
    },
    {
      "id": "3914f8f7-955b-4464-9548-89f6b79f67bb",
      "name": "Azure OpenAI Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatAzureOpenAi",
      "position": [
        464,
        -208
      ],
      "parameters": {},
      "typeVersion": 1
    },
    {
      "id": "c59c230c-fb7d-47ea-aa19-210c5b65dccd",
      "name": "Loop Over Items",
      "type": "n8n-nodes-base.splitInBatches",
      "position": [
        240,
        112
      ],
      "parameters": {},
      "typeVersion": 3
    },
    {
      "id": "62ebbddb-b10b-4af2-ae56-4e642e5cd610",
      "name": "Edit Fields",
      "type": "n8n-nodes-base.set",
      "position": [
        896,
        -368
      ],
      "parameters": {},
      "typeVersion": 3.4
    },
    {
      "id": "d114ef1f-19de-49ce-92c6-df5e75c187c2",
      "name": "AI Agent1",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "position": [
        752,
        416
      ],
      "parameters": {},
      "typeVersion": 2.1
    },
    {
      "id": "5529bf2c-a211-43bb-8a1a-1c2027fb7daf",
      "name": "Azure OpenAI Chat Model1",
      "type": "@n8n/n8n-nodes-langchain.lmChatAzureOpenAi",
      "position": [
        832,
        592
      ],
      "parameters": {},
      "typeVersion": 1
    },
    {
      "id": "d1043f1a-2691-4f2f-a5e9-108431e7a7f8",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -720,
        0
      ],
      "parameters": {
        "content": ""
      },
      "typeVersion": 1
    },
    {
      "id": "d232025f-784f-4ef6-8a4d-d0b62a7bd651",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -320,
        -256
      ],
      "parameters": {
        "content": ""
      },
      "typeVersion": 1
    },
    {
      "id": "222b661a-1825-42f0-9548-b4c7a35928b5",
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -80,
        304
      ],
      "parameters": {
        "content": ""
      },
      "typeVersion": 1
    },
    {
      "id": "bfc6fdc7-1535-4849-8995-8cbabb4b4db5",
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        48,
        -320
      ],
      "parameters": {
        "content": ""
      },
      "typeVersion": 1
    },
    {
      "id": "3d1bbe23-6654-4708-9088-3e931e8da497",
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        448,
        -752
      ],
      "parameters": {
        "content": ""
      },
      "typeVersion": 1
    },
    {
      "id": "33538927-39dd-4cbe-8e7b-a8cf69bdad23",
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        592,
        -176
      ],
      "parameters": {
        "content": ""
      },
      "typeVersion": 1
    },
    {
      "id": "2bd5d02c-5fbc-4b0b-8526-3222daeef829",
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        832,
        -704
      ],
      "parameters": {
        "content": ""
      },
      "typeVersion": 1
    },
    {
      "id": "db617a0c-d9d3-4e46-b305-c471b35884e1",
      "name": "Sticky Note7",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1216,
        -608
      ],
      "parameters": {
        "content": ""
      },
      "typeVersion": 1
    },
    {
      "id": "1c2fd82b-2067-43c8-8a6b-2eaaa00e20aa",
      "name": "Sticky Note8",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1584,
        -432
      ],
      "parameters": {
        "content": ""
      },
      "typeVersion": 1
    },
    {
      "id": "e87af0fc-8734-47d6-8630-d20cee16d6bc",
      "name": "Sticky Note9",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        416,
        704
      ],
      "parameters": {
        "content": ""
      },
      "typeVersion": 1
    },
    {
      "id": "e8d0fdf6-e192-4d2d-ba57-e38f413fde9d",
      "name": "Sticky Note10",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        752,
        144
      ],
      "parameters": {
        "content": ""
      },
      "typeVersion": 1
    },
    {
      "id": "4ac6d3a4-4c29-4fea-adb8-28bff7c90f9d",
      "name": "Sticky Note11",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        800,
        752
      ],
      "parameters": {
        "content": ""
      },
      "typeVersion": 1
    },
    {
      "id": "3ecd8bc0-6e57-40c1-bee9-ecce4253097b",
      "name": "Sticky Note12",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1184,
        608
      ],
      "parameters": {
        "content": ""
      },
      "typeVersion": 1
    },
    {
      "id": "007b3968-5938-4abf-b369-16e119de46c9",
      "name": "Sticky Note13",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1664,
        256
      ],
      "parameters": {
        "content": ""
      },
      "typeVersion": 1
    }
  ],
  "active": false,
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "1552e070-ec28-47ce-b4e6-41c3fd0dd004",
  "connections": {
    "AI Agent": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent1": {
      "main": [
        [
          {
            "node": "Filter Recent Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Parse AI Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [
          {
            "node": "Fetch Google Sheet Data",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse AI Response": {
      "main": [
        [
          {
            "node": "Save to Google Sheets",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send Email Digest": {
      "main": [
        []
      ]
    },
    "Filter Recent Data": {
      "main": [
        [
          {
            "node": "Send Email Digest",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet": {
      "main": [
        [
          {
            "node": "Extract Notes/Emails",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract Notes/Emails": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Save to Google Sheets": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Azure OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Fetch Google Sheet Data": {
      "main": [
        [
          {
            "node": "AI Agent1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Azure OpenAI Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "When clicking ‘Execute workflow’": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}