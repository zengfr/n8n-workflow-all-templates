{
  "id": "uM6YAMBuMgbu0VKt",
  "meta": {
    "site": "https://github.com/zengfr/n8n-workflow-all-templates",
    "name": "Generate Business Proposals with Azure GPT-4o & Save as Gmail Drafts from Sheets",
    "wechat": "youandme10086",
    "id": 8480,
    "update_time": "2025-11-10"
  },
  "name": "Proposal generation_draft save automation",
  "tags": [],
  "nodes": [
    {
      "id": "b6261462-f2cf-4989-81f1-9303e2b805e7",
      "name": "When clicking ‘Execute workflow’",
      "type": "n8n-nodes-base.manualTrigger",
      "position": [
        -208,
        -624
      ],
      "parameters": {},
      "typeVersion": 1
    },
    {
      "id": "101bb3e2-36a1-4df7-ab49-b116abb69f86",
      "name": "Get row(s) in sheet",
      "type": "n8n-nodes-base.googleSheets",
      "position": [
        16,
        -624
      ],
      "parameters": {},
      "typeVersion": 4.6
    },
    {
      "id": "2b13049a-e27d-48d8-bb99-48beba7c7476",
      "name": "checks propsal status",
      "type": "n8n-nodes-base.if",
      "position": [
        240,
        -624
      ],
      "parameters": {},
      "typeVersion": 2.2
    },
    {
      "id": "886f8fb6-c9d0-4575-865e-ba067c8f59df",
      "name": "AI Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "position": [
        688,
        -624
      ],
      "parameters": {},
      "typeVersion": 2.1
    },
    {
      "id": "b1edd21d-e96e-4729-8726-543a6f6b58b7",
      "name": "Azure OpenAI Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatAzureOpenAi",
      "position": [
        784,
        -400
      ],
      "parameters": {},
      "typeVersion": 1
    },
    {
      "id": "372e14c9-f545-4643-b3a6-54a0439a43e5",
      "name": "Loop Over Items",
      "type": "n8n-nodes-base.splitInBatches",
      "position": [
        464,
        -624
      ],
      "parameters": {},
      "typeVersion": 3
    },
    {
      "id": "8e55578c-f6f9-40b9-8d41-b69601d9d671",
      "name": "Code",
      "type": "n8n-nodes-base.code",
      "position": [
        1072,
        -624
      ],
      "parameters": {},
      "typeVersion": 2
    },
    {
      "id": "855b8a09-9ca0-4966-8c0d-ec2078a0a75c",
      "name": "Create a draft",
      "type": "n8n-nodes-base.gmail",
      "position": [
        1312,
        -624
      ],
      "webhookId": "182ed1a5-d698-47fb-8678-3e70a062c0b0",
      "parameters": {},
      "typeVersion": 2.1
    },
    {
      "id": "1fd057dd-1793-4905-9329-ed1f8131d4ff",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -272,
        -880
      ],
      "parameters": {
        "content": ""
      },
      "typeVersion": 1
    },
    {
      "id": "2fe2308c-9a60-4b34-a465-83ba05b69be7",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -48,
        -448
      ],
      "parameters": {
        "content": ""
      },
      "typeVersion": 1
    },
    {
      "id": "082d3907-cfe6-4c1f-bacd-a83374e79246",
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        176,
        -944
      ],
      "parameters": {
        "content": ""
      },
      "typeVersion": 1
    },
    {
      "id": "84d7e086-966c-431b-9b99-847990ffc1d2",
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        400,
        -448
      ],
      "parameters": {
        "content": ""
      },
      "typeVersion": 1
    },
    {
      "id": "5b863a97-92d7-40b0-ac95-e5e8cd2cbea4",
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        688,
        -1104
      ],
      "parameters": {
        "content": ""
      },
      "typeVersion": 1
    },
    {
      "id": "305705dd-01a9-4229-a3af-00c32182b95c",
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        720,
        -256
      ],
      "parameters": {
        "content": ""
      },
      "typeVersion": 1
    },
    {
      "id": "69898e6c-54ad-4a9d-a63d-5d17376e511f",
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1008,
        -464
      ],
      "parameters": {
        "content": ""
      },
      "typeVersion": 1
    },
    {
      "id": "2409ec85-6238-468b-8e4b-3052cd1e7015",
      "name": "Sticky Note7",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1232,
        -944
      ],
      "parameters": {
        "content": ""
      },
      "typeVersion": 1
    }
  ],
  "active": false,
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "39af8b7b-2a69-4881-b93c-9edf6bbdf49f",
  "connections": {
    "Code": {
      "main": [
        [
          {
            "node": "Create a draft",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [],
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet": {
      "main": [
        [
          {
            "node": "checks propsal status",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "checks propsal status": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Azure OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "When clicking ‘Execute workflow’": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}