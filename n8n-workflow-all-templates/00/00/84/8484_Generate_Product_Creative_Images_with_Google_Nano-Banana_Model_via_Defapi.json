{
  "id": "GMfEqz8V4eeXfCDn",
  "meta": {
    "site": "https://github.com/zengfr/n8n-workflow-all-templates",
    "name": "Generate Product Creative Images with Google Nano-Banana Model via Defapi",
    "wechat": "youandme10086",
    "id": 8484,
    "update_time": "2025-11-10"
  },
  "name": "Product Creative Generator using Nano Banana API",
  "tags": [],
  "nodes": [
    {
      "id": "13d4148f-d422-4f53-8616-37be77c04fd6",
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -64,
        -192
      ],
      "parameters": {
        "color": 3,
        "width": 780,
        "height": 760,
        "content": "## Overview\nThis workflow utilizes the Defapi API with Google's Nano-Banana model to generate AI-powered product creative images from text prompts and product images. Users can interact through a simple form, providing a text prompt describing the desired creative scene, a product image URL, and their API key. The system automatically submits the request to the Defapi API, monitors the generation status in real time, and retrieves the final creative image output. This solution is ideal for marketers, product designers, e-commerce businesses, and content creators who want to quickly generate compelling product advertisements and creative visuals with minimal setup.\n\n\n## Prerequisites\n- A Defapi account and API key: Sign up at [Defapi.org](https://defapi.org) to obtain your API key.\n- An active n8n instance (cloud or self-hosted) with HTTP Request and form submission capabilities.\n- Basic knowledge of AI prompts for product creative generation to achieve optimal results.\n- A product image URL for creative generation.\n\n## Setup Instructions\n1.  **Obtain API Key**: Register at Defapi.org and generate your API key. Store it securelyâ€”do not share it publicly.\n2.  **Configure the Form**: In the \"Submit Image for Creative Generation\" node, ensure the following fields are set up: prompt (creative scene description), img_url (product image URL), api_key.\n3.  **Test the Workflow**:\n    - Click \"Execute Workflow\" in n8n.\n    - Access the generated form URL, submit your prompt, image URL, and API key.\n    - The workflow will wait 10 seconds and then poll the API status until the image generation is complete.\n4.  **Handle Outputs**: The final node formats and displays the generated creative image URL for download or embedding.\n\n## Customization Tips\n- **Enhance Prompts**: Include specifics like scene setting, lighting, style (e.g., realistic, artistic, cinematic), product placement, and visual elements to improve AI creative image quality.\n"
      },
      "typeVersion": 1
    },
    {
      "id": "c42eb223-63e1-4466-85be-a7c176cc7827",
      "name": "Obtain the generated status",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        416,
        640
      ],
      "parameters": {
        "url": "https://api.defapi.org/api/task/query",
        "options": {},
        "sendQuery": true,
        "sendHeaders": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "task_id",
              "value": "={{$json.data.task_id}}"
            }
          ]
        },
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "=Bearer {{ $('Submit Image for Creative Generation').item.json.api_key }}"
            }
          ]
        }
      },
      "typeVersion": 4.2
    },
    {
      "id": "36596c60-09d6-4229-9c44-0716a59a1b6a",
      "name": "Submit Image for Creative Generation",
      "type": "n8n-nodes-base.formTrigger",
      "position": [
        -272,
        640
      ],
      "webhookId": "791b190b-2acc-4d10-b593-c1929e67686c",
      "parameters": {
        "options": {},
        "formTitle": "AI Product Creative Generator",
        "formFields": {
          "values": [
            {
              "fieldLabel": "prompt",
              "placeholder": "Generate a gorgeous scene for this product for advertising creative"
            },
            {
              "fieldLabel": "img_url",
              "placeholder": "https://cdn.openai.com/API/docs/images/body-lotion.png"
            },
            {
              "fieldLabel": "api_key",
              "placeholder": "dk-087cc3********************"
            }
          ]
        },
        "formDescription": "Please fill in the following information to generate your creative."
      },
      "typeVersion": 2.2
    },
    {
      "id": "8c32a27f-5011-4036-b948-01a16be29348",
      "name": "Send Image Generation Request to Defapi.org API",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        -48,
        640
      ],
      "parameters": {
        "url": "https://api.defapi.org/api/image/gen",
        "method": "POST",
        "options": {},
        "jsonBody": "={\n  \"prompt\": \"{{$json.prompt}}\",\n  \"model\": \"google/nano-banana\",\n  \"images\": [\"{{ $json.img_url }}\"]\n}",
        "sendBody": true,
        "sendHeaders": true,
        "specifyBody": "json",
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "=Bearer {{ $json.api_key }}"
            }
          ]
        }
      },
      "typeVersion": 4.2
    },
    {
      "id": "33610f89-caec-46df-bcc2-82a259bc83bb",
      "name": "Wait for Image Processing Completion",
      "type": "n8n-nodes-base.wait",
      "position": [
        192,
        640
      ],
      "webhookId": "bb6c2821-9586-44b7-8606-2ee69a77ed75",
      "parameters": {
        "amount": 10
      },
      "typeVersion": 1.1
    },
    {
      "id": "d3c7114f-445c-4e03-92f9-df88d7ed79ef",
      "name": "Check if Image Generation is Complete",
      "type": "n8n-nodes-base.if",
      "position": [
        576,
        640
      ],
      "parameters": {
        "options": {},
        "conditions": {
          "options": {
            "version": 2,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "loose"
          },
          "combinator": "and",
          "conditions": [
            {
              "id": "db9a5dec-997b-4c3f-9582-37c9bbeb19ff",
              "operator": {
                "name": "filter.operator.equals",
                "type": "string",
                "operation": "equals"
              },
              "leftValue": "=true",
              "rightValue": "={{ $json.data.status == 'success' }}"
            }
          ]
        },
        "looseTypeValidation": true
      },
      "typeVersion": 2.2
    },
    {
      "id": "2fef9e5e-e875-4af0-98eb-0704c9ff581c",
      "name": "Format and Display Image Results",
      "type": "n8n-nodes-base.set",
      "position": [
        752,
        624
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "fa5f375f-cddc-4f7b-a018-67c28015d18b",
              "name": "image_url",
              "type": "string",
              "value": "={{$json.data.result[0].image}}"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "8f4ae369-fe8b-49a6-b55e-2cd73daa43e4",
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -304,
        864
      ],
      "parameters": {
        "color": 4,
        "width": 400,
        "height": 448,
        "content": "## Product Image\n![Product](https://i.imgur.com/ScdsEr2.png)"
      },
      "typeVersion": 1
    },
    {
      "id": "90067c5f-f30e-4195-ba68-da6f89632485",
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        272,
        864
      ],
      "parameters": {
        "width": 416,
        "height": 432,
        "content": "## Product Creative\n![Creative](https://i.imgur.com/KJiKE3i.png)"
      },
      "typeVersion": 1
    },
    {
      "id": "43ae9653-32cc-4c3b-ae80-9ecba7be06b7",
      "name": "Get Your Balance",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        784,
        864
      ],
      "parameters": {
        "url": "https://api.defapi.org/api/user",
        "options": {},
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "=Bearer {{ $('Submit Image for Creative Generation').item.json.api_key }}"
            }
          ]
        }
      },
      "typeVersion": 4.2
    },
    {
      "id": "66ee4b63-3333-4a55-8ff4-4e7d28ce26e4",
      "name": "Show Balance",
      "type": "n8n-nodes-base.set",
      "position": [
        784,
        1104
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "9ec6c9af-4e73-43c8-bc43-7dbef0919ee2",
              "name": "data.credit",
              "type": "string",
              "value": "={{ $json.data.credit }}"
            }
          ]
        }
      },
      "typeVersion": 3.4
    }
  ],
  "active": true,
  "pinData": {
    "Get Your Balance": [
      {
        "json": {
          "code": 0,
          "data": {
            "credit": "100.50000000"
          },
          "message": "ok"
        }
      }
    ],
    "Obtain the generated status": [
      {
        "json": {
          "code": 0,
          "data": {
            "result": [
              {
                "image": "https://google.datas.systems/fileSystem/response_images/287/2025/08/29/1756432513771985292_2989.png"
              }
            ],
            "status": "success",
            "task_id": "ta823dfb-eaac-44fd-aec2-3e2c7ba8e071",
            "consumed": "0.00100000",
            "created_at": "2025-09-10T10:22:20.010Z",
            "status_reason": {
              "message": null
            }
          },
          "message": "ok"
        }
      }
    ]
  },
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "dd1b311a-8a3d-4bd3-8c7d-a10595b6eb54",
  "connections": {
    "Get Your Balance": {
      "main": [
        [
          {
            "node": "Show Balance",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Obtain the generated status": {
      "main": [
        [
          {
            "node": "Check if Image Generation is Complete",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Format and Display Image Results": {
      "main": [
        [
          {
            "node": "Get Your Balance",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Submit Image for Creative Generation": {
      "main": [
        [
          {
            "node": "Send Image Generation Request to Defapi.org API",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait for Image Processing Completion": {
      "main": [
        [
          {
            "node": "Obtain the generated status",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check if Image Generation is Complete": {
      "main": [
        [
          {
            "node": "Format and Display Image Results",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait for Image Processing Completion",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send Image Generation Request to Defapi.org API": {
      "main": [
        [
          {
            "node": "Wait for Image Processing Completion",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}