{
  "id": "8DJFRazyCoi5r2Qs",
  "meta": {
    "site": "https://github.com/zengfr/n8n-workflow-all-templates",
    "name": "Product Visualization in Spaces with AI: Generate & Publish Videos to Social Media",
    "wechat": "youandme10086",
    "id": 7963,
    "update_time": "2025-11-10"
  },
  "name": "test items in spaces",
  "tags": [],
  "nodes": [
    {
      "id": "aebba117-b309-4eb6-a5b9-87bbc70892c1",
      "name": "Download Final Video",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        -1632,
        352
      ],
      "parameters": {
        "url": "={{ $json.video.url }}",
        "options": {
          "response": {
            "response": {}
          }
        }
      },
      "typeVersion": 4.2
    },
    {
      "id": "e1db53cd-4f6f-47a9-8829-de2103ea4387",
      "name": "Photo Upload Form",
      "type": "n8n-nodes-base.formTrigger",
      "position": [
        -3280,
        -128
      ],
      "webhookId": "animate-photo-form",
      "parameters": {
        "path": "generate-ad",
        "options": {},
        "formTitle": "Generate ads",
        "formFields": {
          "values": [
            {
              "fieldType": "file",
              "fieldLabel": "photo1",
              "multipleFiles": false,
              "requiredField": true
            },
            {
              "fieldType": "file",
              "fieldLabel": "photo2",
              "multipleFiles": false
            },
            {
              "fieldType": "textarea",
              "fieldLabel": "product description",
              "placeholder": "Describe the product"
            }
          ]
        },
        "formDescription": "Upload photo and descriptipon"
      },
      "typeVersion": 2.1
    },
    {
      "id": "46f24d2e-c441-4124-99fb-ff6dbee345c2",
      "name": "Set APIs Vars",
      "type": "n8n-nodes-base.set",
      "position": [
        -2944,
        32
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "65f5780e-7894-4d4c-b1d7-b6b922aceebe",
              "name": "number_of_images",
              "type": "number",
              "value": 1
            },
            {
              "id": "e6d64db7-8c79-4f8f-96bf-edbc1faa365d",
              "name": "size_of_image",
              "type": "string",
              "value": "1024x1024"
            },
            {
              "id": "5614f0f0-92d2-4a42-98a7-401f43308b55",
              "name": "openai_image_model",
              "type": "string",
              "value": "gemini-25-flash-image"
            },
            {
              "id": "9ab52e7d-a777-4857-96bd-ae9e06317e54",
              "name": "format_image",
              "type": "string",
              "value": "webp"
            },
            {
              "id": "a7d62af0-baf3-4349-abe9-a75b91edc3f2",
              "name": "imgbb_api_key",
              "type": "string",
              "value": "add_imgbb_api_key"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "930d680b-1fba-4c27-b72e-f5d28c0c4cf5",
      "name": "Upload Original Image to imgbb",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        -2464,
        -192
      ],
      "parameters": {
        "url": "https://api.imgbb.com/1/upload",
        "method": "POST",
        "options": {},
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "name": "image",
              "parameterType": "formBinaryData",
              "inputDataFieldName": "photo1"
            },
            {
              "name": "key",
              "value": "={{ $json.imgbb_api_key }}"
            }
          ]
        }
      },
      "retryOnFail": true,
      "typeVersion": 4.2
    },
    {
      "id": "beba7811-6ec1-481d-bc4b-632785c99e2f",
      "name": "HTTP Request",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        -1808,
        -144
      ],
      "parameters": {
        "url": "={{ $('Separate Image Outputs').item.json.url }}",
        "options": {}
      },
      "typeVersion": 4.2
    },
    {
      "id": "66ca87e7-18b3-4c48-8cfd-b36f1f58ca84",
      "name": "Set Prompts",
      "type": "n8n-nodes-base.set",
      "position": [
        -3104,
        32
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "13789e95-b7c3-4952-afaa-5b86e212b225",
              "name": "prompt-image-edit",
              "type": "string",
              "value": "=Place the painting in the room on the back wall, respecting the painting perfectly and the background room and the camera frame in the photo of the room."
            },
            {
              "id": "fb657b62-be6f-4d12-a2e5-884862394515",
              "name": "prompt-image-to-video",
              "type": "string",
              "value": "=Camera pan right and gentle truck/dolly right for the whole clip; the painting stays centered and in focus; reveal the right edge and frame depth; camera height aligned to painting center, medium-wide shot, 35 mm lens, soft gallery lighting; straight vertical lines, natural slight motion blur; no zoom"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "2b0ed58f-b9b9-442f-9226-16d9151faa32",
      "name": "Gemini 2.5 Flash - Generate Image",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        -2144,
        -144
      ],
      "parameters": {
        "url": "https://fal.run/fal-ai/gemini-25-flash-image/edit",
        "body": "={\"prompt\":\"{{ $('Set Prompts').item.json['prompt-image-edit'] }}\",\"image_urls\":[\"{{ $('Upload Original Image to imgbb').item.json.data.url }}\",\"{{ $('Upload Original Image to imgbb1').item.json.data.url }}\"],\"num_images\":{{ $('Set APIs Vars').item.json.number_of_images }}}",
        "method": "POST",
        "options": {},
        "sendBody": true,
        "contentType": "raw",
        "authentication": "genericCredentialType",
        "rawContentType": "application/json",
        "genericAuthType": "httpHeaderAuth"
      },
      "credentials": {
        "httpHeaderAuth": {
          "id": "lj8v2XS8OSqBUXwk",
          "name": "fal.ai victor"
        }
      },
      "typeVersion": 4.2
    },
    {
      "id": "538b997b-e915-4077-8a0f-5520cd0e486a",
      "name": "Separate Image Outputs",
      "type": "n8n-nodes-base.splitOut",
      "position": [
        -1984,
        -144
      ],
      "parameters": {
        "options": {},
        "fieldToSplitOut": "images"
      },
      "typeVersion": 1
    },
    {
      "id": "9e8f6fe9-31a0-406b-9475-fe5f67841d91",
      "name": "Rename to photo",
      "type": "n8n-nodes-base.code",
      "position": [
        -1632,
        -144
      ],
      "parameters": {
        "jsCode": "return items.map((i)=>({json:{url: i.json.url},binary:{photo2:i.binary.data}}));"
      },
      "typeVersion": 2
    },
    {
      "id": "a257be3e-5e7a-4f5d-96ad-9e4724e4194c",
      "name": "Upload Image to imgbb",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        -1472,
        -144
      ],
      "parameters": {
        "url": "https://api.imgbb.com/1/upload",
        "method": "POST",
        "options": {},
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "name": "image",
              "parameterType": "formBinaryData",
              "inputDataFieldName": "photo2"
            },
            {
              "name": "key",
              "value": "={{ $('Set APIs Vars').item.json.imgbb_api_key }}"
            }
          ]
        }
      },
      "retryOnFail": true,
      "typeVersion": 4.2
    },
    {
      "id": "bd8f2ee1-dc76-4cc5-80d6-23d1738e480d",
      "name": "FAL WAN i2v (Queue)",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        -2624,
        368
      ],
      "parameters": {
        "url": "https://queue.fal.run/fal-ai/wan/v2.2-a14b/image-to-video",
        "body": "={\"image_url\":\"{{ $json.data.url }}\",\"prompt\":\"{{ $('Set Prompts').item.json['prompt-image-to-video'] }}\",\"num_frames\":96,\"frames_per_second\":24,\"resolution\":\"480p\"}",
        "method": "POST",
        "options": {},
        "sendBody": true,
        "contentType": "raw",
        "authentication": "genericCredentialType",
        "rawContentType": "application/json",
        "genericAuthType": "httpHeaderAuth"
      },
      "credentials": {
        "httpHeaderAuth": {
          "id": "lj8v2XS8OSqBUXwk",
          "name": "fal.ai victor"
        }
      },
      "typeVersion": 4.2
    },
    {
      "id": "3f061e0a-d22d-485a-81ce-6add5e78a6c2",
      "name": "Wait i2v",
      "type": "n8n-nodes-base.wait",
      "position": [
        -2400,
        368
      ],
      "webhookId": "wan-i2v-wait-2",
      "parameters": {
        "amount": 30
      },
      "typeVersion": 1.1
    },
    {
      "id": "596ca482-6d5d-4c51-a057-27a97a4bb7a4",
      "name": "FAL WAN i2v (status)",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        -2240,
        368
      ],
      "parameters": {
        "url": "=https://queue.fal.run/fal-ai/wan/requests/{{ $json.request_id }}/status",
        "options": {},
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth"
      },
      "credentials": {
        "httpHeaderAuth": {
          "id": "lj8v2XS8OSqBUXwk",
          "name": "fal.ai victor"
        }
      },
      "typeVersion": 4.2
    },
    {
      "id": "d51854fc-c186-4cd6-8fcd-406f384399dd",
      "name": "Animation Completed?",
      "type": "n8n-nodes-base.if",
      "position": [
        -2080,
        368
      ],
      "parameters": {
        "options": {},
        "conditions": {
          "options": {
            "version": 2,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "combinator": "and",
          "conditions": [
            {
              "id": "animation-completed",
              "operator": {
                "name": "filter.operator.equals",
                "type": "string",
                "operation": "equals"
              },
              "leftValue": "={{ $json.status }}",
              "rightValue": "COMPLETED"
            }
          ]
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "436d7b31-d7f2-45a5-b4d2-c36c42cee1f3",
      "name": "FAL WAN i2v (Result)",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        -1824,
        352
      ],
      "parameters": {
        "url": "=https://queue.fal.run/fal-ai/wan/requests/{{ $json.request_id }}",
        "options": {},
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth"
      },
      "credentials": {
        "httpHeaderAuth": {
          "id": "lj8v2XS8OSqBUXwk",
          "name": "fal.ai victor"
        }
      },
      "typeVersion": 4.2
    },
    {
      "id": "084c3248-18ec-4d6f-bc0d-7f658262eee2",
      "name": "Merge",
      "type": "n8n-nodes-base.merge",
      "position": [
        -2768,
        -112
      ],
      "parameters": {
        "mode": "combine",
        "options": {},
        "combineBy": "combineByPosition"
      },
      "typeVersion": 3.2
    },
    {
      "id": "aeb964a8-bf86-4d1c-8b0f-364eab2f0561",
      "name": "Merge1",
      "type": "n8n-nodes-base.merge",
      "position": [
        -2288,
        -144
      ],
      "parameters": {
        "mode": "combine",
        "options": {},
        "combineBy": "combineByPosition"
      },
      "typeVersion": 3.2
    },
    {
      "id": "ba8fb65a-e792-49d5-9ad6-6893b4cb1c6a",
      "name": "Upload Original Image to imgbb1",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        -2464,
        -16
      ],
      "parameters": {
        "url": "https://api.imgbb.com/1/upload",
        "method": "POST",
        "options": {},
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "name": "image",
              "parameterType": "formBinaryData",
              "inputDataFieldName": "photo2"
            },
            {
              "name": "key",
              "value": "={{ $('Set APIs Vars').item.json.imgbb_api_key }}"
            }
          ]
        }
      },
      "retryOnFail": true,
      "typeVersion": 4.2
    },
    {
      "id": "2ffc3c85-4e32-434d-b9ba-cfa81d22cb2f",
      "name": "Upload Post",
      "type": "n8n-nodes-upload-post.uploadPost",
      "position": [
        -1424,
        352
      ],
      "parameters": {
        "user": "upload-post-user",
        "title": "Title of the post",
        "video": "data",
        "caption": "=",
        "platform": [
          "tiktok",
          "instagram",
          "youtube"
        ],
        "operation": "uploadVideo",
        "instagramMediaType": "REELS"
      },
      "credentials": {
        "uploadPostApi": {
          "id": "vVoSR7aOKLILrtEE",
          "name": "vm.caverogracia@gmail.com"
        }
      },
      "typeVersion": 1
    }
  ],
  "active": false,
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "f05f56b4-eb9d-4909-a6a6-caff142388c7",
  "connections": {
    "Merge": {
      "main": [
        [
          {
            "node": "Upload Original Image to imgbb",
            "type": "main",
            "index": 0
          },
          {
            "node": "Upload Original Image to imgbb1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge1": {
      "main": [
        [
          {
            "node": "Gemini 2.5 Flash - Generate Image",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait i2v": {
      "main": [
        [
          {
            "node": "FAL WAN i2v (status)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Prompts": {
      "main": [
        [
          {
            "node": "Set APIs Vars",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request": {
      "main": [
        [
          {
            "node": "Rename to photo",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set APIs Vars": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Rename to photo": {
      "main": [
        [
          {
            "node": "Upload Image to imgbb",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Photo Upload Form": {
      "main": [
        [
          {
            "node": "Set Prompts",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "FAL WAN i2v (Queue)": {
      "main": [
        [
          {
            "node": "Wait i2v",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Animation Completed?": {
      "main": [
        [
          {
            "node": "FAL WAN i2v (Result)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait i2v",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Download Final Video": {
      "main": [
        [
          {
            "node": "Upload Post",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "FAL WAN i2v (Result)": {
      "main": [
        [
          {
            "node": "Download Final Video",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "FAL WAN i2v (status)": {
      "main": [
        [
          {
            "node": "Animation Completed?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Upload Image to imgbb": {
      "main": [
        [
          {
            "node": "FAL WAN i2v (Queue)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Separate Image Outputs": {
      "main": [
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Upload Original Image to imgbb": {
      "main": [
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Upload Original Image to imgbb1": {
      "main": [
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Gemini 2.5 Flash - Generate Image": {
      "main": [
        [
          {
            "node": "Separate Image Outputs",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}