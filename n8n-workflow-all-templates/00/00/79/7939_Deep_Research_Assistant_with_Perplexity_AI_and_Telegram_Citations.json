{
  "meta": {
    "site": "https://github.com/zengfr/n8n-workflow-all-templates",
    "name": "Deep Research Assistant with Perplexity AI and Telegram Citations",
    "wechat": "youandme10086",
    "id": 7939,
    "update_time": "2025-11-10"
  },
  "nodes": [
    {
      "id": "c75d8927-6322-4d3e-a2a0-21e719ffc63e",
      "name": "AI Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "position": [
        -384,
        -224
      ],
      "parameters": {
        "text": "={{ $json.chatInput }} {{ $json.message.text }}",
        "options": {
          "systemMessage": "=You are a research-focused AI assistant that combines real-time web intelligence from Perplexity  to generate insightful, concise, and well-cited answers to my queries.\n\nüîß Tool Usage Logic\n\nUse the Perplexity Sonar tool for:\n\t‚Ä¢\tQuick lookups and factual summaries\n\t‚Ä¢\tDefinitions, current events, book/show/movie synopses\n\t‚Ä¢\tExplainers for theories, concepts, and popular discussions\n\t‚Ä¢\tPodcast and video summaries\n\t‚Ä¢\tTrend monitoring and fast comparisons\n\nUse the Perplexity Sonar Pro tool for:\n\t‚Ä¢\tQuestions requiring synthesis of multiple sources or expert reasoning\n\t‚Ä¢\tBusiness research (competitor analysis, investor briefs, product comparisons)\n\t‚Ä¢\tScientific or academic deep-dives\n\t‚Ä¢\tStructured summarization (transcripts, feedback, legal docs, surveys)\n\t‚Ä¢\tMarket trend analysis, job monitoring, and sentiment clustering\n\t‚Ä¢\tLong-form content aggregation across industries, geographies, or verticals\n\nüß† Output Guidelines\n\t‚Ä¢\tFocus only on answering the user‚Äôs question. Do not offer extra services unless explicitly requested.\n\t‚Ä¢\tDeliver answers in clear, structured formats\n\t‚Ä¢\tInclude citations with clickable URLs from the original sources used by Perplexity. \n\t‚Ä¢\tIf the query contains ambiguity, politely ask for clarification instead of guessing.\n\nüìå Style & Tone\n\t‚Ä¢\tMaintain a professional, neutral tone.\n\t‚Ä¢\tUse plain language for general audiences unless the context requires technical specificity.\n\t‚Ä¢\tPrioritize depth, clarity, and relevance over length.\n\t‚Ä¢\tAvoid filler language and generic intros‚Äîget straight to the value.\n\nIf I ask about a person, use Sonar Pro and in addition to all details, get links to their social profiles: Instagram, LinkedIn, and whichever others you can find."
        },
        "promptType": "define"
      },
      "typeVersion": 1.7
    },
    {
      "id": "0df084d7-379c-4a44-96c6-9faf75168485",
      "name": "OpenAI Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "position": [
        -720,
        64
      ],
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4o-mini",
          "cachedResultName": "gpt-4o-mini"
        },
        "options": {}
      },
      "credentials": {
        "openAiApi": {
          "id": "GHCe1xYUWsC8pVC6",
          "name": "OpenAi account 2"
        }
      },
      "typeVersion": 1.2
    },
    {
      "id": "00b2cd49-ab28-4148-9b5a-f11345b90e65",
      "name": "Window Buffer Memory",
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "position": [
        -416,
        48
      ],
      "parameters": {
        "sessionKey": "={{ $json.message.chat.id }}",
        "sessionIdType": "customKey"
      },
      "typeVersion": 1.3
    },
    {
      "id": "b7b7feb3-0eaf-4607-86cd-46ec16f57258",
      "name": "Perplexity Sonar",
      "type": "n8n-nodes-base.perplexityTool",
      "position": [
        -80,
        48
      ],
      "parameters": {
        "model": "sonar",
        "options": {},
        "messages": {
          "message": [
            {}
          ]
        },
        "requestOptions": {}
      },
      "credentials": {
        "perplexityApi": {
          "id": "iVyxXY6X3aKOLsni",
          "name": "Perplexity account 2"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "b88c3c4c-fc80-4f4e-baf5-2a92cafd49cb",
      "name": "Perplexity Sonar Pro",
      "type": "n8n-nodes-base.perplexityTool",
      "position": [
        128,
        48
      ],
      "parameters": {
        "model": "sonar-pro",
        "options": {},
        "messages": {
          "message": [
            {}
          ]
        },
        "requestOptions": {}
      },
      "credentials": {
        "perplexityApi": {
          "id": "iVyxXY6X3aKOLsni",
          "name": "Perplexity account 2"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "7cb5983f-c2a1-4401-9fd2-ec045c718247",
      "name": "Telegram Trigger",
      "type": "n8n-nodes-base.telegramTrigger",
      "position": [
        -992,
        -224
      ],
      "webhookId": "d7061cf0-267b-4818-883f-42972ea7672f",
      "parameters": {
        "updates": [
          "message"
        ],
        "additionalFields": {}
      },
      "typeVersion": 1.1
    },
    {
      "id": "bb263737-5be3-4807-9da3-db4e31fc1cf8",
      "name": "Telegram",
      "type": "n8n-nodes-base.telegram",
      "position": [
        -16,
        -224
      ],
      "webhookId": "e38f4bdb-0f47-45b0-a258-20cb49c3b4f4",
      "parameters": {
        "text": "={{ $json.output }}",
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "additionalFields": {}
      },
      "typeVersion": 1.2
    },
    {
      "id": "f8da851b-40f5-4bad-a6d2-fa0488c59112",
      "name": "Filter",
      "type": "n8n-nodes-base.filter",
      "position": [
        -672,
        -224
      ],
      "parameters": {
        "options": {},
        "conditions": {
          "options": {
            "version": 2,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "combinator": "and",
          "conditions": [
            {
              "id": "be4dd9dc-55f3-4668-a5e8-0205c230fb75",
              "operator": {
                "type": "number",
                "operation": "equals"
              },
              "leftValue": "={{ $json.message.from.id }}",
              "rightValue": 5675741296
            }
          ]
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "e298f904-ec98-4cc7-b599-66b044a280a2",
      "name": "Workflow Overview",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1504,
        -416
      ],
      "parameters": {
        "color": 4,
        "width": 350,
        "height": 356,
        "content": "üìã WORKFLOW OVERVIEW\n\nüîÑ FLOW:\nTelegram ‚Üí Filter ‚Üí AI Agent ‚Üí Response\n\nüîß REQUIRED SETUP:\n1. Telegram Bot Token\n2. OpenAI API Key\n3. Perplexity API Key\n4. Update user ID in filter\n\n‚ö†Ô∏è SECURITY:\n- Keep API keys secure\n- User filter prevents unauthorized access\n- Test with your user ID first"
      },
      "typeVersion": 1
    },
    {
      "id": "038365a8-bb63-4534-8dc9-6acef4f33682",
      "name": "Telegram Setup",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1088,
        -464
      ],
      "parameters": {
        "width": 300,
        "height": 406,
        "content": "üì± TELEGRAM TRIGGER SETUP\n\n1. Create a Telegram bot via @BotFather\n2. Get your bot token\n3. Add Telegram credentials in n8n\n4. Set webhook URL in bot settings\n\n‚ö†Ô∏è IMPORTANT: Update the webhook ID if importing this workflow"
      },
      "typeVersion": 1
    },
    {
      "id": "e5778cb2-410b-42f8-9516-5b75e70a0dab",
      "name": "Security Filter",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -752,
        -544
      ],
      "parameters": {
        "color": 2,
        "width": 280,
        "height": 460,
        "content": "üîí USER FILTER\n\n‚ö†Ô∏è CHANGE REQUIRED:\nUpdate the user ID (5675741296) to your Telegram user ID\n\nTo find your ID:\n1. Message @userinfobot on Telegram\n2. Replace the number in the filter condition\n\nThis prevents unauthorized access to your bot"
      },
      "typeVersion": 1
    },
    {
      "id": "1aa1f2e7-69ab-467d-9445-5c822e250d17",
      "name": "AI Agent Config",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -432,
        -624
      ],
      "parameters": {
        "color": 6,
        "width": 320,
        "height": 528,
        "content": "ü§ñ AI AGENT CORE\n\n‚öôÔ∏è CUSTOMIZATION OPTIONS:\n\n1. SYSTEM MESSAGE:\n   - Modify research focus\n   - Change response style\n   - Adjust tool usage logic\n\n2. PROMPT HANDLING:\n   - Currently uses chat input + message text\n   - Can modify input processing\n\n3. BEHAVIOR:\n   - Update guidelines for different use cases\n   - Modify citation requirements"
      },
      "typeVersion": 1
    },
    {
      "id": "261f40c0-6f40-492a-a455-f032331d0e4e",
      "name": "Telegram Response",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -96,
        -528
      ],
      "parameters": {
        "width": 280,
        "height": 444,
        "content": "üì§ TELEGRAM RESPONSE\n\nSends AI response back to user\n\n‚öôÔ∏è CUSTOMIZATION:\n- Add message formatting\n- Include parse_mode for HTML/Markdown\n- Add reply_to_message_id for threading\n- Modify response structure\n\nüí° Uses same Telegram credentials as trigger"
      },
      "typeVersion": 1
    },
    {
      "id": "11bbb9dc-ebf2-4ec1-9a9d-00e366c21d30",
      "name": "OpenAI Setup",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -816,
        16
      ],
      "parameters": {
        "color": 5,
        "width": 280,
        "height": 470,
        "content": "\n\n\n\n\n\n\n\n\n\n\n\nü§ñ OPENAI SETUP\n\n1. Get API key from OpenAI platform\n2. Add OpenAI credentials in n8n\n3. Select your preferred model\n\nüí° TIP: gpt-4o-mini is cost-effective\n\n‚öôÔ∏è CUSTOMIZATION:\n- Change model based on your needs\n- Adjust temperature in options if needed"
      },
      "typeVersion": 1
    },
    {
      "id": "5ee33d92-73d4-410d-bbfd-046633442917",
      "name": "Memory Config",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -512,
        16
      ],
      "parameters": {
        "color": 7,
        "width": 260,
        "height": 466,
        "content": "\n\n\n\n\n\n\n\n\n\n\n\n\nüß† MEMORY CONFIGURATION\n\nCurrently uses chat ID for session management\n\n‚öôÔ∏è CUSTOMIZATION OPTIONS:\n- Change session key logic\n- Adjust window size for memory\n- Modify memory type if needed\n\nThis maintains conversation context per chat"
      },
      "typeVersion": 1
    },
    {
      "id": "fcf87cde-7a38-4683-9b1a-976103daf0c9",
      "name": "Perplexity Pro",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -240,
        16
      ],
      "parameters": {
        "color": 3,
        "width": 636,
        "height": 998,
        "content": "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nüîç PERPLEXITY SONAR\n\n1. Get API key from Perplexity\n2. Add HTTP Header Auth credentials\n3. Set Authorization: Bearer YOUR_TOKEN_HERE\n\n‚öôÔ∏è CUSTOMIZATION:\n- Adjust max_tokens (currently 200)\n- Modify model if Perplexity updates\n- Change tool description for different use cases\n\nPerplexity Sonar (\"Sonar\" model):\n\n- Designed for quick lookups and factual summaries\n- Best for definitions, current events, book/show/movie synopses\n- Handles explainers for theories, concepts, and popular discussions\n- Good for podcast and video summaries\n- Efficient for trend monitoring and fast comparisons\n\n\n\nPerplexity Sonar Pro (\"Sonar Pro\" model):\n\n- Built for questions requiring synthesis of multiple sources or expert reasoning\n- Excels at business research (competitor analysis, investor briefs, product comparisons)\n- Handles scientific or academic deep-dives\n- Perfect for structured summarization (transcripts, feedback, legal docs, surveys)\n- Specialized in market trend analysis, job monitoring, and sentiment clustering\n- Manages long-form content aggregation across industries, geographies, or verticals\n\n\n\nThe AI Agent's system message specifically instructs it to choose the appropriate tool based on the complexity and type of research needed. This creates an intelligent routing system where simpler queries use the faster, more cost-effective Sonar model, while complex research tasks leverage the more powerful Sonar Pro model.\n\nYou can adjust the AI's prmopt to just use 1 or the other and disable or delete the unused node."
      },
      "typeVersion": 1
    }
  ],
  "pinData": {},
  "connections": {
    "Filter": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Telegram",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Perplexity Sonar": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Telegram Trigger": {
      "main": [
        [
          {
            "node": "Filter",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Perplexity Sonar Pro": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Window Buffer Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    }
  }
}