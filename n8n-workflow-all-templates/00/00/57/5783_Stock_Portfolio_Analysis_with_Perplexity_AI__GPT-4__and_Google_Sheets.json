{
  "id": "OKWoAjBT0s4uiubA",
  "meta": {
    "site": "https://github.com/zengfr/n8n-workflow-all-templates",
    "name": "Stock Portfolio Analysis with Perplexity AI, GPT-4, and Google Sheets",
    "wechat": "youandme10086",
    "id": 5783,
    "update_time": "2025-11-10"
  },
  "name": "Dynamic Portfolio Advisor Stock Market News",
  "tags": [],
  "nodes": [
    {
      "id": "75c3c99c-73ee-4545-aeeb-1bd47e0af8b9",
      "name": "Schedule Trigger",
      "type": "n8n-nodes-base.scheduleTrigger",
      "position": [
        -1240,
        260
      ],
      "parameters": {
        "rule": {
          "interval": [
            {
              "triggerAtHour": 10
            }
          ]
        }
      },
      "typeVersion": 1.2
    },
    {
      "id": "5dafae6c-8951-40cd-9633-92c1284a66aa",
      "name": "OpenAI Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "position": [
        -980,
        480
      ],
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1",
          "cachedResultName": "gpt-4.1"
        },
        "options": {}
      },
      "credentials": {
        "openAiApi": {
          "id": "",
          "name": "YOUR_OPENAIAPI_CREDENTIAL"
        }
      },
      "typeVersion": 1.2
    },
    {
      "id": "09c10f7f-f9a1-4ef6-a1a4-014ffc06e4ed",
      "name": "Simple Memory",
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "position": [
        -820,
        480
      ],
      "parameters": {
        "sessionKey": "={{ $workflow.id }}",
        "sessionIdType": "customKey"
      },
      "typeVersion": 1.3
    },
    {
      "id": "d905d541-fc69-4a2b-b31a-ac62a80f3978",
      "name": "Portfolio Holdings",
      "type": "n8n-nodes-base.googleSheetsTool",
      "position": [
        -640,
        480
      ],
      "parameters": {
        "options": {}
      },
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "",
          "name": "YOUR_GOOGLESHEETSOAUTH2API_CREDENTIAL"
        }
      },
      "typeVersion": 4.6
    },
    {
      "id": "f6e4c996-7c81-4662-aaba-f219cc78971c",
      "name": "Stock Market News & Analytics Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "position": [
        -860,
        260
      ],
      "parameters": {
        "text": "=Fetch the summary of the stock market news today and how it affected my portolio. Make sure that they are the most recent news, take reference to the date today: {{ $json['Readable date'] }}  by using the Perplexity Tool Search. Also give some recommendations. Start the response with \"Today is {{ $json['Readable date'] }}...\"",
        "options": {
          "systemMessage": "You are a market research assistant responsible for generating a concise yet insightful Daily Stock Market Intelligence Briefing. Your audience is an active investor with assets listed in the Portfolio Holdings Google Sheet\n\n#Tool\nUse Perplexity as the web search tool for your research.\nUse the Portfolio Holdings Google Sheet Tool to refer to current holdings of the user in order to give the most relevant output\n\nEach day, your job is to:\n\nüì∞ 1. Curate Key Market Headlines (Concise Summary Format)\nInclude 5‚Äì7 top headlines affecting the U.S. stock market. These can include:\n\nMacroeconomic indicators (CPI, interest rates, job reports, Fed decisions)\n\nMajor geopolitical developments\n\nSignificant corporate earnings\n\nFinancial sector news impacting banks (e.g., regulation, stress tests, default risks)\n\nüìà 2. Highlight Noteworthy Investing or Trading Opportunities\nIdentify any:\n\nUndervalued assets based on sentiment/news\n\nBreakouts or technical momentum setups\n\nNew AI or tech developments likely to benefit the assets listed\n\nBanking trends such as earnings strength, credit risk\n\nInclude:\n\nWhat the opportunity is\n\nWhy it matters (news or trend context)\n\nTime sensitivity (short-term/medium-term)\n\n‚ö†Ô∏è 3. Outline Key Risks or Headwinds\nInclude:\n\nMacro risks (e.g., rate hikes, inflationary concerns, China/US tensions)\n\nSector-specific concerns (e.g., chip supply for NVDA, ad spending for GOOGL/AMZN)\n\nBlack swan or tail risks (e.g., systemic banking risk, debt ceiling)\n\nüí° 4. Provide Actionable Trade Suggestions\nBased on the analysis above, suggest 1‚Äì3 potential trade actions, such as:\n\nBuy/sell/hold recommendations\n\nRebalancing ideas (e.g., shifting from tech to gold if macro risk rises)\n\nThematic ETF ideas (e.g., AI ETFs, inverse financials, S&P sector rotations)\n\nMention if the recommendation is tactical (short-term) or strategic (long-term)\n\nEach suggestion should include:\n\nThe reasoning (based on news/macro)\n\nSuggested time horizon\n\nRisk caveat or alternate view\n\n"
        },
        "promptType": "define"
      },
      "typeVersion": 2
    },
    {
      "id": "58f0c883-d2ca-414b-9b37-74557f8154d3",
      "name": "Perplexity",
      "type": "n8n-nodes-base.perplexityTool",
      "position": [
        -520,
        480
      ],
      "parameters": {
        "model": "sonar-pro",
        "options": {},
        "messages": {
          "message": [
            {
              "content": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('message0_Text', ``, 'string') }}"
            }
          ]
        },
        "simplify": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Simplify_Output', ``, 'boolean') }}",
        "requestOptions": {}
      },
      "credentials": {
        "perplexityApi": {
          "id": "",
          "name": "YOUR_PERPLEXITYAPI_CREDENTIAL"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "d93db04b-0565-4c13-a1b2-3c27552423f4",
      "name": "Telegram",
      "type": "n8n-nodes-base.telegram",
      "position": [
        -280,
        260
      ],
      "webhookId": "",
      "parameters": {
        "text": "={{ $json.output }}",
        "chatId": "\"Insert Chat ID\"",
        "additionalFields": {}
      },
      "credentials": {
        "telegramApi": {
          "id": "",
          "name": "YOUR_TELEGRAMAPI_CREDENTIAL"
        }
      },
      "typeVersion": 1.2
    },
    {
      "id": "907ac137-4c28-477f-a5cf-517552ca80ff",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1300,
        140
      ],
      "parameters": {
        "height": 580,
        "content": "Scheduled Trigger"
      },
      "typeVersion": 1
    },
    {
      "id": "d0ee23a3-6e55-4a10-bf5c-ff0d7a234628",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1040,
        140
      ],
      "parameters": {
        "color": 4,
        "width": 660,
        "height": 580,
        "content": "Stock Market Fetch & Portfolio Analysis"
      },
      "typeVersion": 1
    },
    {
      "id": "8baf92d2-c31c-4e06-8845-5a1fe8c655e4",
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -360,
        140
      ],
      "parameters": {
        "color": 5,
        "width": 300,
        "height": 580,
        "content": "Telegram Output"
      },
      "typeVersion": 1
    },
    {
      "id": "461b4d07-8f96-44ca-b5e9-3b49eb77e25d",
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2120,
        140
      ],
      "parameters": {
        "color": 6,
        "width": 800,
        "height": 1200,
        "content": "üìä Dynamic Portfolio Advisor ‚Äì Daily Stock Market Intelligence with Google Sheets\nDescription:\nThis advanced AI-powered n8n workflow automatically delivers a daily market intelligence briefing tailored to your stock holdings portfolio stored in Google Sheets. It uses real-time data from Perplexity AI, combines it with your portfolio, and generates personalized insights, risk alerts, and trade suggestions ‚Äî all delivered via Telegram or any messaging app of your choice.\n\nFor step-by-step build of workflows like this, check out:\nhttps://www.youtube.com/@Automatewithmarc\n\n‚öôÔ∏è How It Works:\nüïí Daily Trigger\n‚ÄÉStarts every day at a scheduled time (default: 10 AM) to fetch the most recent market data.\n\nüìà Holdings Fetch\n‚ÄÉReads your current portfolio dynamically from Google Sheets ‚Äî no hardcoding required.\n\nüß† AI Analysis Agent\n‚ÄÉCombines:\n\nMarket headlines\n\nCompany-specific developments\n\nMacroeconomic updates\n‚ÄÉAnd analyzes how they might affect your holdings.\n\nüîç Perplexity Web Research Tool\n‚ÄÉFinds and summarizes the most relevant stock market news from the past 24 hours.\n\nüí¨ Telegram Delivery\n‚ÄÉSends a customized summary of:\n\nMarket highlights\n\nAsset-specific impacts\n\nOpportunities and risks\n\nActionable trade ideas (buy/sell/hold)\n\nüõ†Ô∏è Tools & Integrations:\nGoogle Sheets (live holdings feed)\n\nPerplexity AI (real-time market research)\n\nOpenAI GPT (financial summarization)\n\nTelegram (output, customizable)\n\nüí° Use Cases:\nPortfolio-aware market intelligence\n\nAutomated investor briefing assistant\n\nRisk alert + opportunity scanner\n\nDaily trade idea generator\n\nFinance bloggers or equity analysts streamlining prep work\n\nüìçNote: You can easily replace Telegram with Slack, Email, Notion, or any output tool supported by n8n.\n\nThis template is perfect for active investors, financial advisors, or automation-savvy traders who want to turn AI and data into actionable daily signals."
      },
      "typeVersion": 1
    }
  ],
  "active": false,
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "d3b6b8d4-8fae-4f71-a0fb-757fe433b3ab",
  "connections": {
    "Perplexity": {
      "ai_tool": [
        [
          {
            "node": "Stock Market News & Analytics Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "Stock Market News & Analytics Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "Stock Market News & Analytics Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Stock Market News & Analytics Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Portfolio Holdings": {
      "ai_tool": [
        [
          {
            "node": "Stock Market News & Analytics Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Stock Market News & Analytics Agent": {
      "main": [
        [
          {
            "node": "Telegram",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}