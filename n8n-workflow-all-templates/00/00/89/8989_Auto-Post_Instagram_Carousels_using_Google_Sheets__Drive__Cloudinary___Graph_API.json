{
  "meta": {
    "site": "https://github.com/zengfr/n8n-workflow-all-templates",
    "name": "Auto-Post Instagram Carousels using Google Sheets, Drive, Cloudinary & Graph API",
    "wechat": "youandme10086",
    "id": 8989,
    "update_time": "2025-11-10"
  },
  "nodes": [
    {
      "id": "f0c8b3af-13db-4fdd-8cbc-46986ca7dd18",
      "name": "Get image list from a Google Drive folder1",
      "type": "n8n-nodes-base.googleDrive",
      "position": [
        1824,
        560
      ],
      "parameters": {
        "filter": {
          "folderId": {
            "__rl": true,
            "mode": "url",
            "value": "={{ $('Get Execution for Carousel').item.json.Folder }}"
          }
        },
        "options": {
          "fields": [
            "id",
            "name",
            "thumbnailLink",
            "webViewLink"
          ]
        },
        "resource": "fileFolder",
        "returnAll": true,
        "queryString": "="
      },
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "01wemhcagGbSGx8L",
          "name": "Google Drive account"
        }
      },
      "typeVersion": 3
    },
    {
      "id": "51f669e2-d933-47ce-9892-ba18bfaf92de",
      "name": "Get Execution for Carousel",
      "type": "n8n-nodes-base.googleSheets",
      "position": [
        1600,
        560
      ],
      "parameters": {
        "options": {},
        "filtersUI": {
          "values": [
            {
              "lookupValue": "ToDo",
              "lookupColumn": "Status"
            },
            {
              "lookupValue": "Carousel",
              "lookupColumn": "Type"
            }
          ]
        },
        "sheetName": {
          "__rl": true,
          "mode": "list",
          "value": 1315784118,
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WEUHeQXFMYsWVAW3DykWwpANxxD3DxH-S6c0i06dW1g/edit#gid=1315784118",
          "cachedResultName": "Execute "
        },
        "documentId": {
          "__rl": true,
          "mode": "list",
          "value": "1WEUHeQXFMYsWVAW3DykWwpANxxD3DxH-S6c0i06dW1g",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WEUHeQXFMYsWVAW3DykWwpANxxD3DxH-S6c0i06dW1g/edit?usp=drivesdk",
          "cachedResultName": "0004_Master"
        }
      },
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "cjPjcwa3RdiMAu79",
          "name": "Google Sheets account"
        }
      },
      "typeVersion": 4.6
    },
    {
      "id": "8c2b669d-9185-469f-9084-7075ffce5a90",
      "name": "Schedule Trigger",
      "type": "n8n-nodes-base.scheduleTrigger",
      "position": [
        1376,
        560
      ],
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "minutes"
            }
          ]
        }
      },
      "typeVersion": 1.2
    },
    {
      "id": "00027ef7-ece6-4b31-ad04-6508684b33ac",
      "name": "Upload images to Cloudinary",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        2272,
        560
      ],
      "parameters": {
        "url": "https://api.cloudinary.com/v1_1/<your-cloud-name>/image/upload",
        "method": "POST",
        "options": {
          "response": {
            "response": {
              "responseFormat": "json"
            }
          }
        },
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "name": "file",
              "parameterType": "formBinaryData",
              "inputDataFieldName": "data"
            },
            {
              "name": "upload_preset",
              "value": "<your_upload_preset>"
            }
          ]
        }
      },
      "typeVersion": 4.2
    },
    {
      "id": "7b22ae20-73c9-44f0-8f87-673836a47a25",
      "name": "Setup for Instagram (access token, ig_business_id)",
      "type": "n8n-nodes-base.set",
      "position": [
        1248,
        832
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "5b2dad43-2ec9-4bc0-8427-c9bab6a5fc2c",
              "name": "access_token",
              "type": "string",
              "value": "<your-instagram-access-token>"
            },
            {
              "id": "55b08009-fd62-44b8-b21e-6dde6aa9594f",
              "name": "ig_user_id",
              "type": "string",
              "value": "<your-ig_user_id>"
            },
            {
              "id": "53127a63-5583-4a5b-84bf-d2efd439af2b",
              "name": "image_url",
              "type": "string",
              "value": "={{ $json.url }}"
            },
            {
              "id": "90a680ca-49c2-4b83-bbf4-45614e882c01",
              "name": "caption",
              "type": "string",
              "value": "={{ $('Get Execution for Carousel').item.json['Expected content'] }}"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "8f7f2ba9-4157-40a2-8561-17e77c74baef",
      "name": "Download Image from Google Drive (Carousel)",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        2048,
        560
      ],
      "parameters": {
        "url": "=https://drive.google.com/uc?export=download&id={{ $json.id }}",
        "options": {
          "response": {
            "response": {
              "fullResponse": true,
              "responseFormat": "file"
            }
          }
        }
      },
      "typeVersion": 4.2
    },
    {
      "id": "09cb809c-9997-413c-b94f-9203e80eaa1d",
      "name": "Create Media Container (Image)",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        1472,
        832
      ],
      "parameters": {
        "url": "=https://graph.instagram.com/v23.0/{{ $json.ig_user_id }}/media",
        "method": "POST",
        "options": {
          "response": {
            "response": {
              "fullResponse": true
            }
          }
        },
        "sendBody": true,
        "contentType": "form-urlencoded",
        "bodyParameters": {
          "parameters": [
            {
              "name": "image_url",
              "value": "={{ $json.image_url }}"
            },
            {
              "name": "caption",
              "value": "={{ $json.caption }}"
            },
            {
              "name": "access_token",
              "value": "={{ $json.access_token }}"
            }
          ]
        }
      },
      "typeVersion": 4.2
    },
    {
      "id": "d0453b3b-5c36-4a27-a808-65893674d451",
      "name": "Combine Instagram media containers",
      "type": "n8n-nodes-base.aggregate",
      "position": [
        1696,
        832
      ],
      "parameters": {
        "options": {
          "mergeLists": true
        },
        "fieldsToAggregate": {
          "fieldToAggregate": [
            {
              "fieldToAggregate": "body.id"
            }
          ]
        }
      },
      "typeVersion": 1
    },
    {
      "id": "04b3998b-3fb1-4128-a77c-7ea8029235a0",
      "name": "Create Media Container (Carousel)",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        1920,
        832
      ],
      "parameters": {
        "url": "=https://graph.instagram.com/v23.0/{{ $('Setup for Instagram (access token, ig_business_id)').first().json.ig_user_id }}/media",
        "method": "POST",
        "options": {
          "response": {
            "response": {
              "fullResponse": true
            }
          }
        },
        "sendBody": true,
        "contentType": "form-urlencoded",
        "bodyParameters": {
          "parameters": [
            {
              "name": "caption",
              "value": "={{ $('Get Execution for Carousel').item.json['Expected content'] }}"
            },
            {
              "name": "media_type",
              "value": "=CAROUSEL"
            },
            {
              "name": "children",
              "value": "={{ $json.id }}"
            },
            {
              "name": "access_token",
              "value": "={{ $('Setup for Instagram (access token, ig_business_id)').first().json.access_token }}"
            }
          ]
        }
      },
      "typeVersion": 4.2
    },
    {
      "id": "662e0de0-26b0-4045-ae9e-e2f5b630419f",
      "name": "Publish Instagram Carousel",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        2144,
        832
      ],
      "parameters": {
        "url": "=https://graph.instagram.com/v23.0/{{ $('Setup for Instagram (access token, ig_business_id)').first().json.ig_user_id }}/media_publish",
        "method": "POST",
        "options": {
          "response": {
            "response": {
              "responseFormat": "json"
            }
          }
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "creation_id",
              "value": "={{ $json.body.id }}"
            },
            {
              "name": "access_token",
              "value": "={{ $('Setup for Instagram (access token, ig_business_id)').first().json.access_token }}"
            }
          ]
        }
      },
      "typeVersion": 4.2
    },
    {
      "id": "8f4ad80f-53e2-4c86-be4a-02f4f8bb630e",
      "name": "Update Execute to \"Processed\"",
      "type": "n8n-nodes-base.googleSheets",
      "position": [
        2368,
        832
      ],
      "parameters": {
        "columns": {
          "value": {
            "Status": "Processed",
            "ExecuteId": "={{ $('Get Execution for Carousel').item.json.ExecuteId }}"
          },
          "schema": [
            {
              "id": "ExecuteId",
              "type": "string",
              "display": true,
              "removed": false,
              "required": false,
              "displayName": "ExecuteId",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Folder",
              "type": "string",
              "display": true,
              "removed": true,
              "required": false,
              "displayName": "Folder",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Expected content",
              "type": "string",
              "display": true,
              "removed": true,
              "required": false,
              "displayName": "Expected content",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Language",
              "type": "string",
              "display": true,
              "removed": true,
              "required": false,
              "displayName": "Language",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Status",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "Status",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Type",
              "type": "string",
              "display": true,
              "removed": true,
              "required": false,
              "displayName": "Type",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Schedule_at",
              "type": "string",
              "display": true,
              "removed": false,
              "required": false,
              "displayName": "Schedule_at",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "type": "string",
              "display": true,
              "removed": true,
              "readOnly": true,
              "required": false,
              "displayName": "row_number",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            }
          ],
          "mappingMode": "defineBelow",
          "matchingColumns": [
            "ExecuteId"
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {},
        "operation": "update",
        "sheetName": {
          "__rl": true,
          "mode": "list",
          "value": 1315784118,
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WEUHeQXFMYsWVAW3DykWwpANxxD3DxH-S6c0i06dW1g/edit#gid=1315784118",
          "cachedResultName": "Execute "
        },
        "documentId": {
          "__rl": true,
          "mode": "list",
          "value": "1WEUHeQXFMYsWVAW3DykWwpANxxD3DxH-S6c0i06dW1g",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WEUHeQXFMYsWVAW3DykWwpANxxD3DxH-S6c0i06dW1g/edit?usp=drivesdk",
          "cachedResultName": "0004_Master"
        }
      },
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "cjPjcwa3RdiMAu79",
          "name": "Google Sheets account"
        }
      },
      "typeVersion": 4.6
    },
    {
      "id": "32b01069-b985-4647-abaa-ac667c38e79b",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1184,
        368
      ],
      "parameters": {
        "color": 4,
        "width": 368,
        "height": 144,
        "content": "## STEP 1 · Schedule & Pick Jobs\n**Schedule Trigger** runs every X minutes.\n**Sheets (Execute)** filters rows: `Status=ToDo` + `Type=Carousel`.\nTip: use `ExecuteId` as the unique key for updates."
      },
      "typeVersion": 1
    },
    {
      "id": "13b43b13-794e-4599-a6ab-e341970bdeb9",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1728,
        368
      ],
      "parameters": {
        "color": 5,
        "width": 336,
        "content": "## STEP 2 · Collect Assets\n**Drive list** reads images from the Folder in the row.\n**HTTP download** fetches each file as binary.\nTip: private Drive files need OAuth download (or make them publicly readable)."
      },
      "typeVersion": 1
    },
    {
      "id": "31ef9def-afe5-4a94-94e9-f3f487804021",
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2176,
        400
      ],
      "parameters": {
        "color": 6,
        "width": 384,
        "height": 128,
        "content": "## STEP 3 · Host Images\n**Cloudinary upload** receives binary → returns URL.\nUse `secure_url` for Instagram.\nTip: prefer **signed uploads**; keep preset locked down."
      },
      "typeVersion": 1
    },
    {
      "id": "ffb028a5-4b45-4e0b-ba99-0f48cd17ad31",
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2496,
        592
      ],
      "parameters": {
        "color": 7,
        "height": 256,
        "content": "## STEP 4 · IG Carousel & Log\n**Set IG vars** (token, user id, caption).\nCreate **media container** per image → **Aggregate IDs** → **Create carousel** → **Publish**.\nFinally **update Sheets**: `Status=Processed` for that `ExecuteId`."
      },
      "typeVersion": 1
    }
  ],
  "pinData": {},
  "connections": {
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "Get Execution for Carousel",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Execution for Carousel": {
      "main": [
        [
          {
            "node": "Get image list from a Google Drive folder1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Publish Instagram Carousel": {
      "main": [
        [
          {
            "node": "Update Execute to \"Processed\"",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Upload images to Cloudinary": {
      "main": [
        [
          {
            "node": "Setup for Instagram (access token, ig_business_id)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create Media Container (Image)": {
      "main": [
        [
          {
            "node": "Combine Instagram media containers",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create Media Container (Carousel)": {
      "main": [
        [
          {
            "node": "Publish Instagram Carousel",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Combine Instagram media containers": {
      "main": [
        [
          {
            "node": "Create Media Container (Carousel)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get image list from a Google Drive folder1": {
      "main": [
        [
          {
            "node": "Download Image from Google Drive (Carousel)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Download Image from Google Drive (Carousel)": {
      "main": [
        [
          {
            "node": "Upload images to Cloudinary",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Setup for Instagram (access token, ig_business_id)": {
      "main": [
        [
          {
            "node": "Create Media Container (Image)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}