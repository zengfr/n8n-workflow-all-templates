{
  "id": "psPMd959SNyGJq07",
  "meta": {
    "site": "https://github.com/zengfr/n8n-workflow-all-templates",
    "name": "Automate Stripe Customer Data Transfer to KlickTipp with Dynamic Tagging Logic",
    "wechat": "youandme10086",
    "id": 9711,
    "update_time": "2025-11-10"
  },
  "name": "(Oleksandr) Transfer Stripe customers and checkout data to KlickTipp with conditional tagging",
  "tags": [],
  "nodes": [
    {
      "id": "7dc3997d-6ed4-4297-b9ed-c92714e22676",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -176,
        -176
      ],
      "parameters": {
        "color": 7,
        "width": 1068,
        "height": 728,
        "content": "## 1. Data reception & collection via Webhook & HTTP Requests"
      },
      "typeVersion": 1
    },
    {
      "id": "9e51eb19-9ea1-4e99-9c57-a7e8ea64d858",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        912,
        -176
      ],
      "parameters": {
        "color": 7,
        "width": 320,
        "height": 728,
        "content": "## 2. Saving data into contact record"
      },
      "typeVersion": 1
    },
    {
      "id": "8d4a5388-6027-485a-a5e3-878b7d61f360",
      "name": "Subscribe buyer to KlickTipp",
      "type": "CUSTOM.klicktipp",
      "notes": "Subscribes the buyer to the KlickTipp list using their payment data.",
      "position": [
        1024,
        32
      ],
      "parameters": {
        "email": "={{ $json.billing_details.email }}",
        "tagId": "13201265",
        "fields": {
          "dataFields": [
            {
              "fieldId": "field219541",
              "fieldValue": "={{ $json.amount }}"
            },
            {
              "fieldId": "field220266",
              "fieldValue": "={{ $json.receipt_url }}"
            },
            {
              "fieldId": "field219542",
              "fieldValue": "={{ $('Watch new Stripe events').item.json.data.object.id }}"
            },
            {
              "fieldId": "fieldFirstName",
              "fieldValue": "={{ \n  // Access the full name string from the JSON input\n  $json.billing_details.name\n  \n  // Remove any leading/trailing whitespace\n  ?.trim()\n  \n  // Split the name string into an array using one or more whitespace characters (handles multiple spaces)\n  .split(/\\s+/)\n  \n  // Select the first word from the array (typically the first name)\n  [0] \n}}\n"
            },
            {
              "fieldId": "fieldLastName",
              "fieldValue": "={{ \n  // Access the full name from the input JSON\n  $json.billing_details.name\n\n  // Remove any leading/trailing whitespace\n  ?.trim()\n\n  // Split the string into an array of words using any whitespace\n  .split(/\\s+/)\n\n  // Get the last word in the array — typically the last name\n  .at(-1) \n}}"
            },
            {
              "fieldId": "field219540",
              "fieldValue": "={{ $('Getting line items').item.json.data.map(item => item.description) }}\n"
            }
          ]
        },
        "listId": "358895",
        "resource": "subscriber",
        "operation": "subscribe"
      },
      "credentials": {
        "klickTippApi": {
          "id": "K9JyBdCM4SZc1cXl",
          "name": "DEMO KlickTipp account"
        }
      },
      "notesInFlow": true,
      "typeVersion": 2
    },
    {
      "id": "fc83b35f-6224-4d32-89d9-4bfe9cd0ff24",
      "name": "Getting invoice link",
      "type": "n8n-nodes-base.stripe",
      "notes": "This node gets the details from the payment in order to identify the line items and amount of the payment.",
      "position": [
        736,
        32
      ],
      "parameters": {
        "chargeId": "={{ $json.latest_charge }}",
        "resource": "charge"
      },
      "credentials": {
        "stripeApi": {
          "id": "0eu6Lo5OpkxqR4o0",
          "name": "Dev Testing Stripe account"
        }
      },
      "notesInFlow": true,
      "typeVersion": 1
    },
    {
      "id": "cbf568d0-366d-4078-8d09-05723f47e83f",
      "name": "Getting charge ID",
      "type": "n8n-nodes-base.httpRequest",
      "notes": "This node gets the charge ID from the checkout completion in order to be able to fetch the receipt url.",
      "position": [
        528,
        32
      ],
      "parameters": {
        "url": "=https://api.stripe.com/v1/payment_intents/{{ $('Watch new Stripe events').item.json.data.object.payment_intent }}",
        "options": {},
        "sendHeaders": true,
        "authentication": "predefinedCredentialType",
        "headerParameters": {
          "parameters": [
            {
              "name": "authorization",
              "value": "Basic <YOURKEY>"
            }
          ]
        },
        "nodeCredentialType": "stripeApi"
      },
      "credentials": {
        "stripeApi": {
          "id": "0eu6Lo5OpkxqR4o0",
          "name": "Dev Testing Stripe account"
        }
      },
      "notesInFlow": true,
      "typeVersion": 4.2
    },
    {
      "id": "5211e469-88c7-4e50-b3b0-a8ff8777f985",
      "name": "Getting line items",
      "type": "n8n-nodes-base.httpRequest",
      "notes": "This node gets the line items from the checkout session.",
      "position": [
        320,
        32
      ],
      "parameters": {
        "url": "=https://api.stripe.com/v1/checkout/sessions/{{ $json.data.object.id }}/line_items",
        "options": {},
        "sendHeaders": true,
        "authentication": "predefinedCredentialType",
        "headerParameters": {
          "parameters": [
            {
              "name": "Stripe-Version",
              "value": "2025-05-28.basil"
            },
            {
              "name": "authorization",
              "value": "Basic <YOURKEY>"
            }
          ]
        },
        "nodeCredentialType": "stripeApi"
      },
      "credentials": {
        "stripeApi": {
          "id": "0eu6Lo5OpkxqR4o0",
          "name": "Dev Testing Stripe account"
        }
      },
      "notesInFlow": true,
      "typeVersion": 4.2
    },
    {
      "id": "51d045cd-1ffd-4f24-8021-273cda7fd124",
      "name": "Tag contact for high-value order",
      "type": "n8n-nodes-klicktipp.klicktipp",
      "position": [
        1664,
        -64
      ],
      "parameters": {
        "email": "={{ $json.email }}",
        "tagId": [
          "13629285"
        ],
        "resource": "contact-tagging"
      },
      "credentials": {
        "klickTippApi": {
          "id": "K9JyBdCM4SZc1cXl",
          "name": "DEMO KlickTipp account"
        }
      },
      "typeVersion": 3
    },
    {
      "id": "b485e15e-aae5-4972-aaec-2633af35982c",
      "name": "Tag contact for clothing purchase",
      "type": "n8n-nodes-klicktipp.klicktipp",
      "position": [
        1664,
        128
      ],
      "parameters": {
        "email": "={{ $json.email }}",
        "tagId": [
          "13629293"
        ],
        "resource": "contact-tagging"
      },
      "credentials": {
        "klickTippApi": {
          "id": "K9JyBdCM4SZc1cXl",
          "name": "DEMO KlickTipp account"
        }
      },
      "typeVersion": 3
    },
    {
      "id": "941a5287-7a8f-4ea3-905e-1350787ece96",
      "name": "Route by SKU and total amount",
      "type": "n8n-nodes-base.switch",
      "position": [
        1344,
        32
      ],
      "parameters": {
        "rules": {
          "values": [
            {
              "outputKey": "Order Value ≥ 100",
              "conditions": {
                "options": {
                  "version": 2,
                  "leftValue": "",
                  "caseSensitive": true,
                  "typeValidation": "strict"
                },
                "combinator": "and",
                "conditions": [
                  {
                    "id": "60e8a476-a06c-4d95-9bc2-e8c621bd9a1a",
                    "operator": {
                      "type": "number",
                      "operation": "gte"
                    },
                    "leftValue": "={{ $('Getting invoice link').item.json.amount }}",
                    "rightValue": 100
                  }
                ]
              },
              "renameOutput": true
            },
            {
              "outputKey": "Order contains clothing",
              "conditions": {
                "options": {
                  "version": 2,
                  "leftValue": "",
                  "caseSensitive": true,
                  "typeValidation": "strict"
                },
                "combinator": "and",
                "conditions": [
                  {
                    "id": "c42480ed-b454-4604-a4d3-28c5c120497f",
                    "operator": {
                      "type": "boolean",
                      "operation": "true",
                      "singleValue": true
                    },
                    "leftValue": "={{\n  ($('Getting line items').item.json.data ?? []).some(it => (it.price.metadata.sku ?? '') === 'TEST-002')\n}}",
                    "rightValue": "TEST-002"
                  }
                ]
              },
              "renameOutput": true
            }
          ]
        },
        "options": {
          "allMatchingOutputs": true
        }
      },
      "typeVersion": 3.2
    },
    {
      "id": "d42a3103-dc6e-40b5-8b29-6eeeb3d16005",
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1248,
        -176
      ],
      "parameters": {
        "color": 7,
        "width": 320,
        "height": 728,
        "content": "## 3. Routing for tagging"
      },
      "typeVersion": 1
    },
    {
      "id": "63e25a4b-0f3f-42f2-b78f-f85a2f6f2a73",
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1584,
        -176
      ],
      "parameters": {
        "color": 7,
        "width": 288,
        "height": 728,
        "content": "## 4. Contact tagging"
      },
      "typeVersion": 1
    },
    {
      "id": "d1f9f780-b380-4e81-82b8-b7903197d12a",
      "name": "Transfer customers to KlickTipp",
      "type": "n8n-nodes-klicktipp.klicktipp",
      "position": [
        1024,
        304
      ],
      "parameters": {
        "email": "={{ $json.data.object.email }}",
        "fields": {
          "dataFields": [
            {
              "fieldId": "fieldFirstName",
              "fieldValue": "={{ $json.data.object.name.split(' ')[0] }}"
            },
            {
              "fieldId": "fieldLastName",
              "fieldValue": "={{ $json.data.object.name.split(' ')[1] }}"
            },
            {
              "fieldId": "fieldPhone",
              "fieldValue": "={{ $json.data.object.phone }}"
            },
            {
              "fieldId": "fieldCountry",
              "fieldValue": "={{ $json.data.object.shipping.address.country }}"
            },
            {
              "fieldId": "fieldState",
              "fieldValue": "={{ $json.data.object.shipping.address.state }}"
            },
            {
              "fieldId": "fieldCity",
              "fieldValue": "={{ $json.data.object.shipping.address.city }}"
            },
            {
              "fieldId": "fieldStreet1",
              "fieldValue": "={{ $json.data.object.shipping.address.line1 }}"
            },
            {
              "fieldId": "fieldStreet2",
              "fieldValue": "={{ $json.data.object.shipping.address.line2 }}"
            },
            {
              "fieldId": "fieldZip",
              "fieldValue": "={{ $json.data.object.shipping.address.postal_code }}"
            }
          ]
        },
        "resource": "subscriber",
        "operation": "subscribe"
      },
      "credentials": {
        "klickTippApi": {
          "id": "K9JyBdCM4SZc1cXl",
          "name": "DEMO KlickTipp account"
        }
      },
      "typeVersion": 3
    },
    {
      "id": "e3ae4550-7369-499b-875a-84a62b11f5d6",
      "name": "Route by event type",
      "type": "n8n-nodes-base.switch",
      "position": [
        96,
        176
      ],
      "parameters": {
        "rules": {
          "values": [
            {
              "outputKey": "checkout",
              "conditions": {
                "options": {
                  "version": 2,
                  "leftValue": "",
                  "caseSensitive": true,
                  "typeValidation": "strict"
                },
                "combinator": "and",
                "conditions": [
                  {
                    "id": "602621f4-64b2-4c9d-887a-69197a9668c5",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "leftValue": "={{ $json.data.object.object }}",
                    "rightValue": "checkout.session"
                  }
                ]
              },
              "renameOutput": true
            },
            {
              "outputKey": "customer",
              "conditions": {
                "options": {
                  "version": 2,
                  "leftValue": "",
                  "caseSensitive": true,
                  "typeValidation": "strict"
                },
                "combinator": "and",
                "conditions": [
                  {
                    "id": "7df2eee0-d96c-4c6d-8600-15bd6d51eb1f",
                    "operator": {
                      "name": "filter.operator.equals",
                      "type": "string",
                      "operation": "equals"
                    },
                    "leftValue": "={{ $json.data.object.object }}",
                    "rightValue": "customer"
                  }
                ]
              },
              "renameOutput": true
            }
          ]
        },
        "options": {}
      },
      "typeVersion": 3.3
    },
    {
      "id": "502785fe-92d4-4b93-8f29-8abb0c87058e",
      "name": "Watch new Stripe events",
      "type": "n8n-nodes-base.stripeTrigger",
      "position": [
        -112,
        176
      ],
      "webhookId": "0d270008-d22c-486b-8ba1-e7d68b942512",
      "parameters": {
        "events": [
          "checkout.session.completed",
          "customer.created",
          "customer.updated"
        ]
      },
      "credentials": {
        "stripeApi": {
          "id": "0eu6Lo5OpkxqR4o0",
          "name": "Dev Testing Stripe account"
        }
      },
      "notesInFlow": false,
      "typeVersion": 1
    },
    {
      "id": "7e807b8f-e2fd-4bf0-af3b-91c722a66718",
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -176,
        576
      ],
      "parameters": {
        "width": 1412,
        "height": 624,
        "content": "Community Node Disclaimer: This workflow uses KlickTipp community nodes.\n\n### How It Works\nThis workflow listens for new or updated customers and for checkout confirmations in **Stripe** and automatically creates or updates contacts in KlickTipp, enriching profiles for segmentation and automated messaging. Tags are applied dynamically: high-value orders (≥100) get a Premium Customer tag, and purchases with certain SKUs (e.g., clothing) receive product-based tags. The process keeps your database clean, accurate, and updated in real time for targeted campaigns. Perfect for digital product sellers, course creators, and service providers seeking an end-to-end automated sales confirmation process.\n\n### Setup Instructions\n1. **KlickTipp Preparation**\n      - Prepare **custom fields**\n       - `Products` (Text)\n       - `Total` (Decimal Number)\n       - `Payment ID` (Text)\n       - `Receipt URL` (URL)\n      - Prepare **tags**:\n       - `Premium customer`\n       - `Clothing buyer`\n\n2. **Credential Configuration**\n     - Connect your Stripe account using an API key from the Stripe Dashboard.\n     - Authenticate your KlickTipp connection with username/password credentials (API access required).\n\n### Customization\n- Launch upsell or membership campaigns using tags.  \n- Use KlickTipp placeholders (`[[Stripe | Products]]`, `[[Stripe | Total]]`, etc.) for dynamic emails.  \n- Route buyers to portals (e.g., Memberspot, Mentortools).  \n- Trigger CRM, Slack notification, or invoice creation.  \n"
      },
      "typeVersion": 1
    }
  ],
  "active": false,
  "pinData": {
    "Getting charge ID": [
      {
        "json": {
          "id": "pi_3SDnbMQkZguNehl71gHtsOzQ",
          "amount": 94955,
          "object": "payment_intent",
          "review": null,
          "source": null,
          "status": "succeeded",
          "created": 1759415724,
          "currency": "eur",
          "customer": null,
          "livemode": false,
          "metadata": {},
          "shipping": null,
          "processing": null,
          "application": null,
          "canceled_at": null,
          "description": null,
          "next_action": null,
          "on_behalf_of": null,
          "client_secret": "pi_3SDnbMQkZguNehl71gHtsOzQ_secret_ytIz792LObXZfYgAeFnLcOkj5",
          "latest_charge": "ch_3SDnbMQkZguNehl71W0OEYEC",
          "receipt_email": null,
          "transfer_data": null,
          "amount_details": {
            "tip": {}
          },
          "capture_method": "automatic_async",
          "payment_method": "pm_1SDnbMQkZguNehl7tjUBaVTn",
          "transfer_group": null,
          "amount_received": 94955,
          "amount_capturable": 0,
          "last_payment_error": null,
          "setup_future_usage": null,
          "cancellation_reason": null,
          "confirmation_method": "automatic",
          "presentment_details": {
            "presentment_amount": 4756502,
            "presentment_currency": "uah"
          },
          "payment_method_types": [
            "card"
          ],
          "statement_descriptor": null,
          "application_fee_amount": null,
          "payment_method_options": {
            "card": {
              "network": null,
              "installments": null,
              "mandate_options": null,
              "request_three_d_secure": "automatic"
            }
          },
          "automatic_payment_methods": null,
          "statement_descriptor_suffix": null,
          "excluded_payment_method_types": null,
          "payment_method_configuration_details": null
        }
      }
    ],
    "Getting line items": [
      {
        "json": {
          "url": "/v1/checkout/sessions/cs_test_b19OJU8hkPgCSd5eqa111cv4nE6nVSsWsBaUQjUkaLuyj00ijoih6eBqsb/line_items",
          "data": [
            {
              "id": "li_1SDnZBQkZguNehl7uEo7mgQK",
              "price": {
                "id": "price_1SDO06QkZguNehl7AvEy4xQV",
                "type": "one_time",
                "active": true,
                "object": "price",
                "created": 1759317314,
                "product": "prod_T9hOAq4f3iDjH1",
                "currency": "eur",
                "livemode": false,
                "metadata": {},
                "nickname": null,
                "recurring": null,
                "lookup_key": null,
                "tiers_mode": null,
                "unit_amount": 89900,
                "tax_behavior": "unspecified",
                "billing_scheme": "per_unit",
                "custom_unit_amount": null,
                "transform_quantity": null,
                "unit_amount_decimal": "89900"
              },
              "object": "item",
              "currency": "eur",
              "quantity": 1,
              "amount_tax": 0,
              "description": "Sleeper sofa",
              "amount_total": 89900,
              "amount_discount": 0,
              "amount_subtotal": 89900
            },
            {
              "id": "li_1SDnZBQkZguNehl7vItF3Xzu",
              "price": {
                "id": "price_1SDNfAQkZguNehl72NxYju4v",
                "type": "one_time",
                "active": true,
                "object": "price",
                "created": 1759316016,
                "product": "prod_T9h36ek0VgmIqo",
                "currency": "eur",
                "livemode": false,
                "metadata": {
                  "sku": "TEST-002",
                  "category": "clothing"
                },
                "nickname": null,
                "recurring": null,
                "lookup_key": null,
                "tiers_mode": null,
                "unit_amount": 5055,
                "tax_behavior": "unspecified",
                "billing_scheme": "per_unit",
                "custom_unit_amount": null,
                "transform_quantity": null,
                "unit_amount_decimal": "5055"
              },
              "object": "item",
              "currency": "eur",
              "quantity": 1,
              "amount_tax": 0,
              "description": "Blue Denim Look Suit Shacket",
              "amount_total": 5055,
              "amount_discount": 0,
              "amount_subtotal": 5055
            }
          ],
          "object": "list",
          "has_more": false
        }
      }
    ],
    "Getting invoice link": [
      {
        "json": {
          "id": "ch_3SDnbMQkZguNehl71W0OEYEC",
          "paid": true,
          "order": null,
          "amount": 94955,
          "object": "charge",
          "review": null,
          "source": null,
          "status": "succeeded",
          "created": 1759415725,
          "dispute": null,
          "outcome": {
            "type": "authorized",
            "reason": null,
            "risk_level": "normal",
            "risk_score": 56,
            "advice_code": null,
            "network_status": "approved_by_network",
            "seller_message": "Payment complete.",
            "network_advice_code": null,
            "network_decline_code": null
          },
          "captured": true,
          "currency": "eur",
          "customer": null,
          "disputed": false,
          "livemode": false,
          "metadata": {},
          "refunded": false,
          "shipping": null,
          "application": null,
          "description": null,
          "destination": null,
          "receipt_url": "https://pay.stripe.com/receipts/payment/CAcaFwoVYWNjdF8xUlVSOGlRa1pndU5laGw3KPab-sYGMgY8B1mjY1U6LBbCg8njSycA2GFhEuEFRqT9a6Csa7xl675faKWgaRgEPY0R6k4vP0_vH1Am",
          "failure_code": null,
          "on_behalf_of": null,
          "fraud_details": {},
          "radar_options": {},
          "receipt_email": null,
          "transfer_data": null,
          "payment_intent": "pi_3SDnbMQkZguNehl71gHtsOzQ",
          "payment_method": "pm_1SDnbMQkZguNehl7tjUBaVTn",
          "receipt_number": null,
          "transfer_group": null,
          "amount_captured": 94955,
          "amount_refunded": 0,
          "application_fee": null,
          "billing_details": {
            "name": "Oleksandr Kovalenko",
            "email": "kovalenko.odev+021023@gmail.com",
            "phone": null,
            "tax_id": null,
            "address": {
              "city": null,
              "line1": null,
              "line2": null,
              "state": null,
              "country": "UA",
              "postal_code": null
            }
          },
          "failure_message": null,
          "source_transfer": null,
          "balance_transaction": "txn_3SDnbMQkZguNehl710DXKg8M",
          "presentment_details": {
            "presentment_amount": 4756502,
            "presentment_currency": "uah"
          },
          "statement_descriptor": null,
          "application_fee_amount": null,
          "payment_method_details": {
            "card": {
              "brand": "visa",
              "last4": "4242",
              "checks": {
                "cvc_check": "pass",
                "address_line1_check": null,
                "address_postal_code_check": null
              },
              "wallet": null,
              "country": "US",
              "funding": "credit",
              "mandate": null,
              "network": "visa",
              "exp_year": 2034,
              "exp_month": 12,
              "fingerprint": "BMFeaVRQMJD9EMGx",
              "overcapture": {
                "status": "unavailable",
                "maximum_amount_capturable": 94955
              },
              "installments": null,
              "multicapture": {
                "status": "unavailable"
              },
              "network_token": {
                "used": false
              },
              "three_d_secure": null,
              "regulated_status": "unregulated",
              "amount_authorized": 94955,
              "authorization_code": "571571",
              "extended_authorization": {
                "status": "disabled"
              },
              "network_transaction_id": "667770101978682",
              "incremental_authorization": {
                "status": "unavailable"
              }
            },
            "type": "card"
          },
          "failure_balance_transaction": null,
          "statement_descriptor_suffix": null,
          "calculated_statement_descriptor": "Stripe"
        }
      }
    ],
    "Watch new Stripe events": [
      {
        "json": {
          "id": "evt_1SDixrQkZguNehl73MLuvIO1",
          "data": {
            "object": {
              "id": "cus_T9kGUP6w2jUPlY",
              "name": "Oleksandr Kovalen",
              "email": "kovalenko.odev+01103@gmail.com",
              "phone": "+3809899999912",
              "object": "customer",
              "address": {
                "city": "Kyiv",
                "line1": "Sportyvna Square, 1",
                "line2": "",
                "state": "місто Київ",
                "country": "UA",
                "postal_code": "02000"
              },
              "balance": 0,
              "created": 1759327956,
              "currency": "eur",
              "discount": null,
              "livemode": false,
              "metadata": {},
              "shipping": {
                "name": "Oleksandr Kovalen",
                "phone": "+3809899999912",
                "address": {
                  "city": "Kyiv",
                  "line1": "Sportyvna Square, 1",
                  "line2": "",
                  "state": "місто Київ",
                  "country": "UA",
                  "postal_code": "02000"
                }
              },
              "delinquent": false,
              "tax_exempt": "none",
              "test_clock": null,
              "description": null,
              "default_source": null,
              "invoice_prefix": "G42CJT6Z",
              "invoice_settings": {
                "footer": null,
                "custom_fields": null,
                "rendering_options": null,
                "default_payment_method": null
              },
              "preferred_locales": [
                "en-US"
              ]
            },
            "previous_attributes": {
              "name": "Oleksandr Koval",
              "shipping": {
                "name": "Oleksandr Koval"
              }
            }
          },
          "type": "customer.updated",
          "object": "event",
          "created": 1759397899,
          "request": {
            "id": "req_TinYdiIT4NLyNM",
            "idempotency_key": "7ff7a8c8-129b-4d6f-8861-ee795288aa7b"
          },
          "livemode": false,
          "api_version": "2025-04-30.basil",
          "pending_webhooks": 3
        }
      }
    ]
  },
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "7ee9708d-bb4f-4c2d-a55c-5158eff0a674",
  "connections": {
    "Getting charge ID": {
      "main": [
        [
          {
            "node": "Getting invoice link",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Getting line items": {
      "main": [
        [
          {
            "node": "Getting charge ID",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Route by event type": {
      "main": [
        [
          {
            "node": "Getting line items",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Transfer customers to KlickTipp",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Getting invoice link": {
      "main": [
        [
          {
            "node": "Subscribe buyer to KlickTipp",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Watch new Stripe events": {
      "main": [
        [
          {
            "node": "Route by event type",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Subscribe buyer to KlickTipp": {
      "main": [
        [
          {
            "node": "Route by SKU and total amount",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Route by SKU and total amount": {
      "main": [
        [
          {
            "node": "Tag contact for high-value order",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Tag contact for clothing purchase",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}