{
  "id": "ykXuNTlTy4GTDjOE",
  "meta": {
    "site": "https://github.com/zengfr/n8n-workflow-all-templates",
    "name": "Auto-Send Welcome Messages to Vtiger CRM Leads via Evolution API WhatsApp",
    "wechat": "youandme10086",
    "id": 6502,
    "update_time": "2025-11-10"
  },
  "name": "Auto-Send Welcome WhatsApp Message to new Vtiger Leads",
  "tags": [],
  "nodes": [
    {
      "id": "9eb3438a-721e-47b1-b05d-fbeb6e6a53f0",
      "name": "Schedule Trigger Every n Minutes",
      "type": "n8n-nodes-base.scheduleTrigger",
      "position": [
        -816,
        -208
      ],
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "minutes",
              "minutesInterval": 1
            }
          ]
        }
      },
      "typeVersion": 1.2
    },
    {
      "id": "7d90f8b4-a984-4532-8378-3188d80d4ebe",
      "name": "If there's a data returned",
      "type": "n8n-nodes-base.if",
      "position": [
        -368,
        -208
      ],
      "parameters": {
        "options": {},
        "conditions": {
          "options": {
            "version": 2,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "combinator": "and",
          "conditions": [
            {
              "id": "1a4121a1-3315-48c6-b319-be947242e291",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              },
              "leftValue": "={{ $json.result[0].id }}",
              "rightValue": ""
            }
          ]
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "48a1a508-3e84-4875-b34e-f5bc4a1ec6a3",
      "name": "No Operation, do nothing",
      "type": "n8n-nodes-base.noOp",
      "position": [
        -80,
        -16
      ],
      "parameters": {},
      "typeVersion": 1
    },
    {
      "id": "63514400-625b-4bd6-bbb3-8892e671d671",
      "name": "Enviar texto",
      "type": "n8n-nodes-evolution-api.evolutionApi",
      "position": [
        128,
        -352
      ],
      "parameters": {
        "resource": "messages-api",
        "remoteJid": "={{ $json.result[0].phone }}",
        "messageText": "=Hi {{ $json.result[0].firstname }} {{ $json.result[0].lastname }} ðŸ˜Š,\n\nWe have received your interest with our services and we well contact you soon.\n\nHave a nice day ðŸ™ðŸ’",
        "instanceName": "Ahmed560",
        "options_message": {}
      },
      "credentials": {
        "evolutionApi": {
          "id": "OfCJPxnswdkJBefM",
          "name": "Evolution account"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "7c73ab05-6c59-4f93-b354-940a2ad0e05d",
      "name": "VtigerCRM get Latest Lead",
      "type": "n8n-nodes-vtiger-crm.vtigerNode",
      "position": [
        -592,
        -208
      ],
      "parameters": {
        "query_field": "select * from Leads where cf_1090!=1 order by id desc limit 1;"
      },
      "credentials": {
        "vtigerApi": {
          "id": "GDVMGSZb4YFb0cMz",
          "name": "SaadeddinTestCRM"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "cecfb193-03b1-47ff-8849-d4c00a3f0bc6",
      "name": "VtigerCRM Update Lead to  Mark as Whatsapp Sent",
      "type": "n8n-nodes-vtiger-crm.vtigerNode",
      "position": [
        128,
        -176
      ],
      "parameters": {
        "operation": "update",
        "element_field": "={\n  \"cf_1090\": \"1\"\n}",
        "webservice_id_field": "={{ $json.result[0].id }}"
      },
      "credentials": {
        "vtigerApi": {
          "id": "GDVMGSZb4YFb0cMz",
          "name": "SaadeddinTestCRM"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "a68394bd-0580-4705-b8c8-0e5f0c033d78",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -784,
        -528
      ],
      "parameters": {
        "width": 592,
        "height": 304,
        "content": "### ðŸ¤– Auto-Send Welcome WhatsApp Message to New Vtiger Leads  \n**(Vtiger CRM + Evolution API)**\nThis workflow runs **every 1 minute** to:\n- ðŸ“¥ Get the latest lead from Vtiger CRM (not yet marked as contacted)\n- ðŸ’¬ Send a **personalized welcome WhatsApp message** using Evolution API\n- âœ… Update the lead record with a custom field to mark that the message was sent\n\n> ðŸ’¡ Requires:\n> - Evolution API (self-hosted or cloud)\n> - Community vtiger-crm and evolution-api nodes (install via Community Nodes)\n\n> ðŸ“² Ideal for sales or support teams who want to automatically greet new leads on WhatsApp and avoid duplicates."
      },
      "typeVersion": 1
    }
  ],
  "active": true,
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "24911a81-1f5f-4358-af02-d6a399d9a5e0",
  "connections": {
    "VtigerCRM get Latest Lead": {
      "main": [
        [
          {
            "node": "If there's a data returned",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If there's a data returned": {
      "main": [
        [
          {
            "node": "VtigerCRM Update Lead to  Mark as Whatsapp Sent",
            "type": "main",
            "index": 0
          },
          {
            "node": "Enviar texto",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "No Operation, do nothing",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Trigger Every n Minutes": {
      "main": [
        [
          {
            "node": "VtigerCRM get Latest Lead",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "VtigerCRM Update Lead to  Mark as Whatsapp Sent": {
      "main": [
        []
      ]
    }
  }
}