{
  "id": "3YN2Xyb63UfYpJli",
  "meta": {
    "site": "https://github.com/zengfr/n8n-workflow-all-templates",
    "name": "Automatically Save & Organize Outlook Email Attachments in OneDrive Folders",
    "wechat": "youandme10086",
    "id": 6938,
    "update_time": "2025-11-10"
  },
  "name": "Outlook Binary",
  "tags": [],
  "nodes": [
    {
      "id": "aeffad3e-df80-4ccb-98ef-2eb981f62746",
      "name": "Microsoft Outlook Trigger",
      "type": "n8n-nodes-base.microsoftOutlookTrigger",
      "position": [
        180,
        620
      ],
      "parameters": {
        "filters": {},
        "options": {
          "downloadAttachments": true
        },
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        }
      },
      "typeVersion": 1
    },
    {
      "id": "a3ba729f-52d8-4a77-b18b-4b86d3afaf6b",
      "name": "Filter",
      "type": "n8n-nodes-base.filter",
      "position": [
        400,
        620
      ],
      "parameters": {
        "options": {},
        "conditions": {
          "options": {
            "version": 2,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "combinator": "and",
          "conditions": [
            {
              "id": "ec1e823d-871a-4d1a-a120-b2f5a46523a0",
              "operator": {
                "type": "object",
                "operation": "exists",
                "singleValue": true
              },
              "leftValue": "={{ $('Microsoft Outlook Trigger').item.binary}}",
              "rightValue": ""
            }
          ]
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "20007221-e907-4ab0-bcd8-0080cf2775e8",
      "name": "Split Out",
      "type": "n8n-nodes-base.splitOut",
      "position": [
        840,
        740
      ],
      "parameters": {
        "options": {
          "includeBinary": true
        },
        "fieldToSplitOut": "$binary"
      },
      "typeVersion": 1
    },
    {
      "id": "65205775-2cea-4186-b5b2-030579e6261e",
      "name": "Create Folder",
      "type": "n8n-nodes-base.microsoftOneDrive",
      "position": [
        840,
        480
      ],
      "parameters": {
        "name": "={{ $node[\"Microsoft Outlook Trigger\"].json.subject || \"Untitled\" }} - {{ $now }}",
        "options": {},
        "resource": "folder",
        "operation": "create"
      },
      "typeVersion": 1
    },
    {
      "id": "366d28a1-1761-4e43-a6cf-41de541d7789",
      "name": "Outlook Folder Merge",
      "type": "n8n-nodes-base.merge",
      "position": [
        1140,
        620
      ],
      "parameters": {
        "mode": "combine",
        "options": {},
        "combineBy": "combineAll"
      },
      "typeVersion": 3.1
    },
    {
      "id": "e80a7a0c-72ff-4986-9a56-c4f31873e3ac",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        0,
        420
      ],
      "parameters": {
        "color": 5,
        "width": 1860,
        "height": 520,
        "content": "Outlook and Onedrive binary movement of data"
      },
      "typeVersion": 1
    },
    {
      "id": "80ef689d-6820-4fa8-8c00-7724665e9b7b",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        0,
        0
      ],
      "parameters": {
        "color": 5,
        "width": 420,
        "height": 420,
        "content": "WORKFLOW SUMMARY\n\nThis workflow is triggered every minute by new emails in Outlook. It first filters for emails that contain binary data (attachments). For such emails, it retrieves the full email content and then proceeds to create a new folder in OneDrive. Concurrently, it splits out the binary data (attachments) from the email. Finally, it merges the information about the newly created OneDrive folder with the attachment data and saves each attachment into the designated OneDrive folder."
      },
      "typeVersion": 1
    },
    {
      "id": "c53388cd-d2fe-4b6d-86b7-5129670496a4",
      "name": "Get Outlook Message",
      "type": "n8n-nodes-base.microsoftOutlook",
      "position": [
        620,
        620
      ],
      "webhookId": "fd255a4d-2b30-4883-af8b-b29ba5dbbe88",
      "parameters": {
        "options": {
          "downloadAttachments": true
        },
        "messageId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $node[\"Microsoft Outlook Trigger\"].json.id }}"
        },
        "operation": "get"
      },
      "typeVersion": 2
    },
    {
      "id": "02a6951c-eea8-4690-8aec-b795052ccceb",
      "name": "Upload File OneDrive",
      "type": "n8n-nodes-base.microsoftOneDrive",
      "position": [
        1460,
        620
      ],
      "parameters": {
        "fileName": "={{ $binary[$binary.keys()[0]].fileName }}",
        "parentId": "={{ $node[\"Outlook Folder Merge\"].json[\"id\"] || $node[\"Create Folder\"].json[\"id\"] }}",
        "binaryData": true,
        "binaryPropertyName": "={{ $json.binary }}"
      },
      "typeVersion": 1
    }
  ],
  "active": false,
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "b0c9930e-3ea5-46ef-9b93-fe787448afcc",
  "connections": {
    "Filter": {
      "main": [
        [
          {
            "node": "Get Outlook Message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out": {
      "main": [
        [
          {
            "node": "Outlook Folder Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Create Folder": {
      "main": [
        [
          {
            "node": "Outlook Folder Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Outlook Message": {
      "main": [
        [
          {
            "node": "Create Folder",
            "type": "main",
            "index": 0
          },
          {
            "node": "Split Out",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Outlook Folder Merge": {
      "main": [
        [
          {
            "node": "Upload File OneDrive",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Microsoft Outlook Trigger": {
      "main": [
        [
          {
            "node": "Filter",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}