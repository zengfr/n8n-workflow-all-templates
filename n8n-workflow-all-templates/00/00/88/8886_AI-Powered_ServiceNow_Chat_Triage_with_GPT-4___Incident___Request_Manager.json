{
  "id": "3uuJUNs7YjEe782D",
  "meta": {
    "site": "https://github.com/zengfr/n8n-workflow-all-templates",
    "name": "AI-Powered ServiceNow Chat Triage with GPT-4 â€” Incident & Request Manager",
    "wechat": "youandme10086",
    "id": 8886,
    "update_time": "2025-11-10"
  },
  "name": "AI-Powered ServiceNow Chat Triage with GPT-4 â€” Incident & Request Router",
  "tags": [],
  "nodes": [
    {
      "id": "ad145ddf-9106-441d-94cd-ed87bbc85658",
      "name": "When chat message received",
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "position": [
        368,
        268
      ],
      "webhookId": "8b4142f0-e9e7-44da-90f1-dd94227275bd",
      "parameters": {
        "public": true,
        "options": {
          "responseMode": "responseNode"
        },
        "authentication": "basicAuth",
        "initialMessages": "Hi there! ðŸ‘‹\nHow can I assist you today?\n\nNote: Please do not use enter while messaging. Keep your responses in on line."
      },
      "credentials": {
        "httpBasicAuth": {
          "id": "eMHAK3iBdn9a4vW7",
          "name": "Unnamed credential 2"
        }
      },
      "typeVersion": 1.1
    },
    {
      "id": "c0366cfa-74e0-405c-9941-a844262d84d0",
      "name": "OpenAI Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "position": [
        664,
        620
      ],
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "credentials": {
        "openAiApi": {
          "id": "J3BkRybjtqOAx34B",
          "name": "OpenAi account"
        }
      },
      "typeVersion": 1.2
    },
    {
      "id": "2b11cc62-9c8f-4248-86c3-6c8ebfe84361",
      "name": "Text Classifier",
      "type": "@n8n/n8n-nodes-langchain.textClassifier",
      "position": [
        592,
        268
      ],
      "parameters": {
        "options": {
          "enableAutoFixing": true,
          "systemPromptTemplate": "=Please classify the text provided by the user into one of the following categories: \nIncident, Request, Everything else, INC Follow up, Request Follow up, Update action.\nOnly output valid JSON. Do not explain.\n\nFor follow-ups, return category and the number in a JSON object and put the entire object into the field \"category_data\".\n\nFor Update action output distinct incidentID and what user is trying to update in the ticket sepearately\n"
        },
        "inputText": "={{ $json.chatInput }}",
        "categories": {
          "categories": [
            {
              "category": "Incident",
              "description": "Incident- If something is broken or not working or it's a complaint, If a service is down, app not available,  etc. Then it is an incident "
            },
            {
              "category": "Request",
              "description": "Request- If something is a access request or provisioning ask, product etc orders then it is request"
            },
            {
              "category": "Everything Else",
              "description": "Everything which is not part of either of those categories must come here like Knowledge Search"
            },
            {
              "category": "INC Follow up",
              "description": "Follow up is when someone is checking for an update on an incident."
            },
            {
              "category": "Request Follow up",
              "description": "Follow up is when someone is checking for an update on a request."
            },
            {
              "category": "Update action",
              "description": "Update actionis anything where an user is asking for updating a ticket, incident or request."
            }
          ]
        }
      },
      "typeVersion": 1.1
    },
    {
      "id": "4fee1f25-ad74-4cc4-81ad-ffec25bdee26",
      "name": "AI Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "position": [
        2024,
        312
      ],
      "parameters": {
        "options": {
          "systemMessage": "You are a helpful assistant. Who creates requests based on the user query using the tool. Always create the request using the http tool attached to you"
        }
      },
      "typeVersion": 2.1
    },
    {
      "id": "823405a4-92b9-46ac-a241-b3a428a1c940",
      "name": "OpenAI Chat Model1",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "position": [
        1968,
        536
      ],
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "credentials": {
        "openAiApi": {
          "id": "J3BkRybjtqOAx34B",
          "name": "OpenAi account"
        }
      },
      "typeVersion": 1.2
    },
    {
      "id": "d0d74ce3-d5cc-47ab-85c8-d06e95d553dd",
      "name": "Simple Memory",
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "position": [
        2096,
        536
      ],
      "parameters": {},
      "typeVersion": 1.3
    },
    {
      "id": "aa1dfb61-1da5-46f5-9357-78477ddd7fce",
      "name": "Summarization Chain",
      "type": "@n8n/n8n-nodes-langchain.chainSummarization",
      "position": [
        2432,
        268
      ],
      "parameters": {
        "options": {
          "summarizationMethodAndPrompts": {
            "values": {
              "prompt": "=Write a user friendly summary of the following:\n\n\nAgent Action\"{text}\" \nUser Query\"{{ $('When chat message received').item.json.chatInput }}\"\n\nAlways return a request or an incident number and inform the user if request or incident number is not created.\nAlways look for work notes also called as value and summarize them to inform the user what has happened on the incident or a request if they are asking for updates\nCONCISE SUMMARY: "
            }
          }
        }
      },
      "typeVersion": 2.1
    },
    {
      "id": "f0843c75-fe30-4bed-8427-d975e5e7dd5c",
      "name": "OpenAI Chat Model3",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "position": [
        2504,
        492
      ],
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "credentials": {
        "openAiApi": {
          "id": "J3BkRybjtqOAx34B",
          "name": "OpenAi account"
        }
      },
      "typeVersion": 1.2
    },
    {
      "id": "9e170bf4-ca79-466b-a57b-80bf0f56d007",
      "name": "HTTP Request1",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        2088,
        120
      ],
      "parameters": {
        "url": "https://dev224302.service-now.com/api/sn_sc/servicecatalog/items/039c516237b1300054b6a3549dbe5dfc/order_now",
        "method": "POST",
        "options": {},
        "jsonBody": "={{ { \"sysparm_quantity\": 1, \"variables\": { \"short_description\": $(\"When chat message received\").item.json.chatInput } } }}",
        "sendBody": true,
        "sendHeaders": true,
        "specifyBody": "json",
        "authentication": "predefinedCredentialType",
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            }
          ]
        },
        "nodeCredentialType": "serviceNowBasicApi"
      },
      "credentials": {
        "serviceNowBasicApi": {
          "id": "f8nPjpitnJ8BFHqL",
          "name": "ServiceNow Basic Auth account 2"
        }
      },
      "typeVersion": 4.2
    },
    {
      "id": "afb9f332-0972-4854-a3fb-180992307f49",
      "name": "Create an incident",
      "type": "n8n-nodes-base.serviceNow",
      "position": [
        2088,
        -72
      ],
      "parameters": {
        "resource": "incident",
        "operation": "create",
        "authentication": "basicAuth",
        "additionalFields": {},
        "short_description": "={{ $('When chat message received').item.json.chatInput }}"
      },
      "credentials": {
        "serviceNowBasicApi": {
          "id": "FWyPNZLCwvoPmYGR",
          "name": "ServiceNow Basic Auth account"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "7fa36225-2adb-4534-9652-b55afbcb14f4",
      "name": "SerpAPI",
      "type": "@n8n/n8n-nodes-langchain.toolSerpApi",
      "position": [
        2224,
        536
      ],
      "parameters": {
        "options": {
          "google_domain": "google.com"
        }
      },
      "credentials": {
        "serpApi": {
          "id": "EqRzHZkRWqcORp1B",
          "name": "SerpAPI account"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "b7b3f641-523a-4360-9e56-1f7e4b614128",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        624,
        32
      ],
      "parameters": {
        "color": 3,
        "width": 288,
        "height": 208,
        "content": "## Text Classifier\n\nThis will categorize all the user queries in 3 categorize\n1- Incident\n2-Request\n3- Everything Else\n"
      },
      "typeVersion": 1
    },
    {
      "id": "020ea78c-ae47-4937-9867-ceb6a9503aa5",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1552,
        -64
      ],
      "parameters": {
        "content": "## Create Incident\nUsing ServiceNow Connector to create an Incident"
      },
      "typeVersion": 1
    },
    {
      "id": "acdb5a12-9f4a-4dfd-8f82-b4ad8ccbe4ef",
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1552,
        544
      ],
      "parameters": {
        "content": "## Lastly\nTo handle all other cases. I am using a AI Agent with Web Search API"
      },
      "typeVersion": 1
    },
    {
      "id": "a7f8c6f9-d624-46fc-8f04-f4dd7164adb7",
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1552,
        176
      ],
      "parameters": {
        "height": 272,
        "content": "## Submit a General Request\nFor Demo Purpose I am only Submitting a General Request. Using Service Catalog API https://www.servicenow.com/docs/bundle/zurich-api-reference/page/integrate/inbound-rest/concept/c_ServiceCatalogAPI.html#title_servicecat-POST-cart-sub_order"
      },
      "typeVersion": 1
    },
    {
      "id": "fd6bc912-5b0a-493d-b8c2-a01b04aa1622",
      "name": "Respond to Webhook",
      "type": "n8n-nodes-base.respondToWebhook",
      "position": [
        3008,
        268
      ],
      "parameters": {
        "options": {},
        "respondWith": "text",
        "responseBody": "={{ $json.finalText }}"
      },
      "typeVersion": 1.4
    },
    {
      "id": "06cb1917-661c-4f58-af6d-1a5510066846",
      "name": "AI Transform REQ",
      "type": "n8n-nodes-base.aiTransform",
      "position": [
        1008,
        904
      ],
      "parameters": {
        "jsCode": "const items = $input.all();\nconst requestNumbers = items.map((item) => {\n  const match = item?.json?.chatInput.match(/REQ\\d+/);\n  return { requestNumber: match ? match[0] : null };\n});\nreturn requestNumbers;\n",
        "instructions": "Extract and output only request number from the message",
        "codeGeneratedForPrompt": "Extract and output only request number from the message"
      },
      "typeVersion": 1
    },
    {
      "id": "60075341-8fcb-4304-ada9-b783874c8fb1",
      "name": "AI Transform INC",
      "type": "n8n-nodes-base.aiTransform",
      "position": [
        1008,
        712
      ],
      "parameters": {
        "jsCode": "const items = $input.all();\nconst incidentNumbers = items.map((item) => {\n  const match = item?.json?.chatInput.match(/INC\\d+/);\n  return { incidentNumber: match ? match[0] : null };\n});\nreturn incidentNumbers;\n",
        "instructions": "Extract and output only incident number from the message",
        "codeGeneratedForPrompt": "Extract and output only incident number from the messge"
      },
      "typeVersion": 1
    },
    {
      "id": "cdae8bb3-5b1d-4b55-838c-f4d91a5d53ea",
      "name": "Get many incidents",
      "type": "n8n-nodes-base.serviceNow",
      "position": [
        1296,
        712
      ],
      "parameters": {
        "options": {
          "sysparm_query": "=number={{ $('AI Transform INC').item.json.incidentNumber }}"
        },
        "resource": "incident",
        "operation": "getAll",
        "authentication": "basicAuth"
      },
      "credentials": {
        "serviceNowBasicApi": {
          "id": "FWyPNZLCwvoPmYGR",
          "name": "ServiceNow Basic Auth account"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "d2e70e32-6216-4506-a01c-bf981872b701",
      "name": "HTTP Request",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        1520,
        636
      ],
      "parameters": {
        "url": "=https://dev224302.service-now.com/api/now/table/sys_journal_field?sysparm_query=element_id={{ $('Get many incidents').item.json.sys_id }}^element=work_notes",
        "options": {},
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "serviceNowBasicApi"
      },
      "credentials": {
        "httpBasicAuth": {
          "id": "Aa9KFMvHUk8S8liT",
          "name": "Unnamed credential"
        },
        "serviceNowBasicApi": {
          "id": "FWyPNZLCwvoPmYGR",
          "name": "ServiceNow Basic Auth account"
        }
      },
      "typeVersion": 4.2
    },
    {
      "id": "62d2732b-dbf0-472f-bdb8-52b17d1202b9",
      "name": "Merge",
      "type": "n8n-nodes-base.merge",
      "position": [
        1744,
        712
      ],
      "parameters": {},
      "typeVersion": 3.2
    },
    {
      "id": "5e3b338f-9ae5-4b6d-bd64-079d35e9622c",
      "name": "Edit Fields",
      "type": "n8n-nodes-base.set",
      "position": [
        2088,
        712
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "316842a2-f6ca-4ef6-a48e-73f3e22998cd",
              "name": "rawData",
              "type": "string",
              "value": "={{ JSON.stringify($json, null, 2) }}"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "6577fe8e-0c2a-48ad-8e93-6694aed1f63d",
      "name": "Code in JavaScript",
      "type": "n8n-nodes-base.code",
      "position": [
        2784,
        268
      ],
      "parameters": {
        "jsCode": "const text = items.map(item => item.json.output.text).join('\\n\\n');\nconst cleaned = text\n  .replace(/\\\\\"/g, '\"')   // Replace escaped quotes\n  .replace(/\\\\n/g, '\\n')  // Replace escaped newlines\n  .replace(/\\\\r/g, '')    // Remove escaped carriage returns\n  .replace(/\\\\\\\\/g, '\\\\'); // Replace double backslashes with single\n\nreturn [\n  {\n    json: {\n      finalText: cleaned\n    }\n  }\n];"
      },
      "typeVersion": 2
    },
    {
      "id": "8c3e82c9-1b4b-47fc-9a7d-782ef0669cfc",
      "name": "AI Agent1",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "position": [
        944,
        -320
      ],
      "parameters": {
        "text": "=Extract the incident ID (e.g., INC001) from the following text. Then, rewrite the rest of the message as a clear, concise update for the incident, removing any unnecessary phrases or instructions. Output only a JSON object, with no extra text or formatting, like this:\n{\n  \"incidentID\": \"<incident id>\",\n  \"userMessage\": \"<rephrased update message>\"\n}\nText: {{$json[\"chatInput\"]}}",
        "options": {},
        "promptType": "define"
      },
      "typeVersion": 2.2
    },
    {
      "id": "fb8b1d84-e6c2-41a7-97a6-a1d741d14b7c",
      "name": "OpenAI Chat Model2",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "position": [
        1016,
        -96
      ],
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "credentials": {
        "openAiApi": {
          "id": "J3BkRybjtqOAx34B",
          "name": "OpenAi account"
        }
      },
      "typeVersion": 1.2
    },
    {
      "id": "0f6b440e-8a77-4136-b759-b730b6d81ffd",
      "name": "Code in JavaScript1",
      "type": "n8n-nodes-base.code",
      "position": [
        1296,
        -320
      ],
      "parameters": {
        "jsCode": "// Get the output string from the previous node\nconst outputString = $json.output;\n\n// Parse the JSON string into an object\nconst parsed = JSON.parse(outputString);\n\n// Return the parsed object as the new item\nreturn [{ json: parsed }];"
      },
      "typeVersion": 2
    },
    {
      "id": "65c74ac7-f2d4-41b5-87b2-3854c4de63a3",
      "name": "Get many incidents1",
      "type": "n8n-nodes-base.serviceNow",
      "position": [
        1520,
        -320
      ],
      "parameters": {
        "limit": 1,
        "options": {
          "sysparm_query": "=number={{ $json.incidentID }}"
        },
        "resource": "incident",
        "operation": "getAll",
        "authentication": "basicAuth"
      },
      "credentials": {
        "serviceNowBasicApi": {
          "id": "FWyPNZLCwvoPmYGR",
          "name": "ServiceNow Basic Auth account"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "147dca93-9d01-4c38-9310-4a463ac522ff",
      "name": "Update an incident",
      "type": "n8n-nodes-base.serviceNow",
      "position": [
        1744,
        -320
      ],
      "parameters": {
        "id": "={{ $json.sys_id }}",
        "resource": "incident",
        "operation": "update",
        "updateFields": {
          "work_notes": "={{ $('Code in JavaScript1').item.json.userMessage }}"
        },
        "authentication": "basicAuth"
      },
      "credentials": {
        "serviceNowBasicApi": {
          "id": "FWyPNZLCwvoPmYGR",
          "name": "ServiceNow Basic Auth account"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "175438ef-5d48-44ac-8eea-2a3dc8bcf71a",
      "name": "Respond to Webhook1",
      "type": "n8n-nodes-base.respondToWebhook",
      "position": [
        2088,
        -320
      ],
      "parameters": {
        "options": {},
        "respondWith": "text",
        "responseBody": "={{ $(\"Code in JavaScript1\").item.json.incidentID }} is updated with the following comment:\"{{ $(\"Code in JavaScript1\").item.json.userMessage }}\""
      },
      "typeVersion": 1.4
    },
    {
      "id": "52b64d8b-e7cc-48d7-b1bb-608ec0e90255",
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        912,
        1040
      ],
      "parameters": {
        "content": "## Get Many\nThis pulls multiple records for one incident, eg. multuple notes will output multiple records of the same INC with diff notes, Limit is a key factor to limit the output."
      },
      "typeVersion": 1
    }
  ],
  "active": true,
  "pinData": {},
  "settings": {
    "callerPolicy": "workflowsFromSameOwner",
    "executionOrder": "v0"
  },
  "versionId": "54ed2df9-902b-4ed6-86cb-35bcf635b4dd",
  "connections": {
    "Merge": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "SerpAPI": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Summarization Chain",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent1": {
      "main": [
        [
          {
            "node": "Code in JavaScript1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Summarization Chain",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "HTTP Request1": {
      "main": [
        [
          {
            "node": "Summarization Chain",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Text Classifier": {
      "main": [
        [
          {
            "node": "Create an incident",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "AI Transform INC",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "AI Transform REQ",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "AI Agent1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Transform INC": {
      "main": [
        [
          {
            "node": "Get many incidents",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Text Classifier",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create an incident": {
      "main": [
        [
          {
            "node": "Summarization Chain",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get many incidents": {
      "main": [
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model2": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model3": {
      "ai_languageModel": [
        [
          {
            "node": "Summarization Chain",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Update an incident": {
      "main": [
        [
          {
            "node": "Respond to Webhook1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript1": {
      "main": [
        [
          {
            "node": "Get many incidents1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get many incidents1": {
      "main": [
        [
          {
            "node": "Update an incident",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Summarization Chain": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When chat message received": {
      "main": [
        [
          {
            "node": "Text Classifier",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}