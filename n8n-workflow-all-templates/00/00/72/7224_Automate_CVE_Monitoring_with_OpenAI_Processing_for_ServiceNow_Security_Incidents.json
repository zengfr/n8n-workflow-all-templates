{
  "id": "VSUVQ0IMSqJG3w9T",
  "meta": {
    "site": "https://github.com/zengfr/n8n-workflow-all-templates",
    "name": "Automate CVE Monitoring with OpenAI Processing for ServiceNow Security Incidents",
    "wechat": "youandme10086",
    "id": 7224,
    "update_time": "2025-11-10"
  },
  "name": "Extract and Create Vulnerabilities in ServiceNow",
  "tags": [],
  "nodes": [
    {
      "id": "e0583472-a450-4582-83bc-84a014bea543",
      "name": "Split Out",
      "type": "n8n-nodes-base.splitOut",
      "position": [
        2144,
        448
      ],
      "parameters": {
        "include": "selectedOtherFields",
        "options": {
          "destinationFieldName": "body"
        },
        "fieldToSplitOut": "output.results",
        "fieldsToInclude": "pubStartDate,pubEndDate,cveId,cvssV2Severity,Description"
      },
      "typeVersion": 1
    },
    {
      "id": "a63c3ab3-6aab-43b2-8af6-8b00e24e0ee6",
      "name": "OpenAI Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "position": [
        1808,
        624
      ],
      "parameters": {
        "options": {}
      },
      "credentials": {
        "openAiApi": {
          "id": "ppNn03FE7vbsyINF",
          "name": "n8n free OpenAI API credits"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "40326966-0c46-4df2-8d80-fa014e05b693",
      "name": "Information Extractor",
      "type": "@n8n/n8n-nodes-langchain.informationExtractor",
      "position": [
        1760,
        448
      ],
      "parameters": {
        "text": "={{$json.data}}",
        "options": {
          "systemPromptTemplate": "You are an expert data extraction algorithm.\nYour task is to read any given text and extract only the relevant information for NVD CVE API search parameters.\n\nOutput format: Always return a single JSON object called \"results\".\nObject structure: The object may include only the following keys, matching their expected formats:\nstartIndex (integer, ≥ 0)\nresultsPerPage (integer, 1–2000)\npubStartDate (string, ISO 8601 date-time)\npubEndDate (string, ISO 8601 date-time)\nmodStartDate (string, ISO 8601 date-time)\nmodEndDate (string, ISO 8601 date-time)\ncvssV2Severity (string, one of: \"LOW\", \"MEDIUM\", \"HIGH\")\ncvssV3Severity (string, one of: \"LOW\", \"MEDIUM\", \"HIGH\", \"CRITICAL\")\nkeywordSearch (string)\ncpeName (string)\ncpeMatchString (string)\nhasCertAlerts (boolean)\nhasCertNotes (boolean)\nhasKev (boolean)\nisVulnerable (boolean)\ncveId (string, pattern: )\nDescription(string)\nIf you cannot find a value for a given attribute, omit that attribute.\nDo not include extra keys or commentary."
        },
        "schemaType": "manual",
        "inputSchema": "{\n  \"results\": {\n    \"startIndex\": 0,\n    \"resultsPerPage\": 10,\n    \"pubStartDate\": \"1988-10-01T04:00:00.000Z\",\n    \"pubEndDate\": \"1990-10-03T04:00:00.000Z\",\n    \"modStartDate\": \"2025-04-03T01:03:51.193Z\",\n    \"modEndDate\": \"2025-04-03T01:03:51.193Z\",\n    \"cvssV2Severity\": \"HIGH\",\n    \"cveId\": \"CVE-1999-0095\",\n    \"cpeName\": \"cpe:2.3:a:eric_allman:sendmail:5.58:*:*:*:*:*:*:*\",\n    \"cpeMatchString\": \"cpe:2.3:a:eric_allman:sendmail:5.58:*:*:*:*:*:*:*\",\n    \"isVulnerable\": true,\n    \"hasCertAlerts\": false,\n    \"hasCertNotes\": true,\n    \"hasKev\": false,\n    \"cvssV3Severity\": \"HIGH\",\n    \"keywordSearch\": \"sendmail\",\n    \"description\":\"String\"\n  }\n}\n"
      },
      "typeVersion": 1
    },
    {
      "id": "8ddca560-8da7-4090-b865-0523f95ca463",
      "name": "Jina Fetch",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        1520,
        448
      ],
      "parameters": {
        "url": "https://r.jina.ai/https://services.nvd.nist.gov/rest/json/cves/2.0/?resultsPerPage=10",
        "options": {
          "allowUnauthorizedCerts": true
        }
      },
      "typeVersion": 4.1
    },
    {
      "id": "a18d7899-1e0c-49c7-83e9-04f26f695f66",
      "name": "Create an incident",
      "type": "n8n-nodes-base.serviceNow",
      "position": [
        2400,
        448
      ],
      "parameters": {
        "resource": "incident",
        "operation": "create",
        "authentication": "basicAuth",
        "additionalFields": {
          "description": "=First Published on : {{$('Split Out').item.json.body.pubStartDate }}\nLast Published on : {{$('Split Out').item.json.body.pubEndDate }}\nSeverity : {{$('Split Out').item.json.body.cvssV2Severity }}\nCVEID : {{$('Split Out').item.json.body.cveId }}\nMatching String: {{$('Split Out').item.json.body.cpeMatchString }}"
        },
        "short_description": "={{ $json.body.description }}"
      },
      "credentials": {
        "serviceNowBasicApi": {
          "id": "keHrNdS7cHG3Tr0X",
          "name": "ServiceNow Basic Auth account 2"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "e7f1f9c0-63a2-4d4a-88cb-e089ea25d823",
      "name": "Schedule Trigger",
      "type": "n8n-nodes-base.scheduleTrigger",
      "position": [
        1056,
        448
      ],
      "parameters": {
        "rule": {
          "interval": [
            {
              "triggerAtHour": 7
            }
          ]
        }
      },
      "typeVersion": 1.2
    }
  ],
  "active": false,
  "pinData": {},
  "settings": {},
  "versionId": "d97a1e4a-f450-4c4d-8d85-877a5feebe98",
  "connections": {
    "Split Out": {
      "main": [
        [
          {
            "node": "Create an incident",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Jina Fetch": {
      "main": [
        [
          {
            "node": "Information Extractor",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "Jina Fetch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Information Extractor",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Information Extractor": {
      "main": [
        [
          {
            "node": "Split Out",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}