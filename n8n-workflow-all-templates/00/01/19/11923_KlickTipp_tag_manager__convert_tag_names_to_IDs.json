{
  "id": "4yiaEHRGkefBE8wY",
  "meta": {
    "site": "https://github.com/zengfr/n8n-workflow-all-templates",
    "name": "KlickTipp tag manager: convert tag names to IDs",
    "wechat": "youandme10086",
    "id": 11923,
    "update_time": "2026-02-13"
  },
  "name": "Get or create tag IDs in KlickTipp from an array of tag names",
  "tags": [
    {
      "id": "15wrq9sti6wyqr6J",
      "name": "TEMPLATE",
      "createdAt": "2025-01-08T16:34:30.163Z",
      "updatedAt": "2025-01-08T16:34:30.163Z"
    }
  ],
  "nodes": [
    {
      "id": "a730c7e7-6967-467a-9911-777b6327bc99",
      "name": "Find tags to create",
      "type": "n8n-nodes-base.merge",
      "position": [
        400,
        32
      ],
      "parameters": {
        "mode": "combine",
        "options": {},
        "joinMode": "keepNonMatches",
        "outputDataFrom": "input2",
        "fieldsToMatchString": "value"
      },
      "typeVersion": 3.2
    },
    {
      "id": "aa49a029-c89a-42e0-9426-b30a6bcf21c3",
      "name": "Find existing tags",
      "type": "n8n-nodes-base.merge",
      "position": [
        400,
        -224
      ],
      "parameters": {
        "mode": "combine",
        "options": {},
        "fieldsToMatchString": "value"
      },
      "typeVersion": 3.2
    },
    {
      "id": "39a029a3-4072-466d-8dcb-95859717c3e0",
      "name": "Combine existing & new tags",
      "type": "n8n-nodes-base.merge",
      "position": [
        848,
        -96
      ],
      "parameters": {},
      "typeVersion": 3.2
    },
    {
      "id": "2cbca56a-be9d-48ee-ad82-45b79a4ffee8",
      "name": "Split tagNames into items",
      "type": "n8n-nodes-base.splitOut",
      "position": [
        -48,
        48
      ],
      "parameters": {
        "options": {},
        "fieldToSplitOut": "tagNames"
      },
      "typeVersion": 1
    },
    {
      "id": "8804dede-4d0e-48f6-b352-ba05b9f2561a",
      "name": "Map tagNames -> value",
      "type": "n8n-nodes-base.set",
      "position": [
        176,
        48
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "3ba2a4e9-9fbd-4fe4-bc84-3f6cb3a2ff03",
              "name": "value",
              "type": "string",
              "value": "={{ $json.tagNames }}"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "9fd88cd2-0b7f-4624-a83f-2a9de4dd412a",
      "name": "Get tag list",
      "type": "n8n-nodes-klicktipp.klicktipp",
      "position": [
        176,
        -240
      ],
      "parameters": {},
      "credentials": {
        "klickTippApi": {
          "id": "credential-id",
          "name": "klickTippApi Credential"
        }
      },
      "typeVersion": 3
    },
    {
      "id": "5f1cb166-b041-4968-b325-2749e3665306",
      "name": "Create new tag",
      "type": "n8n-nodes-klicktipp.klicktipp",
      "position": [
        624,
        32
      ],
      "parameters": {
        "name": "={{ $json.value }}",
        "operation": "create"
      },
      "credentials": {
        "klickTippApi": {
          "id": "credential-id",
          "name": "klickTippApi Credential"
        }
      },
      "typeVersion": 3
    },
    {
      "id": "981c4436-1d8b-4813-95d7-9632804b91f9",
      "name": "Aggregate tag IDs ",
      "type": "n8n-nodes-base.aggregate",
      "position": [
        1296,
        -96
      ],
      "parameters": {
        "options": {},
        "fieldsToAggregate": {
          "fieldToAggregate": [
            {
              "fieldToAggregate": "tagIds"
            }
          ]
        }
      },
      "typeVersion": 1
    },
    {
      "id": "26e35535-0a3e-47d9-a770-209ea951f4e7",
      "name": "Extract only tag IDs",
      "type": "n8n-nodes-base.set",
      "position": [
        1072,
        -96
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "961d528c-cdd7-42ad-9a19-0e6733bad8f8",
              "name": "tagIds",
              "type": "number",
              "value": "={{ $json.id }}"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "63aad222-2f18-4b6d-84d0-8e7915a719e6",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        784,
        -288
      ],
      "parameters": {
        "color": 7,
        "width": 688,
        "height": 496,
        "content": "## 3. Combine & return tag IDs"
      },
      "typeVersion": 1
    },
    {
      "id": "50a84b4e-89e8-4233-b1a6-f8fc354c840a",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        320,
        -32
      ],
      "parameters": {
        "color": 7,
        "width": 448,
        "height": 240,
        "content": "## 2.2. Detect and create missing tags"
      },
      "typeVersion": 1
    },
    {
      "id": "9b9a9f24-0a86-416c-840a-d12e584b3824",
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        320,
        -288
      ],
      "parameters": {
        "color": 7,
        "width": 448,
        "height": 240,
        "content": "## 2.1. Resolve existing tags"
      },
      "typeVersion": 1
    },
    {
      "id": "b1fa2fce-7927-41f4-9e5b-1e1189d1c7f8",
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -80,
        -288
      ],
      "parameters": {
        "color": 7,
        "width": 384,
        "height": 496,
        "content": "## 1. Preparation"
      },
      "typeVersion": 1
    },
    {
      "id": "7da1f9eb-0f2e-4ce6-b6d6-41530a689133",
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -320,
        -288
      ],
      "parameters": {
        "color": 7,
        "width": 224,
        "height": 496,
        "content": "## Input"
      },
      "typeVersion": 1
    },
    {
      "id": "de8d5307-17af-4356-a560-117bbc7194c5",
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -992,
        -288
      ],
      "parameters": {
        "width": 656,
        "height": 864,
        "content": "## Introduction\nThis workflow receives an array of tag names, checks which tags already exist in KlickTipp, creates the missing ones, and returns a unified array of tag IDs — so you can reuse the same \"get or create tags\" logic across multiple automations.\n\n## How it works\n- Accepts input `tagNames[]` (array of tag names).\n- Splits the array into individual items and maps each name into a `value` field for matching.\n- Loads your full KlickTipp tag list and matches by tag name.\n- Creates tags that don’t exist yet.\n- Combines existing + newly created tags and returns a single aggregated array of IDs.\n\n## Setup Instructions\n1. **Credentials**\n   - Configure your **KlickTipp** credentials in the KlickTipp nodes.\n\n2. **How to call this sub-workflow**\n   - From a parent workflow, use an **Execute Sub-workflow** node and pass:\n```\n{ \"tagNames\": [\"Tag A\", \"Tag B\", \"Tag C\"] }\n```\n\n## Output\nReturns aggregated tag IDs:\n```\n{ \"tagIds\": [123456789, 98765431, 999999999] }\n```\n\n## Testing\n- Test with a mix of existing and new tag names.\n- Confirm new tags appear in KlickTipp and the output contains all expected IDs.\n- Use `tagIds[]` in your parent workflow (for example, when updating or tagging contacts)."
      },
      "typeVersion": 1
    },
    {
      "id": "cb77f2e8-ad13-4e38-a85e-2630fbb0cb82",
      "name": "Input: Tag names",
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "position": [
        -272,
        -96
      ],
      "parameters": {
        "inputSource": "jsonExample",
        "jsonExample": "{\n  \"tagNames\": [\"Tag name 1\", \"Tag name 2\", \"Tag name 3\"]\n}"
      },
      "typeVersion": 1.1
    }
  ],
  "active": true,
  "pinData": {
    "Input: Tag names": [
      {
        "json": {
          "tagNames": [
            "Node-RED",
            "Pipedrive",
            "Node-RED-2-2"
          ]
        }
      }
    ]
  },
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "a276784f-2e6e-4590-8e74-dea71558dd0e",
  "connections": {
    "Get tag list": {
      "main": [
        [
          {
            "node": "Find existing tags",
            "type": "main",
            "index": 0
          },
          {
            "node": "Find tags to create",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create new tag": {
      "main": [
        [
          {
            "node": "Combine existing & new tags",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Input: Tag names": {
      "main": [
        [
          {
            "node": "Get tag list",
            "type": "main",
            "index": 0
          },
          {
            "node": "Split tagNames into items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate tag IDs ": {
      "main": [
        []
      ]
    },
    "Find existing tags": {
      "main": [
        [
          {
            "node": "Combine existing & new tags",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Find tags to create": {
      "main": [
        [
          {
            "node": "Create new tag",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract only tag IDs": {
      "main": [
        [
          {
            "node": "Aggregate tag IDs ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Map tagNames -> value": {
      "main": [
        [
          {
            "node": "Find existing tags",
            "type": "main",
            "index": 1
          },
          {
            "node": "Find tags to create",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Split tagNames into items": {
      "main": [
        [
          {
            "node": "Map tagNames -> value",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Combine existing & new tags": {
      "main": [
        [
          {
            "node": "Extract only tag IDs",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}