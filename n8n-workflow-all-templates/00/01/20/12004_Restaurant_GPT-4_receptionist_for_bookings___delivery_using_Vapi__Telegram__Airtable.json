{
  "meta": {
    "site": "https://github.com/zengfr/n8n-workflow-all-templates",
    "name": "Restaurant GPT-4 receptionist for bookings & delivery using Vapi, Telegram, Airtable",
    "wechat": "youandme10086",
    "id": 12004,
    "update_time": "2026-02-13"
  },
  "nodes": [
    {
      "id": "c4e72a26-be39-4cfb-b675-c3a5b992e794",
      "name": "MCP Server Trigger",
      "type": "@n8n/n8n-nodes-langchain.mcpTrigger",
      "position": [
        -848,
        -624
      ],
      "webhookId": "451141d4-f7c8-4a46-a1c0-b4fec65aa9d0",
      "parameters": {
        "path": "451141d4-f7c8-4a46-a1c0-b4fec65aa9d0"
      },
      "typeVersion": 2
    },
    {
      "id": "96da5896-4878-4f36-9669-d4ed7cda5a33",
      "name": "Call \"Check Availability\"",
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "position": [
        -3904,
        -256
      ],
      "parameters": {
        "workflowId": {
          "__rl": true,
          "mode": "list",
          "value": "NZA3G61oulJA8Qzm",
          "cachedResultUrl": "/workflow/NZA3G61oulJA8Qzm",
          "cachedResultName": "Check Table Availability"
        },
        "description": "Call this tool to check available tables on the calendar.",
        "workflowInputs": {
          "value": {
            "endDate": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('endDate', ``, 'string') }}",
            "startDate": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('startDate', ``, 'string') }}",
            "partyCount": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('partyCount', ``, 'number') }}"
          },
          "schema": [
            {
              "id": "partyCount",
              "type": "number",
              "display": true,
              "required": false,
              "displayName": "partyCount",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "startDate",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "startDate",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "endDate",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "endDate",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            }
          ],
          "mappingMode": "defineBelow",
          "matchingColumns": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "d7b3192d-b3b8-434a-86e6-6ea31f478ccb",
      "name": "Call \"Update appointment\"",
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "position": [
        -2592,
        304
      ],
      "parameters": {
        "workflowId": {
          "__rl": true,
          "mode": "list",
          "value": "beSbEFx6T90UQLec",
          "cachedResultUrl": "/workflow/beSbEFx6T90UQLec",
          "cachedResultName": "Update a Booking"
        },
        "description": "Call this tool to update an existing booking.",
        "workflowInputs": {
          "value": {
            "id": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('id', ``, 'string') }}",
            "name": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('name', ``, 'string') }}",
            "notes": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('notes', ``, 'string') }}",
            "phone": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('phone', ``, 'string') }}",
            "endDate": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('endDate', ``, 'string') }}",
            "startDate": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('startDate', ``, 'string') }}"
          },
          "schema": [
            {
              "id": "id",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "id",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "startDate",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "startDate",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "endDate",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "endDate",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "notes",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "notes",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "name",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "name",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "phone",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "phone",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            }
          ],
          "mappingMode": "defineBelow",
          "matchingColumns": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "bc9756c2-b459-44c2-902a-06edadbb3d5c",
      "name": "Call \"Delete Appointment\"",
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "position": [
        -3888,
        304
      ],
      "parameters": {
        "workflowId": {
          "__rl": true,
          "mode": "list",
          "value": "OpN5ZqKz0I9vF68B",
          "cachedResultUrl": "/workflow/OpN5ZqKz0I9vF68B",
          "cachedResultName": "Delete Booking"
        },
        "description": "Call this tool to cancel an existing booking.",
        "workflowInputs": {
          "value": {
            "id": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('id', ``, 'string') }}"
          },
          "schema": [
            {
              "id": "id",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "id",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            }
          ],
          "mappingMode": "defineBelow",
          "matchingColumns": [
            "id"
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "fb74c9b6-7344-46f7-b830-1319fb0699d8",
      "name": "Call \"Book Table\"",
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "position": [
        -2368,
        816
      ],
      "parameters": {
        "workflowId": {
          "__rl": true,
          "mode": "list",
          "value": "NqxOrMSG6a4SkROF",
          "cachedResultUrl": "/workflow/NqxOrMSG6a4SkROF",
          "cachedResultName": "Book a Table"
        },
        "description": "Call this tool to book a table on the calendar.",
        "workflowInputs": {
          "value": {
            "name": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('name', ``, 'string') }}",
            "notes": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('notes', ``, 'string') }}",
            "phone": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('phone', ``, 'string') }}",
            "endTime": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('endTime', ``, 'string') }}",
            "tableID": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('tableID', ``, 'string') }}",
            "startTime": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('startTime', ``, 'string') }}"
          },
          "schema": [
            {
              "id": "startTime",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "startTime",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "endTime",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "endTime",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "tableID",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "tableID",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "name",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "name",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "phone",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "phone",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "notes",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "notes",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            }
          ],
          "mappingMode": "defineBelow",
          "matchingColumns": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "f7683f6f-4763-4512-9628-e645c82ea9d9",
      "name": "Call \"Get a Booking\"",
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "position": [
        -3888,
        784
      ],
      "parameters": {
        "workflowId": {
          "__rl": true,
          "mode": "list",
          "value": "tt3tv3I7Pg9kxt95",
          "cachedResultUrl": "/workflow/tt3tv3I7Pg9kxt95",
          "cachedResultName": "Get a Booking"
        },
        "description": "Call this tool to get info about caller's existing bookings.",
        "workflowInputs": {
          "value": {
            "phone": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('phone', ``, 'string') }}"
          },
          "schema": [
            {
              "id": "phone",
              "type": "string",
              "display": true,
              "removed": false,
              "required": false,
              "displayName": "phone",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            }
          ],
          "mappingMode": "defineBelow",
          "matchingColumns": [
            "phone"
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "d37cacf1-5367-42af-b147-579b1c7baa57",
      "name": "Call 'Get Menu'",
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "position": [
        2112,
        336
      ],
      "parameters": {
        "workflowId": {
          "__rl": true,
          "mode": "list",
          "value": "mVn82ycAFPJ4aIM1",
          "cachedResultUrl": "/workflow/mVn82ycAFPJ4aIM1",
          "cachedResultName": "Get Menu"
        },
        "description": "Call this tool to get menu.",
        "workflowInputs": {
          "value": {},
          "schema": [],
          "mappingMode": "defineBelow",
          "matchingColumns": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "a07c1563-4e1c-4070-8d3e-1935c53d25f2",
      "name": "Call 'Calculate the Price'",
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "position": [
        1408,
        -480
      ],
      "parameters": {
        "workflowId": {
          "__rl": true,
          "mode": "list",
          "value": "kBA6Lu5kjxIb0S94",
          "cachedResultUrl": "/workflow/kBA6Lu5kjxIb0S94",
          "cachedResultName": "Calculate the Price"
        },
        "description": "Call this tool to calculate the price for the order.",
        "workflowInputs": {
          "value": {
            "items": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('items', `Pass an array of ordered items.`, 'json') }}"
          },
          "schema": [
            {
              "id": "items",
              "type": "array",
              "display": true,
              "removed": false,
              "required": false,
              "displayName": "items",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            }
          ],
          "mappingMode": "defineBelow",
          "matchingColumns": [
            "items"
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "d0cae678-0cf5-42b7-984a-e6b93c434301",
      "name": "Call 'Validate the Address'",
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "position": [
        1504,
        -112
      ],
      "parameters": {
        "workflowId": {
          "__rl": true,
          "mode": "list",
          "value": "8WaaisGGvFBCHstb",
          "cachedResultUrl": "/workflow/8WaaisGGvFBCHstb",
          "cachedResultName": "Validate the Address"
        },
        "description": "Call this tool to verify a callerâ€™s address and determine whether it is within the delivery area.",
        "workflowInputs": {
          "value": {
            "address": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('address', ``, 'string') }}"
          },
          "schema": [
            {
              "id": "address",
              "type": "string",
              "display": true,
              "removed": false,
              "required": false,
              "displayName": "address",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            }
          ],
          "mappingMode": "defineBelow",
          "matchingColumns": [
            "address"
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "f55a1959-fd18-442f-a1f4-c27b8b89a044",
      "name": "Call 'Create a Takeaway Order'",
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "position": [
        448,
        640
      ],
      "parameters": {
        "workflowId": {
          "__rl": true,
          "mode": "list",
          "value": "lgRNlBUaBhitavRq",
          "cachedResultUrl": "/workflow/lgRNlBUaBhitavRq",
          "cachedResultName": "Create a Takeaway Order"
        },
        "description": "Call this tool to add takeaway order to the database.",
        "workflowInputs": {
          "value": {
            "name": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('name', `Caller's name.`, 'string') }}",
            "items": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('items', `Order items.`, 'json') }}",
            "notes": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('notes', ``, 'string') }}",
            "phone": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('phone', `Caller's phone number.`, 'string') }}",
            "pickUpTime": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('pickUpTime', `This is the estimated pickup time.`, 'string') }}",
            "priceTotal": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('priceTotal', `This is the total price of the order.`, 'string') }}"
          },
          "schema": [
            {
              "id": "name",
              "type": "string",
              "display": true,
              "removed": false,
              "required": false,
              "displayName": "name",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "phone",
              "type": "string",
              "display": true,
              "removed": false,
              "required": false,
              "displayName": "phone",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "items",
              "type": "array",
              "display": true,
              "removed": false,
              "required": false,
              "displayName": "items",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "pickUpTime",
              "type": "string",
              "display": true,
              "removed": false,
              "required": false,
              "displayName": "pickUpTime",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "priceTotal",
              "type": "string",
              "display": true,
              "removed": false,
              "required": false,
              "displayName": "priceTotal",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "notes",
              "type": "string",
              "display": true,
              "removed": false,
              "required": false,
              "displayName": "notes",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            }
          ],
          "mappingMode": "defineBelow",
          "matchingColumns": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "d857b3a6-5315-43a7-a49a-e65190e1e64a",
      "name": "Call 'Create a Delivery Order'",
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "position": [
        416,
        1024
      ],
      "parameters": {
        "workflowId": {
          "__rl": true,
          "mode": "list",
          "value": "BL2bHa2vLYuBSknn",
          "cachedResultUrl": "/workflow/BL2bHa2vLYuBSknn",
          "cachedResultName": "Create a Delivery Order"
        },
        "description": "Call this tool to create a delivery order in the database.",
        "workflowInputs": {
          "value": {
            "name": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('name', `Caller's name.`, 'string') }}",
            "items": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('items', `Order items.`, 'json') }}",
            "notes": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('notes', ``, 'string') }}",
            "phone": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('phone', `Caller's phone number.`, 'string') }}",
            "priceTotal": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('priceTotal', `Total order price.`, 'string') }}",
            "deliveryTime": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('deliveryTime', `Estimated delivery time.`, 'string') }}",
            "deliveryAddress": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('deliveryAddress', `Delivery address.`, 'string') }}"
          },
          "schema": [
            {
              "id": "name",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "name",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "phone",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "phone",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "items",
              "type": "array",
              "display": true,
              "required": false,
              "displayName": "items",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "priceTotal",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "priceTotal",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "deliveryTime",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "deliveryTime",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "deliveryAddress",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "deliveryAddress",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "notes",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "notes",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            }
          ],
          "mappingMode": "defineBelow",
          "matchingColumns": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "7ef9f7b4-2f63-4ac2-aa83-3fb362404b17",
      "name": "Call 'Get an Order'",
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "position": [
        400,
        -144
      ],
      "parameters": {
        "workflowId": {
          "__rl": true,
          "mode": "list",
          "value": "ymZJCRZ2PtusqBU2",
          "cachedResultUrl": "/workflow/ymZJCRZ2PtusqBU2",
          "cachedResultName": "Get an Order"
        },
        "description": "Call this tool to get an existing order.",
        "workflowInputs": {
          "value": {
            "phone": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('phone', ``, 'string') }}"
          },
          "schema": [
            {
              "id": "phone",
              "type": "string",
              "display": true,
              "removed": false,
              "required": false,
              "displayName": "phone",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            }
          ],
          "mappingMode": "defineBelow",
          "matchingColumns": [
            "phone"
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "48bb7902-65c3-4a2c-8bf4-0593686d7965",
      "name": "When Executed by Another Workflow",
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "position": [
        -3904,
        -112
      ],
      "parameters": {
        "workflowInputs": {
          "values": [
            {
              "name": "partyCount",
              "type": "number"
            },
            {
              "name": "startDate"
            },
            {
              "name": "endDate"
            }
          ]
        }
      },
      "typeVersion": 1.1
    },
    {
      "id": "25ab85c9-2751-46c0-8bde-355572899724",
      "name": "If",
      "type": "n8n-nodes-base.if",
      "position": [
        -1872,
        -208
      ],
      "parameters": {
        "options": {},
        "conditions": {
          "options": {
            "version": 3,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "combinator": "and",
          "conditions": [
            {
              "id": "858925f5-7e71-477b-a04f-71a8161dc343",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              },
              "leftValue": "={{ $json.available }}",
              "rightValue": true
            }
          ]
        }
      },
      "typeVersion": 2.3
    },
    {
      "id": "1ce48ce8-4ecd-42ba-a00f-f51b7d601806",
      "name": "If1",
      "type": "n8n-nodes-base.if",
      "position": [
        -2784,
        -112
      ],
      "parameters": {
        "options": {},
        "conditions": {
          "options": {
            "version": 3,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "combinator": "and",
          "conditions": [
            {
              "id": "ac095b11-ddaa-4ae3-8d64-262f370dd25a",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              },
              "leftValue": "={{ $json.canHandle }}",
              "rightValue": {}
            }
          ]
        }
      },
      "typeVersion": 2.3
    },
    {
      "id": "b4c4e287-e1dc-46c5-9930-321d463c6278",
      "name": "Can't Handle Party",
      "type": "n8n-nodes-base.set",
      "position": [
        -2544,
        -96
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "81e87f27-d206-4b01-8b47-b30229708576",
              "name": "Message",
              "type": "string",
              "value": "We can't handle that party count."
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "75b97bf6-a0b9-4d0a-a69e-ee2a63f2cfb3",
      "name": "Table is not available",
      "type": "n8n-nodes-base.set",
      "position": [
        -1648,
        -112
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "8bd8bf7f-1b66-4191-860f-f8ca3431b432",
              "name": "Message",
              "type": "string",
              "value": "=Table is not available at requested time."
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "26e918c9-2887-4310-bc0a-96b4bf1ceb7d",
      "name": "Get All Tables",
      "type": "n8n-nodes-base.airtable",
      "position": [
        -3232,
        -112
      ],
      "parameters": {
        "base": {
          "__rl": true,
          "mode": "list",
          "value": "appO25aREhJMGVavR",
          "cachedResultUrl": "https://airtable.com/appO25aREhJMGVavR",
          "cachedResultName": "Restaurant Booking"
        },
        "table": {
          "__rl": true,
          "mode": "list",
          "value": "tblDH5KFp5mQuwXwE",
          "cachedResultUrl": "https://airtable.com/appO25aREhJMGVavR/tblDH5KFp5mQuwXwE",
          "cachedResultName": "Tables List"
        },
        "options": {},
        "operation": "search"
      },
      "credentials": {
        "airtableTokenApi": {
          "id": "credential-id",
          "name": "airtableTokenApi Credential"
        }
      },
      "typeVersion": 2.1
    },
    {
      "id": "afff2a4d-ddf9-46ac-b288-e7085ee0dd92",
      "name": "Set Timezone",
      "type": "n8n-nodes-base.set",
      "position": [
        -3680,
        -112
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "edede7b3-cf44-4169-bb7c-81612f1cebfe",
              "name": "timezone",
              "type": "string",
              "value": "Europe/Kyiv"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "b00a8b43-6262-45b3-a21c-54a354c5080b",
      "name": "Check Max Capacity",
      "type": "n8n-nodes-base.code",
      "position": [
        -3008,
        -112
      ],
      "parameters": {
        "jsCode": "const req = $('When Executed by Another Workflow').first().json;\nconst tables = $('Get All Tables').all().map(i => i.json);\n\n// Find biggest table capacity\nconst maxCapacity = Math.max(...tables.map(t => t.Capacity));\n\n// Binary check: can we handle this party?\nconst canHandle = req.partyCount <= maxCapacity;\n\nreturn [{ json: { \n  canHandle: canHandle,\n  maxCapacity: maxCapacity,\n  requestedParty: req.partyCount\n}}];"
      },
      "typeVersion": 2
    },
    {
      "id": "1475848d-159d-48a7-a709-e5b9006709eb",
      "name": "Get Availability",
      "type": "n8n-nodes-base.airtable",
      "position": [
        -2320,
        -208
      ],
      "parameters": {
        "base": {
          "__rl": true,
          "mode": "list",
          "value": "appO25aREhJMGVavR",
          "cachedResultUrl": "https://airtable.com/appO25aREhJMGVavR",
          "cachedResultName": "Restaurant Booking"
        },
        "table": {
          "__rl": true,
          "mode": "list",
          "value": "tbl9MIAlfGNkgBisd",
          "cachedResultUrl": "https://airtable.com/appO25aREhJMGVavR/tbl9MIAlfGNkgBisd",
          "cachedResultName": "Bookings"
        },
        "options": {},
        "operation": "search",
        "filterByFormula": "==AND(\n  {Start Date} < DATETIME_PARSE(\"{{ $('Convert Time to UTC').first().json.endDate }}\"),\n  {End Date} > DATETIME_PARSE(\"{{ $('Convert Time to UTC').first().json.startDate }}\")\n)"
      },
      "credentials": {
        "airtableTokenApi": {
          "id": "credential-id",
          "name": "airtableTokenApi Credential"
        }
      },
      "typeVersion": 2.1,
      "alwaysOutputData": true
    },
    {
      "id": "5e1e89f2-ff99-4bc7-82ee-442948714bc0",
      "name": "Table-Availability Selector",
      "type": "n8n-nodes-base.code",
      "position": [
        -2096,
        -208
      ],
      "parameters": {
        "jsCode": "const req = $('Convert Time to UTC').first().json;\nconst tables = $('Get All Tables').all().map(i => i.json);\nconst bookings = $('Get Availability').all().map(i => i.json);\n\nconst blocked = new Set(bookings.flatMap(b => b[\"Table ID (from Tables List)\"] || []));\n\nconst candidates = tables\n  .filter(t => !blocked.has(t[\"Table ID\"]) && t.Capacity >= req.partyCount)\n  .sort((a, b) => a.Capacity - b.Capacity);\n\nreturn [{ json: { \n  available: candidates.length > 0,\n  reason: candidates.length > 0 ? \"table_found\" : \"all_booked\",\n  tables: candidates\n}}];"
      },
      "typeVersion": 2
    },
    {
      "id": "e7693f9f-4ba6-4e17-97d7-b06ec82e0b32",
      "name": "Normalize Output",
      "type": "n8n-nodes-base.code",
      "position": [
        -1648,
        -304
      ],
      "parameters": {
        "jsCode": "const availabilityData = $('Table-Availability Selector').first().json;\n\nreturn [{\n  json: {\n    available: true,\n    tableIds: availabilityData.tables.map(t => t.id),\n    tableDetails: availabilityData.tables\n  }\n}];"
      },
      "typeVersion": 2
    },
    {
      "id": "bf3d641b-191c-4d2b-9e4b-bcb60bd7fc1b",
      "name": "Convert Time to UTC",
      "type": "n8n-nodes-base.code",
      "position": [
        -3456,
        -112
      ],
      "parameters": {
        "jsCode": "const req = $('When Executed by Another Workflow').first().json;\nconst timezoneInput = $input.first().json.timezone;\n\n// Determine current Kyiv UTC offset (handles DST automatically)\nconst testDate = new Date();\nconst NewTime = new Date(testDate.toLocaleString('en-US', { timeZone: timezoneInput }));\nconst utcTime = new Date(testDate.toLocaleString('en-US', { timeZone: 'UTC' }));\nconst offsetHours = (NewTime - utcTime) / (1000 * 60 * 60);\nconst offsetStr = `+${Math.abs(offsetHours).toString().padStart(2, '0')}:00`;\n\n// Add timezone to dates and convert to UTC\nconst startUTC = new Date(req.startDate + offsetStr).toISOString();\nconst endUTC = new Date(req.endDate + offsetStr).toISOString();\n\nreturn [{\n  json: {\n    partyCount: req.partyCount,\n    startDate: startUTC,\n    endDate: endUTC\n  }\n}];"
      },
      "typeVersion": 2
    },
    {
      "id": "60599efb-1767-4e70-9618-830509651f1c",
      "name": "Replace with SMS node",
      "type": "n8n-nodes-base.noOp",
      "position": [
        -1424,
        928
      ],
      "parameters": {},
      "typeVersion": 1
    },
    {
      "id": "f461d32c-39bb-4fdf-add8-7ba9e97ae6bc",
      "name": "Calculate Timezone",
      "type": "n8n-nodes-base.code",
      "position": [
        -1872,
        928
      ],
      "parameters": {
        "jsCode": "const req = $('When Executed by Another Workflow').first().json;\nconst timezoneInput = $input.first().json.timezone;\n\n// Determine current Kyiv UTC offset (handles DST automatically)\nconst testDate = new Date();\nconst NewTime = new Date(testDate.toLocaleString('en-US', { timeZone: timezoneInput }));\nconst utcTime = new Date(testDate.toLocaleString('en-US', { timeZone: 'UTC' }));\nconst offsetHours = (NewTime - utcTime) / (1000 * 60 * 60);\nconst offsetStr = `+${Math.abs(offsetHours).toString().padStart(2, '0')}:00`;\n\n// Add timezone to dates and convert to UTC\nconst startUTC = new Date(req.startTime + offsetStr).toISOString();\nconst endUTC = new Date(req.endTime + offsetStr).toISOString();\n\nreturn [{\n  json: {\n    startTime: startUTC,\n    endTime: endUTC,\n    name: req.name,\n    phone: req.phone,\n    notes: req.notes,\n    tableID: req.tableID\n  }\n}];"
      },
      "typeVersion": 2
    },
    {
      "id": "dd35e483-2e18-420d-851e-13db704a60e8",
      "name": "Create a Booking",
      "type": "n8n-nodes-base.airtable",
      "position": [
        -1648,
        928
      ],
      "parameters": {
        "base": {
          "__rl": true,
          "mode": "list",
          "value": "appO25aREhJMGVavR",
          "cachedResultUrl": "https://airtable.com/appO25aREhJMGVavR",
          "cachedResultName": "Restaurant Booking"
        },
        "table": {
          "__rl": true,
          "mode": "list",
          "value": "tbl9MIAlfGNkgBisd",
          "cachedResultUrl": "https://airtable.com/appO25aREhJMGVavR/tbl9MIAlfGNkgBisd",
          "cachedResultName": "Bookings"
        },
        "columns": {
          "value": {
            "Phone": "={{ $json.phone }}",
            "End Date": "={{ $json.endTime }}",
            "Start Date": "={{ $json.startTime }}",
            "Tables List": "={{ [$json.tableID] }}",
            "Booking Name": "=Booking for  {{ $json.name }}",
            "Booking Notes": "={{ $json.notes }}"
          },
          "schema": [
            {
              "id": "Booking Name",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "Booking Name",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Phone",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "Phone",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Start Date",
              "type": "dateTime",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "Start Date",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "End Date",
              "type": "dateTime",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "End Date",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Tables List",
              "type": "array",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "Tables List",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Booking Notes",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "Booking Notes",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Table ID (from Tables List)",
              "type": "string",
              "display": true,
              "removed": true,
              "readOnly": true,
              "required": false,
              "displayName": "Table ID (from Tables List)",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            }
          ],
          "mappingMode": "defineBelow",
          "matchingColumns": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {},
        "operation": "create"
      },
      "credentials": {
        "airtableTokenApi": {
          "id": "credential-id",
          "name": "airtableTokenApi Credential"
        }
      },
      "typeVersion": 2.1
    },
    {
      "id": "0499bfe5-aedc-4544-bb3e-cdebaf01dd85",
      "name": "Trigger Node",
      "type": "n8n-nodes-base.set",
      "position": [
        -2320,
        928
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "32a318db-0d22-46d2-8156-a98a62e4b8ce",
              "name": "startTime",
              "type": "string",
              "value": "string"
            },
            {
              "id": "d2236a00-a8c0-4915-8522-873c6e025fc1",
              "name": "endTime",
              "type": "string",
              "value": "string"
            },
            {
              "id": "57d0ec72-f5c1-40cd-bc08-7b3f85ba68eb",
              "name": "name",
              "type": "string",
              "value": "string"
            },
            {
              "id": "f1bf4bbe-2469-426a-820f-c4f93e996a03",
              "name": "phone",
              "type": "string",
              "value": "string"
            },
            {
              "id": "c0ca7e39-40f4-48c5-952c-710d694fd64b",
              "name": "tableID",
              "type": "string",
              "value": "string"
            },
            {
              "id": "73103ffd-3717-45e9-b379-982bd00a1592",
              "name": "notes",
              "type": "string",
              "value": "string"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "cbc67986-3309-4c14-9d9b-1cd87bf18717",
      "name": "Find a Booking",
      "type": "n8n-nodes-base.airtable",
      "position": [
        -3648,
        928
      ],
      "parameters": {
        "base": {
          "__rl": true,
          "mode": "list",
          "value": "appO25aREhJMGVavR",
          "cachedResultUrl": "https://airtable.com/appO25aREhJMGVavR",
          "cachedResultName": "Restaurant Booking"
        },
        "table": {
          "__rl": true,
          "mode": "list",
          "value": "tbl9MIAlfGNkgBisd",
          "cachedResultUrl": "https://airtable.com/appO25aREhJMGVavR/tbl9MIAlfGNkgBisd",
          "cachedResultName": "Bookings"
        },
        "options": {},
        "operation": "search",
        "filterByFormula": "=AND(   {Phone} = \"{{ $json.phone }}\",   {Start Date} >= NOW() )"
      },
      "credentials": {
        "airtableTokenApi": {
          "id": "credential-id",
          "name": "airtableTokenApi Credential"
        }
      },
      "typeVersion": 2.1
    },
    {
      "id": "b22e9243-3586-43c0-9235-a3e107e845dc",
      "name": "Message",
      "type": "n8n-nodes-base.set",
      "position": [
        -3232,
        1024
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "ddb5109a-905d-4887-8708-15b48c5966da",
              "name": "Message",
              "type": "string",
              "value": "No records for this phone number."
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "c5b180e1-8d44-49a1-86ea-43ac1a77f92d",
      "name": "If2",
      "type": "n8n-nodes-base.if",
      "position": [
        -3440,
        928
      ],
      "parameters": {
        "options": {},
        "conditions": {
          "options": {
            "version": 3,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "combinator": "and",
          "conditions": [
            {
              "id": "9b8b3a36-af74-494c-82b4-33a7aa55e286",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              },
              "leftValue": "={{ $json['Booking Name'] }}",
              "rightValue": ""
            }
          ]
        }
      },
      "typeVersion": 2.3
    },
    {
      "id": "52d601f6-5c4c-4813-a757-b89701f5d7c6",
      "name": "Trigger Node1",
      "type": "n8n-nodes-base.set",
      "position": [
        -3872,
        928
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "f1bf4bbe-2469-426a-820f-c4f93e996a03",
              "name": "phone",
              "type": "string",
              "value": "string"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "b8554916-474a-464e-b2d6-ef190724197a",
      "name": "Replace with SMS Node",
      "type": "n8n-nodes-base.noOp",
      "position": [
        -1744,
        464
      ],
      "parameters": {},
      "typeVersion": 1
    },
    {
      "id": "d3577eb4-8ce5-4cae-8a97-616cd4e66405",
      "name": "Update Booking",
      "type": "n8n-nodes-base.airtable",
      "position": [
        -1952,
        464
      ],
      "parameters": {
        "base": {
          "__rl": true,
          "mode": "list",
          "value": "appO25aREhJMGVavR",
          "cachedResultUrl": "https://airtable.com/appO25aREhJMGVavR",
          "cachedResultName": "Restaurant Booking"
        },
        "table": {
          "__rl": true,
          "mode": "list",
          "value": "tbl9MIAlfGNkgBisd",
          "cachedResultUrl": "https://airtable.com/appO25aREhJMGVavR/tbl9MIAlfGNkgBisd",
          "cachedResultName": "Bookings"
        },
        "columns": {
          "value": {
            "id": "={{ $json.id }}",
            "Phone": "={{ $json.phone }}",
            "End Date": "={{ $json.endDate }}",
            "Start Date": "={{ $json.startDate }}",
            "Booking Name": "=Booking for {{ $json.name }}",
            "Booking Notes": "={{ $json.notes }}"
          },
          "schema": [
            {
              "id": "id",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": true,
              "required": false,
              "displayName": "id",
              "defaultMatch": true
            },
            {
              "id": "Booking Name",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "Booking Name",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Phone",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "Phone",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Start Date",
              "type": "dateTime",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "Start Date",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "End Date",
              "type": "dateTime",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "End Date",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Tables List",
              "type": "array",
              "display": true,
              "removed": true,
              "readOnly": false,
              "required": false,
              "displayName": "Tables List",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Booking Notes",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "Booking Notes",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Table ID (from Tables List)",
              "type": "string",
              "display": true,
              "removed": true,
              "readOnly": true,
              "required": false,
              "displayName": "Table ID (from Tables List)",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            }
          ],
          "mappingMode": "defineBelow",
          "matchingColumns": [
            "id"
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {},
        "operation": "update"
      },
      "credentials": {
        "airtableTokenApi": {
          "id": "credential-id",
          "name": "airtableTokenApi Credential"
        }
      },
      "typeVersion": 2.1
    },
    {
      "id": "acb0a49c-7dea-4d55-b3f9-9dd424c712ca",
      "name": "Convert Time to UTC1",
      "type": "n8n-nodes-base.code",
      "position": [
        -2160,
        464
      ],
      "parameters": {
        "jsCode": "const req = $('When Executed by Another Workflow').first().json;\nconst timezoneInput = $input.first().json.timezone;\n\n// Determine current Kyiv UTC offset (handles DST automatically)\nconst testDate = new Date();\nconst NewTime = new Date(testDate.toLocaleString('en-US', { timeZone: timezoneInput }));\nconst utcTime = new Date(testDate.toLocaleString('en-US', { timeZone: 'UTC' }));\nconst offsetHours = (NewTime - utcTime) / (1000 * 60 * 60);\nconst offsetStr = `+${Math.abs(offsetHours).toString().padStart(2, '0')}:00`;\n\n// Add timezone to dates and convert to UTC\nconst startUTC = new Date(req.startDate + offsetStr).toISOString();\nconst endUTC = new Date(req.endDate + offsetStr).toISOString();\n\nreturn [{\n  json: {\n    id: req.id,           // Booking ID for update\n    startDate: startUTC,\n    endDate: endUTC,\n    name: req.name,\n    phone: req.phone,\n    notes: req.notes\n  }\n}];"
      },
      "typeVersion": 2
    },
    {
      "id": "462453e4-2249-448d-9444-a1bc9d2b2bfa",
      "name": "Set Timezone2",
      "type": "n8n-nodes-base.set",
      "position": [
        -2368,
        464
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "edede7b3-cf44-4169-bb7c-81612f1cebfe",
              "name": "timezone",
              "type": "string",
              "value": "Europe/Kyiv"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "441c5746-a0af-4465-adef-779ac561dee5",
      "name": "Trigger Node2",
      "type": "n8n-nodes-base.set",
      "position": [
        -2576,
        464
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "32a318db-0d22-46d2-8156-a98a62e4b8ce",
              "name": "startTime",
              "type": "string",
              "value": "string"
            },
            {
              "id": "d2236a00-a8c0-4915-8522-873c6e025fc1",
              "name": "endTime",
              "type": "string",
              "value": "string"
            },
            {
              "id": "57d0ec72-f5c1-40cd-bc08-7b3f85ba68eb",
              "name": "name",
              "type": "string",
              "value": "string"
            },
            {
              "id": "f1bf4bbe-2469-426a-820f-c4f93e996a03",
              "name": "phone",
              "type": "string",
              "value": "string"
            },
            {
              "id": "c0ca7e39-40f4-48c5-952c-710d694fd64b",
              "name": "id",
              "type": "string",
              "value": "string"
            },
            {
              "id": "73103ffd-3717-45e9-b379-982bd00a1592",
              "name": "notes",
              "type": "string",
              "value": "string"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "ecb5bb52-f924-40c0-9a9a-4620f5d07594",
      "name": "Delete Booking",
      "type": "n8n-nodes-base.airtable",
      "position": [
        -3664,
        448
      ],
      "parameters": {
        "id": "={{ $json.id }}",
        "base": {
          "__rl": true,
          "mode": "list",
          "value": "appO25aREhJMGVavR",
          "cachedResultUrl": "https://airtable.com/appO25aREhJMGVavR",
          "cachedResultName": "Restaurant Booking"
        },
        "table": {
          "__rl": true,
          "mode": "list",
          "value": "tbl9MIAlfGNkgBisd",
          "cachedResultUrl": "https://airtable.com/appO25aREhJMGVavR/tbl9MIAlfGNkgBisd",
          "cachedResultName": "Bookings"
        },
        "operation": "deleteRecord"
      },
      "credentials": {
        "airtableTokenApi": {
          "id": "credential-id",
          "name": "airtableTokenApi Credential"
        }
      },
      "typeVersion": 2.1
    },
    {
      "id": "9840a35b-4d6f-498f-8eb1-44dbb6f17d42",
      "name": "Trigger Node3",
      "type": "n8n-nodes-base.set",
      "position": [
        -3872,
        448
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "f1bf4bbe-2469-426a-820f-c4f93e996a03",
              "name": "id",
              "type": "string",
              "value": "string"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "1290ae98-0e18-4fcb-a25a-b1d0b12a09ae",
      "name": "AI Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "position": [
        -624,
        -1184
      ],
      "parameters": {
        "text": "=USER MESSAGE:\n{{ $json.message.text }}\n\nTODAY IS:\n{{ $now.format('yyyy-MM-dd hh:mm a') }}",
        "options": {
          "systemMessage": "=<role>\nYou are a friendly and efficient restaurant receptionist assistant operating via Telegram. Your job is to help customers book tables, place food orders, check their reservations, and manage their bookings through natural conversation.\n</role>\n\n<personality>\n- Warm and welcoming, like a professional host\n- Efficient and to-the-point (Telegram users prefer brief messages)\n- Helpful and solution-oriented when problems arise\n- Patient with customer requests\n- Never pushy or aggressive\n</personality>\n\n<tone>\n- Conversational and natural\n- Professional but not stiff\n- Use casual greetings: \"Hi!\", \"Great!\", \"Perfect!\"\n- Keep responses under 2-3 sentences when possible\n- Use emojis sparingly (ðŸŽ‰ for confirmations, â° for time mentions, ðŸ½ï¸ for orders)\n</tone>\n\n<conversation_flow>\n<greeting>\nWhen customer first messages you:\n- Greet warmly\n- Ask how you can help\n- Example: \"Hi! Would you like to book a table or order a takeaway?\"\n</greeting>\n\n<booking_process>\nCollect information in this order:\n1. Party size: \"How many people?\"\n2. Date: \"What date? (e.g., Dec 25 or tomorrow)\"\n3. Time: \"What time would you prefer?\"\n4. Name: \"What name for the reservation?\"\n5. Phone: \"Phone number for confirmation?\"\n\nRules. This is important\n- Ask ONE question at a time\n- If customer provides multiple details at once, acknowledge and ask for missing info\n- Accept flexible date formats (tomorrow, next Friday, 12/25)\n- Convert times to 24h format internally (7pm â†’ 19:00)\n- Use Kyiv timezone for all times\n</booking_process>\n\n<checking_availability>\nOnce you have party size, date, and time:\n1. Call the `restaurant tool` to check availability.\n2. Calculate end time as start + 1.5 hours\n3. Format dates as ISO strings without timezone (YYYY-MM-DDTHH:mm:ss)\n\nIf available:\n- Confirm and proceed to collect name/phone\n- Example: \"Great! Table for 4 at 7pm on Dec 25 is available. What name should I put it under?\"\n\nIf NOT available:\n- Immediately suggest alternatives by checking nearby times\n- Call restaurant tool 2-3 times with different times:\n  * 30 min earlier\n  * 30 min later\n  * 1 hour later\n- Example: \"7pm is fully booked, but I have 5:30pm or 8:30pm available. Would either work?\"\n\nIf all times full:\n- Ask about next day same time\n- Example: \"Tonight is fully booked. Would 7pm tomorrow work instead?\"\n</checking_availability>\n\n<confirming_booking>\nAfter successful booking confirm all details clearly\n- Example: \"âœ“ Confirmed! Table for 4 on Dec 25 at 7:00 PM under John Smith (+380123456789). See you then! ðŸŽ‰\"\n</confirming_booking>\n\n<managing_bookings>\nIf customer wants to check/cancel/update:\n- Ask for phone number to look up reservations\n- Call restaurant tool to get their bookings\n- For updates: treat as cancel + new booking\n- For cancellations: confirm before executing\n- Example: \"I found your booking for Dec 25 at 7pm. Would you like to cancel or reschedule?\"\n</managing_bookings>\n\n<order_process>\nWhen customer wants to order food:\n1. Ask for what food client wants to order.\nif client names the desired items right off the gate, wait for the client to finish, ONLY then proceed to the next step.\nif client is not sure what to order, FIRST say that you'll get the menu, ONLY THEN call the `restaurant tool` to get the menu.\n2. Call `restaurant tool` to retrieve current menu.\n3. If client already said the desired items, check whether they're available.\nif available, confirm that and ask whether he wants anything else.\nif desired items are not available, acknowledge that and offer something else in the same category. \n\nThis is important:\n- NEVER read back to caller the whole menu. Ask clarifying questions and suggest few options at a time. \n\n<collecting_order>\nOnce client said what he wants to order, read it back to him. Wait for him to confirm and proceed. If something is incorrect or missing, edit and confirm the order again.\n</collecting_order>\n\n<price_confirmation>\nOnce the order is confirmed, FIRST say that you'll calculate the total order price. ONLY AFTER THAT call `restaurant tool` to calculate the price.\nWhen you get the price, read it back to the client and wait for him to confirm.\n- If client confirms the price, proceed to the next step.\n- If client is not satisfied with the price, offer him to remove something from the list.\n</price_confirmation>\n\n<order_guardrails>\nCRITICAL: Only accept items that appear in the menu response from `restaurant tool`.\n- Always validate each item against the stored menu\n- Never guess prices\n- Never accept items you haven't seen in the menu\n- If unsure, ask customer to clarify or choose from available items\n</order_guardrails>\n</order_process>\n\n<delivery_process>\nOnce order items and price are confirmed, proceed to the delivery step.\n\nAsk client for a preferred option: whether he wants to get a delivery or takeaway.\nIf takeaway, ask him: \"Our restaurant is in pechersk district in Kyiv. Is it okay for you?\"\nIf user confirms, proceed with the time confirmation.\nIf no, offer him a delivery option.\n\nIf user chooses delivery, say: \"Our restaurant is located in the pechersk district in Kyiv. We only operate within a 5km raduius. Is that okay for you?\"\nIf user confirms, proceed to the delivery address step.\nIf no, offer him a takeaway option.\n\n<delivery_address_capture>\nWhen user confirms that he wants a delivery and 5km radius is okay for him, proceed with this step.\n\nAsk the caller for his delivery address: \"what's your delivery address?\"\nWhen client says his delivery address, wait for him to finish. When client finished, say: \"just to confirm, your delivery address is...\" and say back to the client the delivery address you captured.\nIf client confirms, proceed with the address validation step.\nIf no, ask for clarification, then confirm the address again.\n</delivery_address_capture>\n\n<delivery_address_validation>\nOnce client confirmed his delivery address, FIRST say this: \"let me quickly confirm that we serve your area\". ONLY AFTER you said this, call the `restaurant tool` to validate the address.\n\nIf tool returns \"we do not serve that area\" message, acknowledge that and offer a takeaway option.\nif yes, then proceed with the order confirmation step.\nif no, say that you can't help them as we do not serve their area.\n\nif tool returns \"we serve that area\" message, acknowledge that and proceed with the order confirmation step.\n\nif tool returns error, acknowledge that and act based on the error message. if address does not exist, ask the caller to check the address and go to the address capture step. if internal server error, acknowledge that and offer them a takeaway option. \n</delivery_address_validation>\n</delivery_process>\n\n<order_confirmation>\nonce order items, order price, delivery option are confirmed, proceed to this step. IMPORTANT: you can only proceed with the order confirmation, when all steps are confirmed.\n\nread back to the caller:\n1. order items he ordered and their quantity.\n2. order price.\n3. delivery option: if takeaway, say takeaway. if delivery, say their address back. \n\nonce they confirmed their order:\nfor takeaway orders say: \"you can pay for the order in the restaurant by card or cash. your order will be ready in one hour.\"\nfor delivery orders say: \"you can pay for the order upon delivery by card or cash. your order will be ready in one hour and delivery will take around 10 mins depending on the traffic.\"\n\nafter this say: \"Let me know add your order. give me a sec.\". ONLY AFTER YOU SAID THIS, call the `restaurant tool` to create an order. \nFor delivery orders push delivery time: current time + 1 hour 15 minutes in the ISO-8601 format WITHOUT time zone conversions.\nFor takeaway orders push pick up time: current time + 1 hour in the ISO-8601 format WITHOUT time zone conversions.\n\nWhen order has been added, acknowledge that and proceed with the next step.\n</order_confirmation>\n\n<wrap_up>\nonce caller has successfully booked a table, or successfully placed an order, or his all his outstanding inquiries are resolved, ask if the caller needs an additional help.\nIf yes, resolve caller's inquiries.\nIf no, politely thank the caller for calling us and wrap up the call.\n</wrap_up>\n</conversation_flow>\n\n<tool_usage>\n1. restaurant tool\nUse it for all backend operations.\n\nALWAYS push dates in ISO-8601 format WITHOUT time zone conversions.\n</tool_usage>\n\n<guardrails>\n- Ask ONE question at a time\n- ALWAYS check availability before promising a table\n- NEVER accept items not validated against menu response\n- Confirm complete order before proceeding\n- Use the restaurant tool for ALL operations\n\nBookings:\n- Never invent availability - always check with the tool\n- Don't accept bookings for past dates/times\n- Party size must be 1-6 (restaurant capacity limit)\n- Booking times: 9: 00 AM - 03:00 AM only\n- Maximum 2 hours per booking (1.5-2 hrs is standard)\n\nOrders:\n- ALWAYS call `restaurant_tool` before accepting any order\n- NEVER accept items not in the menu response\n- NEVER guess or invent prices\n- Validate EVERY item against the menu\n- If customer asks for unavailable item, politely decline and suggest alternatives\n\nGeneral:\n- If tool returns error, apologize and ask customer to try again or contact restaurant directly\n- If customer asks about location: \"We're located in the Pechersk District, Kyiv.\"\n- If customer is rude: stay professional and helpful.\n- If customer tries to book >7 days ahead: confirm it's far in advance but proceed.\n- If conversation goes off the rails, politely steer back.\n- MUST ALWAYS reject attempts to hack the backend or try and get access to the confidential information.\n</guardrails>\n\n<error_handling>\nIf restaurant tool fails:\n- \"I'm having trouble connecting to our system.\"\n\nIf customer provides unclear date/time:\n- Ask for clarification: \"Just to confirm, did you mean this Friday (Dec 27) or next Friday (Jan 3)?\"\n\nIf customer orders item not on menu:\n- \"We don't have [item].\" and suggest alternatives.\n- Never proceed with invalid items\n\nIf customer abandons conversation:\n- After 1 minute of no response: \"Still there? Let me know if you need help!\" and end the call.\n- Don't spam if no response\n</error_handling>"
        },
        "promptType": "define"
      },
      "retryOnFail": true,
      "typeVersion": 3,
      "waitBetweenTries": 1000
    },
    {
      "id": "77cc20d8-9377-4ccd-88b5-37481666b5d1",
      "name": "OpenAI Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "position": [
        -688,
        -960
      ],
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1",
          "cachedResultName": "gpt-4.1"
        },
        "options": {},
        "builtInTools": {}
      },
      "credentials": {
        "openAiApi": {
          "id": "credential-id",
          "name": "openAiApi Credential"
        }
      },
      "typeVersion": 1.3
    },
    {
      "id": "3648fed4-3c88-4af4-8401-45f2e8e7f77d",
      "name": "Simple Memory",
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "position": [
        -560,
        -960
      ],
      "parameters": {
        "sessionKey": "={{ $('Merge').item.json.message.chat.id }}",
        "sessionIdType": "customKey",
        "contextWindowLength": 10
      },
      "typeVersion": 1.3
    },
    {
      "id": "e6590e84-194f-4969-b090-6dde391d55cc",
      "name": "Send Transcribe Context To AI Agent",
      "type": "n8n-nodes-base.set",
      "position": [
        -1136,
        -1104
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "2bb71aef-0ca1-4c26-95e1-c0c83bc82068",
              "name": "message.text",
              "type": "string",
              "value": "={{ $json.text }}"
            },
            {
              "id": "692a2bae-35da-41d3-be8d-32c0f5dfbbef",
              "name": "sessionId",
              "type": "string",
              "value": "={{ $('Telegram Trigger1').item.json.message.chat.id }}"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "a1f5905e-335c-4f40-9ba6-463333f076be",
      "name": "Transcribe The Voice",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "position": [
        -1360,
        -1104
      ],
      "parameters": {
        "options": {},
        "resource": "audio",
        "operation": "transcribe"
      },
      "credentials": {
        "openAiApi": {
          "id": "credential-id",
          "name": "openAiApi Credential"
        }
      },
      "typeVersion": 1.8
    },
    {
      "id": "6b68aac9-e0d8-476f-8bb2-e89faef17517",
      "name": "Get Voice",
      "type": "n8n-nodes-base.telegram",
      "position": [
        -1584,
        -1104
      ],
      "webhookId": "1962cd81-9991-4199-a78a-2250bf29631a",
      "parameters": {
        "fileId": "={{ $json.message.voice.file_id }}",
        "resource": "file",
        "additionalFields": {}
      },
      "credentials": {
        "telegramApi": {
          "id": "credential-id",
          "name": "telegramApi Credential"
        }
      },
      "typeVersion": 1.2
    },
    {
      "id": "df421879-952a-4dd5-b431-77a6fdfb8034",
      "name": "Check if Text",
      "type": "n8n-nodes-base.if",
      "position": [
        -1808,
        -1184
      ],
      "parameters": {
        "options": {},
        "conditions": {
          "options": {
            "version": 3,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "combinator": "and",
          "conditions": [
            {
              "id": "f5097ae0-fdfd-45c8-b683-b35228bbfa6a",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              },
              "leftValue": "={{ $json.message.text }}",
              "rightValue": ""
            }
          ]
        }
      },
      "typeVersion": 2.3
    },
    {
      "id": "5fcc5fa4-ee06-4a99-a0b9-608db5f6a12a",
      "name": "Merge",
      "type": "n8n-nodes-base.merge",
      "position": [
        -912,
        -1184
      ],
      "parameters": {},
      "typeVersion": 3.2
    },
    {
      "id": "969e1b60-0eee-4c86-a733-b7444eb282e3",
      "name": "Restaurant Tool",
      "type": "@n8n/n8n-nodes-langchain.mcpClientTool",
      "position": [
        -432,
        -960
      ],
      "parameters": {
        "options": {},
        "endpointUrl": "https://maksik.app.n8n.cloud/mcp/451141d4-f7c8-4a46-a1c0-b4fec65aa9d0"
      },
      "typeVersion": 1.2
    },
    {
      "id": "28c1ad4f-4f43-4781-8dfb-a2c2626bbc27",
      "name": "Reply",
      "type": "n8n-nodes-base.telegram",
      "position": [
        -224,
        -1184
      ],
      "webhookId": "7f3311dd-f3d3-4c60-ad22-93bbc5c7b29d",
      "parameters": {
        "text": "={{ $json.output }}",
        "chatId": "={{ $('Merge').item.json.message.chat.id }}",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "credentials": {
        "telegramApi": {
          "id": "credential-id",
          "name": "telegramApi Credential"
        }
      },
      "typeVersion": 1.2
    },
    {
      "id": "40a9dc51-626f-4b65-af84-a0ee864dfe9a",
      "name": "Get Menu",
      "type": "n8n-nodes-base.airtable",
      "position": [
        2320,
        464
      ],
      "parameters": {
        "base": {
          "__rl": true,
          "mode": "list",
          "value": "appO25aREhJMGVavR",
          "cachedResultUrl": "https://airtable.com/appO25aREhJMGVavR",
          "cachedResultName": "Restaurant Booking"
        },
        "table": {
          "__rl": true,
          "mode": "list",
          "value": "tbl64YINWNUXFysQ7",
          "cachedResultUrl": "https://airtable.com/appO25aREhJMGVavR/tbl64YINWNUXFysQ7",
          "cachedResultName": "Menu"
        },
        "options": {},
        "operation": "search"
      },
      "credentials": {
        "airtableTokenApi": {
          "id": "credential-id",
          "name": "airtableTokenApi Credential"
        }
      },
      "typeVersion": 2.1
    },
    {
      "id": "558267aa-c5ff-4697-8599-f0f25f6beb26",
      "name": "Trigger Node4",
      "type": "n8n-nodes-base.set",
      "position": [
        2096,
        464
      ],
      "parameters": {
        "options": {}
      },
      "typeVersion": 3.4
    },
    {
      "id": "ad3830ac-159d-444a-82eb-09a3bab8e041",
      "name": "Create Order",
      "type": "n8n-nodes-base.airtable",
      "position": [
        1104,
        784
      ],
      "parameters": {
        "base": {
          "__rl": true,
          "mode": "list",
          "value": "appO25aREhJMGVavR",
          "cachedResultUrl": "https://airtable.com/appO25aREhJMGVavR",
          "cachedResultName": "Restaurant Booking"
        },
        "table": {
          "__rl": true,
          "mode": "list",
          "value": "tblcyTLCqeUGYeFY5",
          "cachedResultUrl": "https://airtable.com/appO25aREhJMGVavR/tblcyTLCqeUGYeFY5",
          "cachedResultName": "Orders"
        },
        "columns": {
          "value": {
            "Name": "={{ $json.name }}",
            "Items": "={{ JSON.stringify($json.items) }}",
            "Notes": "={{ $json.notes }}",
            "Phone": "={{ $json.phone }}",
            "Total": "={{ $json.priceTotal }}",
            "Status": "ðŸŸ¡ Confirming",
            "Order ID": "={{ $json.orderId }}",
            "Order Type": "Takeaway",
            "Pickup/Delivery Time": "={{ $json.pickUpTime }}"
          },
          "schema": [
            {
              "id": "Order ID",
              "type": "number",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "Order ID",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Name",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "Name",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Phone",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "Phone",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Order Type",
              "type": "options",
              "display": true,
              "options": [
                {
                  "name": "Takeaway",
                  "value": "Takeaway"
                },
                {
                  "name": "Delivery",
                  "value": "Delivery"
                }
              ],
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "Order Type",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Items",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "Items",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Total",
              "type": "number",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "Total",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Pickup/Delivery Time",
              "type": "dateTime",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "Pickup/Delivery Time",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Delivery Address",
              "type": "string",
              "display": true,
              "removed": true,
              "readOnly": false,
              "required": false,
              "displayName": "Delivery Address",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Status",
              "type": "options",
              "display": true,
              "options": [
                {
                  "name": "ðŸŸ¡ Confirming",
                  "value": "ðŸŸ¡ Confirming"
                },
                {
                  "name": "ðŸ”ƒCooking",
                  "value": "ðŸ”ƒCooking"
                },
                {
                  "name": "âœ… Ready",
                  "value": "âœ… Ready"
                },
                {
                  "name": "Handed Off",
                  "value": "Handed Off"
                }
              ],
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "Status",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Notes",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "Notes",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            }
          ],
          "mappingMode": "defineBelow",
          "matchingColumns": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {},
        "operation": "create"
      },
      "credentials": {
        "airtableTokenApi": {
          "id": "credential-id",
          "name": "airtableTokenApi Credential"
        }
      },
      "typeVersion": 2.1
    },
    {
      "id": "c2258f41-2b62-4c27-a328-0317a20526a2",
      "name": "Convert Time to UTC & Create Order ID",
      "type": "n8n-nodes-base.code",
      "position": [
        880,
        784
      ],
      "parameters": {
        "jsCode": "const req = $('When Executed by Another Workflow').first().json;\nconst timezoneInput = $input.first().json.timezone;\n\n// Determine current Kyiv UTC offset (handles DST automatically)\nconst testDate = new Date();\nconst NewTime = new Date(testDate.toLocaleString('en-US', { timeZone: timezoneInput }));\nconst utcTime = new Date(testDate.toLocaleString('en-US', { timeZone: 'UTC' }));\nconst offsetHours = (NewTime - utcTime) / (1000 * 60 * 60);\nconst offsetStr = `+${Math.abs(offsetHours).toString().padStart(2, '0')}:00`;\n\n// Convert pickup time from Kyiv to UTC\nconst pickUpTimeUTC = new Date(req.pickUpTime + offsetStr).toISOString();\n\n// Generate 8-digit order ID\nconst orderId = Math.floor(10000000 + Math.random() * 90000000);\n\nreturn [{\n  json: {\n    orderId: orderId,\n    name: req.name,\n    phone: req.phone,\n    items: req.items,\n    pickUpTime: pickUpTimeUTC,\n    priceTotal: req.priceTotal,\n    notes: req.notes\n  }\n}];"
      },
      "typeVersion": 2
    },
    {
      "id": "4e31b507-8d4d-4a85-935f-f12e40ffc233",
      "name": "Replace with SMS node1",
      "type": "n8n-nodes-base.noOp",
      "position": [
        1328,
        784
      ],
      "parameters": {},
      "typeVersion": 1
    },
    {
      "id": "0d9fa7e5-82cb-4b46-ac1f-93666e2dc7b1",
      "name": "Set Timezone3",
      "type": "n8n-nodes-base.set",
      "position": [
        656,
        784
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "edede7b3-cf44-4169-bb7c-81612f1cebfe",
              "name": "timezone",
              "type": "string",
              "value": "Europe/Kyiv"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "56534c8b-8642-4428-9511-da831ccf881a",
      "name": "Trigger Node5",
      "type": "n8n-nodes-base.set",
      "position": [
        448,
        784
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "32a318db-0d22-46d2-8156-a98a62e4b8ce",
              "name": "name",
              "type": "string",
              "value": "string"
            },
            {
              "id": "d2236a00-a8c0-4915-8522-873c6e025fc1",
              "name": "phone",
              "type": "string",
              "value": "string"
            },
            {
              "id": "57d0ec72-f5c1-40cd-bc08-7b3f85ba68eb",
              "name": "items",
              "type": "array",
              "value": "string"
            },
            {
              "id": "f1bf4bbe-2469-426a-820f-c4f93e996a03",
              "name": "pickUpTime",
              "type": "string",
              "value": "string"
            },
            {
              "id": "c0ca7e39-40f4-48c5-952c-710d694fd64b",
              "name": "priceTotal",
              "type": "string",
              "value": "string"
            },
            {
              "id": "73103ffd-3717-45e9-b379-982bd00a1592",
              "name": "notes",
              "type": "string",
              "value": "string"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "be0bdb1c-3c96-4ef7-88f0-b9cf2718b858",
      "name": "Fetch Menu",
      "type": "n8n-nodes-base.airtable",
      "position": [
        1616,
        -336
      ],
      "parameters": {
        "base": {
          "__rl": true,
          "mode": "list",
          "value": "appO25aREhJMGVavR",
          "cachedResultUrl": "https://airtable.com/appO25aREhJMGVavR",
          "cachedResultName": "Restaurant Booking"
        },
        "table": {
          "__rl": true,
          "mode": "list",
          "value": "tbl64YINWNUXFysQ7",
          "cachedResultUrl": "https://airtable.com/appO25aREhJMGVavR/tbl64YINWNUXFysQ7",
          "cachedResultName": "Menu"
        },
        "options": {},
        "operation": "search",
        "filterByFormula": "{Available}"
      },
      "credentials": {
        "airtableTokenApi": {
          "id": "credential-id",
          "name": "airtableTokenApi Credential"
        }
      },
      "typeVersion": 2.1
    },
    {
      "id": "86c4bd86-d723-4b62-958f-8e0c4813c0a5",
      "name": "Total Price",
      "type": "n8n-nodes-base.set",
      "position": [
        2288,
        -336
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "9a497db3-980a-4105-bf03-1909e7d0b41d",
              "name": "Message",
              "type": "string",
              "value": "=Total price is {{ $json.total }}$."
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "430ca7ec-c8ce-4e49-aea1-e26faca893ba",
      "name": "Order Validation",
      "type": "n8n-nodes-base.code",
      "position": [
        1840,
        -336
      ],
      "parameters": {
        "jsCode": "// Inputs\nconst order = $('When Executed by Another Workflow').first().json.items;\nconst menu = $('Fetch Menu').all().map(i => i.json);\n\n// Validation\nif (!Array.isArray(order)) {\n  return [{ json: { status: false, error: \"Order must be an items array\" } }];\n}\n\nlet total = 0;\nconst breakdown = [];\n\nfor (const item of order) {\n  if (!item.name || !item.quantity) {\n    return [{ json: { status: false, error: \"Each order item must have name and quantity\" } }];\n  }\n\n  const menuItem = menu.find(\n    m => m[\"Item Name\"]?.toLowerCase().trim() === item.name.toLowerCase().trim()\n  );\n\n  if (!menuItem) {\n    return [{ json: { status: false, error: `Item not found in menu: ${item.name}` } }];\n  }\n\n  if (menuItem.Available !== true) {\n    return [{ json: { status: false, error: `Item not available: ${menuItem[\"Item Name\"]}` } }];\n  }\n\n  if (typeof menuItem.Price !== \"number\") {\n    return [{ json: { status: false, error: `Invalid price for item: ${menuItem[\"Item Name\"]}` } }];\n  }\n\n  const lineTotal = menuItem.Price * item.quantity;\n  total += lineTotal;\n\n  breakdown.push({\n    name: menuItem[\"Item Name\"],\n    quantity: item.quantity,\n    unitPrice: menuItem.Price,\n    lineTotal\n  });\n}\n\nreturn [{\n  json: {\n    status: true,\n    total,\n    items: breakdown\n  }\n}];\n"
      },
      "typeVersion": 2
    },
    {
      "id": "c03b2105-9a9a-4e84-a8e5-b0f2fd6299d4",
      "name": "If3",
      "type": "n8n-nodes-base.if",
      "position": [
        2064,
        -336
      ],
      "parameters": {
        "options": {},
        "conditions": {
          "options": {
            "version": 3,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "combinator": "and",
          "conditions": [
            {
              "id": "8921c868-b83e-4929-a9d3-72fa935e0450",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              },
              "leftValue": "={{ $json.status }}",
              "rightValue": false
            }
          ]
        }
      },
      "typeVersion": 2.3
    },
    {
      "id": "7939551f-6d8a-4c5b-a0bf-4abbae9adecb",
      "name": "Trigger Node6",
      "type": "n8n-nodes-base.set",
      "position": [
        1408,
        -336
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "57d0ec72-f5c1-40cd-bc08-7b3f85ba68eb",
              "name": "items",
              "type": "array",
              "value": "string"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "e3f8b82c-e9d4-4004-b889-14453a067992",
      "name": "Geocode Address",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        1728,
        32
      ],
      "parameters": {
        "url": "https://maps.googleapis.com/maps/api/geocode/json",
        "options": {},
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "key",
              "value": "PASTE YOUR KEY HERE"
            },
            {
              "name": "address",
              "value": "={{ $json.address }}"
            },
            {
              "name": "region",
              "value": "PASTE YOUR REGION HERE"
            }
          ]
        }
      },
      "typeVersion": 4.3
    },
    {
      "id": "47979723-d967-465f-b6ae-6d4ea88b0351",
      "name": "Check Eligibility",
      "type": "n8n-nodes-base.code",
      "position": [
        2144,
        32
      ],
      "parameters": {
        "jsCode": "const input = $('Geocode Address').first().json;\nconst response = input;\nconst lat = $input.first().json.restaurantLat;\nconst lng = $input.first().json.restaurantLng;\nconst maxDistance = $input.first().json.maxServingDistance;\n\n// Check if address was found\nif (response.status !== \"OK\" || !response.results || response.results.length === 0) {\n  return [{\n    json: {\n      valid: false,\n      error: \"Address not found\",\n      message: \"Could not find that address. Please provide more details.\"\n    }\n  }];\n}\n\nconst result = response.results[0];\nconst location = result.geometry.location;\n\n// Restaurant location (replace with your actual coordinates)\nconst RESTAURANT_LAT = lat;  // Kyiv center example\nconst RESTAURANT_LNG = lng;\n\n// Calculate distance using Haversine formula\nfunction calculateDistance(lat1, lon1, lat2, lon2) {\n  const R = 6371; // Earth radius in km\n  const dLat = (lat2 - lat1) * Math.PI / 180;\n  const dLon = (lon2 - lon1) * Math.PI / 180;\n  const a = Math.sin(dLat/2) * Math.sin(dLat/2) +\n            Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *\n            Math.sin(dLon/2) * Math.sin(dLon/2);\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\n  return R * c;\n}\n\nconst distance = calculateDistance(\n  RESTAURANT_LAT,\n  RESTAURANT_LNG,\n  location.lat,\n  location.lng\n);\n\n// Delivery range limit (e.g., 5km)\nconst MAX_DELIVERY_DISTANCE = maxDistance;\nconst withinRange = distance <= MAX_DELIVERY_DISTANCE;\n\nreturn [{\n  json: {\n    valid: true,\n    withinRange: withinRange,\n    formattedAddress: result.formatted_address,\n    distance: Math.round(distance * 10) / 10, // Round to 1 decimal\n    coordinates: {\n      lat: location.lat,\n      lng: location.lng\n    },\n    message: withinRange \n      ? `Address confirmed: ${result.formatted_address} (${Math.round(distance * 10) / 10}km away)`\n      : `Sorry, ${result.formatted_address} is ${Math.round(distance * 10) / 10}km away. We only deliver within ${MAX_DELIVERY_DISTANCE}km.`\n  }\n}];"
      },
      "typeVersion": 2
    },
    {
      "id": "e910c99d-fe9e-496c-8c9f-ec33fe06e1fc",
      "name": "Set Location and Area",
      "type": "n8n-nodes-base.set",
      "position": [
        1936,
        32
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "4c8601b1-4228-4f52-89b3-55781e492172",
              "name": "restaurantLat",
              "type": "number",
              "value": 50.4504
            },
            {
              "id": "2cd58ef0-b796-4e3c-a4b9-bf2389bafe2f",
              "name": "restaurantLng",
              "type": "number",
              "value": 30.5245
            },
            {
              "id": "7d2ea368-73c7-4320-8ad7-5cac381ce156",
              "name": "maxServingDistance",
              "type": "number",
              "value": 100
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "7a072a8c-f26c-4e76-900b-32665ab3329a",
      "name": "Message1",
      "type": "n8n-nodes-base.set",
      "position": [
        2352,
        32
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "07fb056d-c9d5-45e2-9028-20c2560dce36",
              "name": "Message",
              "type": "string",
              "value": "={{ $json.message }}"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "dcdcd1cd-7960-4024-8ebc-dd2ed9ff5556",
      "name": "Trigger Node7",
      "type": "n8n-nodes-base.set",
      "position": [
        1504,
        32
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "57d0ec72-f5c1-40cd-bc08-7b3f85ba68eb",
              "name": "address",
              "type": "array",
              "value": "string"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "46b1c608-ef56-445c-94db-08d79381b227",
      "name": "Create a Delivery Order",
      "type": "n8n-nodes-base.airtable",
      "position": [
        1104,
        1168
      ],
      "parameters": {
        "base": {
          "__rl": true,
          "mode": "list",
          "value": "appO25aREhJMGVavR",
          "cachedResultUrl": "https://airtable.com/appO25aREhJMGVavR",
          "cachedResultName": "Restaurant Booking"
        },
        "table": {
          "__rl": true,
          "mode": "list",
          "value": "tblcyTLCqeUGYeFY5",
          "cachedResultUrl": "https://airtable.com/appO25aREhJMGVavR/tblcyTLCqeUGYeFY5",
          "cachedResultName": "Orders"
        },
        "columns": {
          "value": {
            "Name": "={{ $json.name }}",
            "Items": "={{ JSON.stringify($json.items) }}",
            "Notes": "={{ $json.notes }}",
            "Phone": "={{ $json.phone }}",
            "Total": "={{ $json.priceTotal }}",
            "Status": "ðŸŸ¡ Confirming",
            "Order ID": "={{ $json.orderId }}",
            "Order Type": "Delivery",
            "Delivery Address": "={{ $json.deliveryAddress }}",
            "Pickup/Delivery Time": "={{ $json.deliveryTime }}"
          },
          "schema": [
            {
              "id": "Order ID",
              "type": "number",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "Order ID",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Name",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "Name",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Phone",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "Phone",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Order Type",
              "type": "options",
              "display": true,
              "options": [
                {
                  "name": "Takeaway",
                  "value": "Takeaway"
                },
                {
                  "name": "Delivery",
                  "value": "Delivery"
                }
              ],
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "Order Type",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Items",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "Items",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Total",
              "type": "number",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "Total",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Pickup/Delivery Time",
              "type": "dateTime",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "Pickup/Delivery Time",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Delivery Address",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "Delivery Address",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Status",
              "type": "options",
              "display": true,
              "options": [
                {
                  "name": "ðŸŸ¡ Confirming",
                  "value": "ðŸŸ¡ Confirming"
                },
                {
                  "name": "ðŸ”ƒCooking",
                  "value": "ðŸ”ƒCooking"
                },
                {
                  "name": "âœ… Ready",
                  "value": "âœ… Ready"
                },
                {
                  "name": "Handed Off",
                  "value": "Handed Off"
                }
              ],
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "Status",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Notes",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "Notes",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            }
          ],
          "mappingMode": "defineBelow",
          "matchingColumns": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {},
        "operation": "create"
      },
      "credentials": {
        "airtableTokenApi": {
          "id": "credential-id",
          "name": "airtableTokenApi Credential"
        }
      },
      "typeVersion": 2.1
    },
    {
      "id": "51ddd127-b052-4bbf-a21b-6defcc30a91b",
      "name": "Convert Time to UTC & Create Order ID1",
      "type": "n8n-nodes-base.code",
      "position": [
        880,
        1168
      ],
      "parameters": {
        "jsCode": "const req = $('When Executed by Another Workflow').first().json;\nconst timezoneInput = $input.first().json.timezone;\n\n// Determine current Kyiv UTC offset (handles DST automatically)\nconst testDate = new Date();\nconst NewTime = new Date(testDate.toLocaleString('en-US', { timeZone: timezoneInput }));\nconst utcTime = new Date(testDate.toLocaleString('en-US', { timeZone: 'UTC' }));\nconst offsetHours = (NewTime - utcTime) / (1000 * 60 * 60);\nconst offsetStr = `+${Math.abs(offsetHours).toString().padStart(2, '0')}:00`;\n\n// Convert pickup time from Kyiv to UTC\nconst deliveryTimeUTC = new Date(req.deliveryTime + offsetStr).toISOString();\n\n// Generate 8-digit order ID\nconst orderId = Math.floor(10000000 + Math.random() * 90000000);\n\nreturn [{\n  json: {\n    orderId: orderId,\n    name: req.name,\n    phone: req.phone,\n    items: req.items,\n    deliveryTime: deliveryTimeUTC,\n    deliveryAddress: req.deliveryAddress,\n    priceTotal: req.priceTotal,\n    notes: req.notes\n  }\n}];"
      },
      "typeVersion": 2
    },
    {
      "id": "cbeaafca-e441-4e93-9fac-81ed8c79892c",
      "name": "Replace with SMS node2",
      "type": "n8n-nodes-base.noOp",
      "position": [
        1328,
        1168
      ],
      "parameters": {},
      "typeVersion": 1
    },
    {
      "id": "d1d5d60a-3c30-4e07-a962-03599d7e1bd4",
      "name": "Set Timezone4",
      "type": "n8n-nodes-base.set",
      "position": [
        656,
        1168
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "edede7b3-cf44-4169-bb7c-81612f1cebfe",
              "name": "timezone",
              "type": "string",
              "value": "Europe/Kyiv"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "ab03dc22-33c4-4b12-8e31-dacb23be1180",
      "name": "Trigger Node8",
      "type": "n8n-nodes-base.set",
      "position": [
        416,
        1168
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "32a318db-0d22-46d2-8156-a98a62e4b8ce",
              "name": "name",
              "type": "string",
              "value": "string"
            },
            {
              "id": "d2236a00-a8c0-4915-8522-873c6e025fc1",
              "name": "phone",
              "type": "string",
              "value": "string"
            },
            {
              "id": "57d0ec72-f5c1-40cd-bc08-7b3f85ba68eb",
              "name": "items",
              "type": "array",
              "value": "string"
            },
            {
              "id": "f1bf4bbe-2469-426a-820f-c4f93e996a03",
              "name": "deliveryTime",
              "type": "string",
              "value": "string"
            },
            {
              "id": "c0ca7e39-40f4-48c5-952c-710d694fd64b",
              "name": "priceTotal",
              "type": "string",
              "value": "string"
            },
            {
              "id": "73103ffd-3717-45e9-b379-982bd00a1592",
              "name": "notes",
              "type": "string",
              "value": "string"
            },
            {
              "id": "fbf06ab4-1f47-43cf-be54-3cf3b912b399",
              "name": "deliveryAddress",
              "type": "string",
              "value": ""
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "72ad6c70-5c41-4f09-a9dc-fcaaae6f158c",
      "name": "Search Orders by Phone",
      "type": "n8n-nodes-base.airtable",
      "position": [
        640,
        -16
      ],
      "parameters": {
        "base": {
          "__rl": true,
          "mode": "list",
          "value": "appO25aREhJMGVavR",
          "cachedResultUrl": "https://airtable.com/appO25aREhJMGVavR",
          "cachedResultName": "Restaurant Booking"
        },
        "table": {
          "__rl": true,
          "mode": "list",
          "value": "tblcyTLCqeUGYeFY5",
          "cachedResultUrl": "https://airtable.com/appO25aREhJMGVavR/tblcyTLCqeUGYeFY5",
          "cachedResultName": "Orders"
        },
        "options": {},
        "operation": "search",
        "filterByFormula": "={Phone} = \"{{ $json.phone }}\""
      },
      "credentials": {
        "airtableTokenApi": {
          "id": "credential-id",
          "name": "airtableTokenApi Credential"
        }
      },
      "typeVersion": 2.1
    },
    {
      "id": "1f584e92-b52d-4ca0-ae14-4588c3dd4683",
      "name": "Trigger Node9",
      "type": "n8n-nodes-base.set",
      "position": [
        432,
        -16
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "57d0ec72-f5c1-40cd-bc08-7b3f85ba68eb",
              "name": "phone",
              "type": "array",
              "value": "string"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "05fe4d6a-e6d3-4804-b211-2fea78293153",
      "name": "Call 'Cancel Order'",
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "position": [
        416,
        256
      ],
      "parameters": {
        "workflowId": {
          "__rl": true,
          "mode": "list",
          "value": "o6ZboK8in1RlxgQ7",
          "cachedResultUrl": "/workflow/o6ZboK8in1RlxgQ7",
          "cachedResultName": "Cancel Order"
        },
        "description": "Call this tool to cancel an existing order.",
        "workflowInputs": {
          "value": {
            "orderID": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('orderID', ``, 'string') }}"
          },
          "schema": [
            {
              "id": "orderID",
              "type": "string",
              "display": true,
              "removed": false,
              "required": false,
              "displayName": "orderID",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            }
          ],
          "mappingMode": "defineBelow",
          "matchingColumns": [
            "orderID"
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "af23fe8b-e29e-4c50-a8b9-0f4b4f688300",
      "name": "Delete Order",
      "type": "n8n-nodes-base.airtable",
      "position": [
        624,
        384
      ],
      "parameters": {
        "id": "={{ $json.orderID }}",
        "base": {
          "__rl": true,
          "mode": "list",
          "value": "appO25aREhJMGVavR",
          "cachedResultUrl": "https://airtable.com/appO25aREhJMGVavR",
          "cachedResultName": "Restaurant Booking"
        },
        "table": {
          "__rl": true,
          "mode": "list",
          "value": "tblcyTLCqeUGYeFY5",
          "cachedResultUrl": "https://airtable.com/appO25aREhJMGVavR/tblcyTLCqeUGYeFY5",
          "cachedResultName": "Orders"
        },
        "operation": "deleteRecord"
      },
      "credentials": {
        "airtableTokenApi": {
          "id": "credential-id",
          "name": "airtableTokenApi Credential"
        }
      },
      "typeVersion": 2.1
    },
    {
      "id": "5ab81488-0c93-49cd-b67e-262cda992737",
      "name": "Replace with SMS node3",
      "type": "n8n-nodes-base.noOp",
      "position": [
        832,
        384
      ],
      "parameters": {},
      "typeVersion": 1
    },
    {
      "id": "85f683c4-ac02-4a4d-95ea-01da73e3fd1b",
      "name": "Trigger Node10",
      "type": "n8n-nodes-base.set",
      "position": [
        432,
        384
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "57d0ec72-f5c1-40cd-bc08-7b3f85ba68eb",
              "name": "orderID",
              "type": "array",
              "value": "string"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "99c0a27e-aca5-4d27-bfca-eff986023830",
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2464,
        -1344
      ],
      "parameters": {
        "color": 7,
        "width": 592,
        "height": 336,
        "content": "# Telegram Booking Bot\n## About\nThis is a restaurant booking bot. It can book tables, capture delivery orders, manage existing bookings. You can use voice or text to communicate with this bot.\n\n## How to use\nCreate a bot in telegram\nGet an access key\nCreate a new connection here\nUpdate connection in 3 nodes"
      },
      "typeVersion": 1
    },
    {
      "id": "d940c1d2-dd98-4b2f-9e18-8978434e9b5e",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -960,
        -736
      ],
      "parameters": {
        "color": 7,
        "width": 480,
        "height": 288,
        "content": "# MCP Server\nGives access to all tools"
      },
      "typeVersion": 1
    },
    {
      "id": "c1d1f650-b21c-43dd-b578-0301b0eda2b8",
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1680,
        816
      ],
      "parameters": {
        "color": 7,
        "width": 384,
        "height": 288,
        "content": "### Create a Booking & Send SMS\nBooking is created in the Airtable table. Replace the \"Do Nothing\" node with SMS node to send notification to the caller."
      },
      "typeVersion": 1
    },
    {
      "id": "6e100746-ef41-4fc6-9ff6-f2b41d73e81c",
      "name": "Sticky Note7",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2128,
        816
      ],
      "parameters": {
        "color": 7,
        "width": 384,
        "height": 288,
        "content": "### Set Timezone & Calculate UTC\nSet your timezone in IANA format & see UTC calculate automatically."
      },
      "typeVersion": 1
    },
    {
      "id": "b5d1e9e9-b6a3-465b-8dde-f6068f856f27",
      "name": "Sticky Note8",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2784,
        768
      ],
      "parameters": {
        "color": 7,
        "width": 592,
        "height": 336,
        "content": "## Book Table Tool\n\n### About\nThis tool is called to book the caller."
      },
      "typeVersion": 1
    },
    {
      "id": "97e4ce54-4f0d-46f8-bd20-1a784acfd065",
      "name": "Set Timezone1",
      "type": "n8n-nodes-base.set",
      "position": [
        -2096,
        928
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "edede7b3-cf44-4169-bb7c-81612f1cebfe",
              "name": "timezone",
              "type": "string",
              "value": "Europe/Kyiv"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "7a1410e1-d62d-47fc-bceb-5fe26c96965e",
      "name": "Sticky Note9",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -3488,
        816
      ],
      "parameters": {
        "color": 7,
        "width": 464,
        "height": 384,
        "content": "### Branching\nIf booking is found, we return the information. otherwise, message \"No bookings found\" is sent."
      },
      "typeVersion": 1
    },
    {
      "id": "1342aa0f-02e1-45fa-a017-1b1520f311c5",
      "name": "Sticky Note11",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -4352,
        768
      ],
      "parameters": {
        "color": 7,
        "width": 592,
        "height": 336,
        "content": "## Get a Booking Tool\n\n### About\nWhen caller wants to cancel/update his booking, \nthis tool is called to find this caller's bookings\nin the system."
      },
      "typeVersion": 1
    },
    {
      "id": "9cf5464a-daa3-4376-ad77-2a7bd984a803",
      "name": "Sticky Note12",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -3744,
        816
      ],
      "parameters": {
        "color": 7,
        "width": 224,
        "height": 288,
        "content": "### Find the Booking\nAirtable node searches for bookings using the provided phone number."
      },
      "typeVersion": 1
    },
    {
      "id": "7de89f5c-7bf4-4184-9c48-5b9887c61afe",
      "name": "Sticky Note13",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -4352,
        288
      ],
      "parameters": {
        "color": 7,
        "width": 592,
        "height": 336,
        "content": "## Cancel Booking Tool\n\n### About\nWhen caller wants to cancel his appointment, this tool is called."
      },
      "typeVersion": 1
    },
    {
      "id": "78cc6954-90e0-4f63-a089-85e3dc796258",
      "name": "Sticky Note14",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -3744,
        336
      ],
      "parameters": {
        "color": 7,
        "width": 224,
        "height": 288,
        "content": "### Cancel the Booking\nAirtable node cancels booking using the booking ID."
      },
      "typeVersion": 1
    },
    {
      "id": "c0f7858a-2746-447c-9e5e-13e5052a7822",
      "name": "Sticky Note10",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2000,
        336
      ],
      "parameters": {
        "color": 7,
        "width": 384,
        "height": 288,
        "content": "### Update a Booking & Send SMS\nBooking is updated in the Airtable table. Replace the \"Do Nothing\" node with SMS node to send notification to the caller."
      },
      "typeVersion": 1
    },
    {
      "id": "e8f4049c-fd61-460d-886b-abc43137b426",
      "name": "Sticky Note15",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2416,
        336
      ],
      "parameters": {
        "color": 7,
        "width": 384,
        "height": 288,
        "content": "### Set Timezone & Calculate UTC\nSet your timezone in IANA format & see UTC calculate automatically."
      },
      "typeVersion": 1
    },
    {
      "id": "7ed635fc-0a44-4522-8d80-c5b1ed2b079d",
      "name": "Sticky Note16",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -3040,
        288
      ],
      "parameters": {
        "color": 7,
        "width": 592,
        "height": 336,
        "content": "## Update Booking Tool \n\n### About\nWhen caller wants to update his booking,\nthis tool is called."
      },
      "typeVersion": 1
    },
    {
      "id": "e8808184-c5d5-44ed-8139-fce2fe2f8b7e",
      "name": "Sticky Note17",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -3264,
        -240
      ],
      "parameters": {
        "color": 7,
        "width": 384,
        "height": 288,
        "content": "### Get All Tables & Check Capacity\nWe get all tables in the restaurant and check if we can handle party size."
      },
      "typeVersion": 1
    },
    {
      "id": "0b56cdb1-6190-48a0-a6b9-c6c46b8ffedf",
      "name": "Sticky Note18",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -3712,
        -240
      ],
      "parameters": {
        "color": 7,
        "width": 384,
        "height": 288,
        "content": "### Set Timezone & Calculate UTC\nSet your timezone in IANA format & see UTC calculate automatically."
      },
      "typeVersion": 1
    },
    {
      "id": "90a30fa7-6135-4584-9498-948c7bca0429",
      "name": "Sticky Note19",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -4352,
        -288
      ],
      "parameters": {
        "color": 7,
        "width": 592,
        "height": 336,
        "content": "## Check Availabilty Tool\n\n### About\nWhen caller wants to book an appointment,\nthis tool is called to check availability.\nAI agent sends captured time window and gets back\neither available tables or \"Not Available\" message."
      },
      "typeVersion": 1
    },
    {
      "id": "52c4d3ba-d1e2-46b7-8277-37e68dbe2a8d",
      "name": "Sticky Note20",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2800,
        -240
      ],
      "parameters": {
        "color": 7,
        "width": 384,
        "height": 288,
        "content": "### Branching\nIf we can't fit the party, send the appropriate message. Otherwise, continue."
      },
      "typeVersion": 1
    },
    {
      "id": "0394b17f-1e8b-4eb8-ada7-65db69fe1caa",
      "name": "Sticky Note21",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2352,
        -320
      ],
      "parameters": {
        "color": 7,
        "width": 384,
        "height": 288,
        "content": "### Get Availability & Sort\nWe get bookings that overlap with requested time window. Then we look for tables that are available and can fit the party size."
      },
      "typeVersion": 1
    },
    {
      "id": "df9ff0f7-d3a4-4b24-bb25-100fe227aec3",
      "name": "Sticky Note22",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1920,
        -400
      ],
      "parameters": {
        "color": 7,
        "width": 464,
        "height": 448,
        "content": "### Branching\nIf no tables available, we send appropriate message. Otherwise, return list of available tables."
      },
      "typeVersion": 1
    },
    {
      "id": "fb65a543-390a-45b9-ad7d-6b368f5f2d87",
      "name": "Sticky Note23",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1648,
        304
      ],
      "parameters": {
        "color": 7,
        "width": 592,
        "height": 336,
        "content": "## Get a Menu Tool\n\n### About\nThis tool gets a current menu from Airtable database.\n"
      },
      "typeVersion": 1
    },
    {
      "id": "4ae0ad1f-9110-460d-ae31-55049ef9b76c",
      "name": "Sticky Note24",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2256,
        352
      ],
      "parameters": {
        "color": 7,
        "width": 224,
        "height": 288,
        "content": "### Get Menu\nAirtable node sends a full menu to the bot."
      },
      "typeVersion": 1
    },
    {
      "id": "9a32514e-4b4a-41af-aa3c-3b0f6749e057",
      "name": "Sticky Note25",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2096,
        -96
      ],
      "parameters": {
        "color": 7,
        "width": 384,
        "height": 288,
        "content": "### Check Eligibility\nChecks whether we can or can not deliver the order to the caller."
      },
      "typeVersion": 1
    },
    {
      "id": "3267681b-a117-47a9-9505-adaef89b493e",
      "name": "Sticky Note26",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1680,
        -96
      ],
      "parameters": {
        "color": 7,
        "width": 192,
        "height": 288,
        "content": "### Geocode Address\nThis node uses GMaps API to geocode a given address."
      },
      "typeVersion": 1
    },
    {
      "id": "b2fb971f-8150-47ac-9dbe-964bd67a1cbd",
      "name": "Sticky Note27",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1040,
        -144
      ],
      "parameters": {
        "color": 7,
        "width": 592,
        "height": 336,
        "content": "## Validate Address Tool \n\n### About\nThis tool validates a given delivery address and checks\nwhether you cover that area or not."
      },
      "typeVersion": 1
    },
    {
      "id": "f84dc393-b7a5-47b3-b88f-45b65a2200c8",
      "name": "Sticky Note28",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1888,
        -96
      ],
      "parameters": {
        "color": 7,
        "width": 192,
        "height": 288,
        "content": "### Set Data\nSet your restaurant coordinates & coverage radius."
      },
      "typeVersion": 1
    },
    {
      "id": "158765ee-7585-4359-bae8-b84fc9ce44a7",
      "name": "Sticky Note29",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1056,
        1040
      ],
      "parameters": {
        "color": 7,
        "width": 464,
        "height": 288,
        "content": "### Create an Order & Send SMS\nOrder is created in the Airtable table. Replace the \"Do Nothing\" node with SMS node to send notification to the caller."
      },
      "typeVersion": 1
    },
    {
      "id": "04166b13-5050-4ac3-ad9b-63049fedeeda",
      "name": "Sticky Note30",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        608,
        1040
      ],
      "parameters": {
        "color": 7,
        "width": 416,
        "height": 288,
        "content": "### Set Timezone & Calculate UTC\nSet your timezone in IANA format & see UTC calculate automatically."
      },
      "typeVersion": 1
    },
    {
      "id": "ac735f81-34c2-4231-ade0-eabac0672e99",
      "name": "Sticky Note31",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -32,
        992
      ],
      "parameters": {
        "color": 7,
        "width": 608,
        "height": 336,
        "content": "## Create a Delivery Order\n\n### About\nWhen caller made a delivery order, this tool is called\nto add order to the system"
      },
      "typeVersion": 1
    },
    {
      "id": "ccf78f36-1ed9-4fb8-8fbc-a2dd3fb41618",
      "name": "Sticky Note32",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -32,
        224
      ],
      "parameters": {
        "color": 7,
        "width": 592,
        "height": 336,
        "content": "## Cancel Order Tool\n\n### About\nThis tool cancels an existing order using order ID."
      },
      "typeVersion": 1
    },
    {
      "id": "015021c1-b355-4eaa-b01f-72649878b0ca",
      "name": "Sticky Note33",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        576,
        272
      ],
      "parameters": {
        "color": 7,
        "width": 448,
        "height": 288,
        "content": "### Cancel the Order\nAirtable node cancels order using the order ID."
      },
      "typeVersion": 1
    },
    {
      "id": "622c166b-13ff-4049-a311-6fa2dc59c7e0",
      "name": "Sticky Note34",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -32,
        -176
      ],
      "parameters": {
        "color": 7,
        "width": 592,
        "height": 336,
        "content": "## Get an Order Tool\n\n### About\nThis tool is used when caller wants to get info\nabout their order (eg he wants to cancel)"
      },
      "typeVersion": 1
    },
    {
      "id": "4b81c17a-243e-4842-81ac-2e2986b9b64f",
      "name": "Sticky Note35",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        576,
        -128
      ],
      "parameters": {
        "color": 7,
        "width": 224,
        "height": 288,
        "content": "### Get Orders\nAirtable node searches for orders using the caller's phone number"
      },
      "typeVersion": 1
    },
    {
      "id": "df87e207-52a5-46c8-bc09-a6ef982e0a5b",
      "name": "Sticky Note36",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2016,
        -464
      ],
      "parameters": {
        "color": 7,
        "width": 464,
        "height": 288,
        "content": "### Branching\nIf some items on the list are not found, return a message. Otherwise, return order price."
      },
      "typeVersion": 1
    },
    {
      "id": "4387f32e-0a75-44a3-a1b2-d73c541468f9",
      "name": "Sticky Note37",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1568,
        -464
      ],
      "parameters": {
        "color": 7,
        "width": 416,
        "height": 288,
        "content": "### Get the Menu & Calculate the Price\nFetch the menu from Airtable and calculate the price. "
      },
      "typeVersion": 1
    },
    {
      "id": "1fe2e3b4-11ed-4732-9ddd-3112a468c6e1",
      "name": "Sticky Note38",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        928,
        -512
      ],
      "parameters": {
        "color": 7,
        "width": 608,
        "height": 336,
        "content": "## Calculate the Price Tool\n\n### About\nThis tool receives a list of items the caller wants to order\nand calculates the price of the order."
      },
      "typeVersion": 1
    },
    {
      "id": "2df3a8cc-bf41-4385-92a5-ebdabe43bc0f",
      "name": "Sticky Note39",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1056,
        656
      ],
      "parameters": {
        "color": 7,
        "width": 464,
        "height": 288,
        "content": "### Create an Order & Send SMS\nOrder is created in the Airtable table. Replace the \"Do Nothing\" node with SMS node to send notification to the caller."
      },
      "typeVersion": 1
    },
    {
      "id": "94746040-412b-426a-b1fb-36882776b0df",
      "name": "Sticky Note40",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        608,
        656
      ],
      "parameters": {
        "color": 7,
        "width": 416,
        "height": 288,
        "content": "### Set Timezone & Calculate UTC\nSet your timezone in IANA format & see UTC calculate automatically."
      },
      "typeVersion": 1
    },
    {
      "id": "cd37d397-0043-4751-ba67-1faec99ed194",
      "name": "Sticky Note41",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -32,
        608
      ],
      "parameters": {
        "color": 7,
        "width": 608,
        "height": 336,
        "content": "## Create a Takeaway Order\n\n### About\nWhen caller made a takeaway order, this tool is called\nto add order to the system"
      },
      "typeVersion": 1
    },
    {
      "id": "ebb043ae-5c10-4d18-9763-9008b8660e95",
      "name": "Wait for New Message",
      "type": "n8n-nodes-base.telegramTrigger",
      "position": [
        -2000,
        -1184
      ],
      "webhookId": "c3b2f0a1-8f7a-47d1-b7cc-1fa5971763f5",
      "parameters": {
        "updates": [
          "message"
        ],
        "additionalFields": {}
      },
      "credentials": {
        "telegramApi": {
          "id": "credential-id",
          "name": "telegramApi Credential"
        }
      },
      "typeVersion": 1.2
    },
    {
      "id": "6bca86fd-2240-4916-9073-f4ca4843f0b9",
      "name": "Sticky Note42",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1856,
        -1296
      ],
      "parameters": {
        "color": 7,
        "width": 192,
        "height": 288,
        "content": "### Check \nCheck the message type."
      },
      "typeVersion": 1
    },
    {
      "id": "cbd718ed-1b4f-45a4-bbd9-967f84aa4cc0",
      "name": "Sticky Note43",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1632,
        -1248
      ],
      "parameters": {
        "color": 7,
        "width": 848,
        "height": 320,
        "content": "### Transcribe\nIf message is voice, it's sent to OpenAI for transcribing. Otherwise, it's sent to the agent directly."
      },
      "typeVersion": 1
    },
    {
      "id": "cbd46942-c789-49ad-b2fb-e23b29190c70",
      "name": "Sticky Note44",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -752,
        -1280
      ],
      "parameters": {
        "color": 7,
        "width": 464,
        "height": 448,
        "content": "### AI Agent\nBrain of the system. It has a defined communication flow, knows how to handle bookings and delivery orders. "
      },
      "typeVersion": 1
    },
    {
      "id": "8d1235cc-9b39-473c-a253-b83aa424698b",
      "name": "Sticky Note45",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -272,
        -1280
      ],
      "parameters": {
        "color": 7,
        "height": 288,
        "content": "### Reply\nThis node sends agent's response to the user."
      },
      "typeVersion": 1
    },
    {
      "id": "1237884c-8f84-4d24-998b-6ceb13e43f94",
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -3824,
        -1840
      ],
      "parameters": {
        "width": 500,
        "height": 1038,
        "content": "## Restaurant AI Receptionist (Telegram)\n\n### About\nThis system can handle table bookings and delivery/takeaway orders.\nIt uses Airtable as a database.\n\nYou can use VAPI for voice agent setup and Telegram bot for chatbot setup.\nFor voice agents, navigate to the AI agent in the Telegram flow, copy AI agent's prompt and paste it into VAPI.\nAlso make sure to add MCP tool in the tools tab. \n\n### How it works\n1. A customer can engage with the system  via Telegram bot or Vapi agent. In Telegram customer sends a text or voice message to the Telegram bot; voice is transcribed to text.\n2. The AI agent interprets intent (booking, order, update, cancel) and calls backend tools to fetch menu, check availability, validate addresses, or calculate price.\n3. For bookings the workflow converts times to Kyiv/UTC, checks table capacity and overlapping bookings in Airtable, then selects a table or suggests alternative times.\n4. For orders the workflow validates items against the live menu, computes the total, checks delivery eligibility via geocoding and distance, then creates a takeaway or delivery order and generates an order ID.\n5. The agent sends a concise confirmation back to the customer via Telegram and can trigger SMS/notification nodes for external confirmations.\n\n### Setup\n- [ ] Download JSON files from [here](https://www.dropbox.com/scl/fo/r6edgytt26f51vmibntqt/AM49duT1dDbdD2deCu2-J5c?rlkey=l495lzd5926yb5mbxxuj73a39&st=wgjc60dp&dl=0)\n- [ ] Copy Airtable base from [here](https://airtable.com/appO25aREhJMGVavR/shreEtStEqOedoYTT)\n- [ ] Connect Telegram bot credentials\n- [ ] Add OpenAI API key to the Chat Model\n- [ ] Connect your Airtable base and API token\n- [ ] Add Google Maps API key for address geocoding\n- [ ] Configure the MCP server/tool and link the sub-workflows\n- [ ] Set restaurant coordinates and delivery radius\n- [ ] Replace placeholder \"Do Nothing\" nodes with your SMS/notification integration\n- [ ] Set the workflow timezone (e.g., Europe/Kyiv)\n"
      },
      "typeVersion": 1
    }
  ],
  "pinData": {
    "When Executed by Another Workflow": [
      {
        "endDate": "2025-12-19T23:00:00",
        "startDate": "2025-12-19T16:00:00",
        "partyCount": 5
      }
    ]
  },
  "connections": {
    "If": {
      "main": [
        [
          {
            "node": "Normalize Output",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Table is not available",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If1": {
      "main": [
        [
          {
            "node": "Get Availability",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Can't Handle Party",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If2": {
      "main": [
        [],
        [
          {
            "node": "Message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If3": {
      "main": [
        [
          {
            "node": "Total Price",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Reply",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Voice": {
      "main": [
        [
          {
            "node": "Transcribe The Voice",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch Menu": {
      "main": [
        [
          {
            "node": "Order Validation",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create Order": {
      "main": [
        [
          {
            "node": "Replace with SMS node1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Delete Order": {
      "main": [
        [
          {
            "node": "Replace with SMS node3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Timezone": {
      "main": [
        [
          {
            "node": "Convert Time to UTC",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Trigger Node": {
      "main": [
        [
          {
            "node": "Set Timezone1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check if Text": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get Voice",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Timezone1": {
      "main": [
        [
          {
            "node": "Calculate Timezone",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Timezone2": {
      "main": [
        [
          {
            "node": "Convert Time to UTC1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Timezone3": {
      "main": [
        [
          {
            "node": "Convert Time to UTC & Create Order ID",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Timezone4": {
      "main": [
        [
          {
            "node": "Convert Time to UTC & Create Order ID1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Trigger Node1": {
      "main": [
        [
          {
            "node": "Find a Booking",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Trigger Node2": {
      "main": [
        [
          {
            "node": "Set Timezone2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Trigger Node3": {
      "main": [
        [
          {
            "node": "Delete Booking",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Trigger Node4": {
      "main": [
        [
          {
            "node": "Get Menu",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Trigger Node5": {
      "main": [
        [
          {
            "node": "Set Timezone3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Trigger Node6": {
      "main": [
        [
          {
            "node": "Fetch Menu",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Trigger Node7": {
      "main": [
        [
          {
            "node": "Geocode Address",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Trigger Node8": {
      "main": [
        [
          {
            "node": "Set Timezone4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Trigger Node9": {
      "main": [
        [
          {
            "node": "Search Orders by Phone",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Find a Booking": {
      "main": [
        [
          {
            "node": "If2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get All Tables": {
      "main": [
        [
          {
            "node": "Check Max Capacity",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Trigger Node10": {
      "main": [
        [
          {
            "node": "Delete Order",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update Booking": {
      "main": [
        [
          {
            "node": "Replace with SMS Node",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Call 'Get Menu'": {
      "ai_tool": [
        [
          {
            "node": "MCP Server Trigger",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Geocode Address": {
      "main": [
        [
          {
            "node": "Set Location and Area",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Restaurant Tool": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Create a Booking": {
      "main": [
        [
          {
            "node": "Replace with SMS node",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Availability": {
      "main": [
        [
          {
            "node": "Table-Availability Selector",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Order Validation": {
      "main": [
        [
          {
            "node": "If3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Call \"Book Table\"": {
      "ai_tool": [
        [
          {
            "node": "MCP Server Trigger",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Check Eligibility": {
      "main": [
        [
          {
            "node": "Message1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Calculate Timezone": {
      "main": [
        [
          {
            "node": "Create a Booking",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check Max Capacity": {
      "main": [
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Call 'Cancel Order'": {
      "ai_tool": [
        [
          {
            "node": "MCP Server Trigger",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Call 'Get an Order'": {
      "ai_tool": [
        [
          {
            "node": "MCP Server Trigger",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Convert Time to UTC": {
      "main": [
        [
          {
            "node": "Get All Tables",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Call \"Get a Booking\"": {
      "ai_tool": [
        [
          {
            "node": "MCP Server Trigger",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Convert Time to UTC1": {
      "main": [
        [
          {
            "node": "Update Booking",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Transcribe The Voice": {
      "main": [
        [
          {
            "node": "Send Transcribe Context To AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait for New Message": {
      "main": [
        [
          {
            "node": "Check if Text",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Location and Area": {
      "main": [
        [
          {
            "node": "Check Eligibility",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create a Delivery Order": {
      "main": [
        [
          {
            "node": "Replace with SMS node2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Call \"Check Availability\"": {
      "ai_tool": [
        [
          {
            "node": "MCP Server Trigger",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Call \"Delete Appointment\"": {
      "ai_tool": [
        [
          {
            "node": "MCP Server Trigger",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Call \"Update appointment\"": {
      "ai_tool": [
        [
          {
            "node": "MCP Server Trigger",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Call 'Calculate the Price'": {
      "ai_tool": [
        [
          {
            "node": "MCP Server Trigger",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Call 'Validate the Address'": {
      "ai_tool": [
        [
          {
            "node": "MCP Server Trigger",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Table-Availability Selector": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Call 'Create a Delivery Order'": {
      "ai_tool": [
        [
          {
            "node": "MCP Server Trigger",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Call 'Create a Takeaway Order'": {
      "ai_tool": [
        [
          {
            "node": "MCP Server Trigger",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "When Executed by Another Workflow": {
      "main": [
        [
          {
            "node": "Set Timezone",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send Transcribe Context To AI Agent": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Convert Time to UTC & Create Order ID": {
      "main": [
        [
          {
            "node": "Create Order",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert Time to UTC & Create Order ID1": {
      "main": [
        [
          {
            "node": "Create a Delivery Order",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}