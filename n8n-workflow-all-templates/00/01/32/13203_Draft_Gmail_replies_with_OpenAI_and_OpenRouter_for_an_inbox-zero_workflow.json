{
  "id": "Q2ArTrxz73AJ2c0z",
  "meta": {
    "site": "https://github.com/zengfr/n8n-workflow-all-templates",
    "name": "Draft Gmail replies with OpenAI and OpenRouter for an inbox-zero workflow",
    "wechat": "youandme10086",
    "id": 13203,
    "update_time": "2026-02-13"
  },
  "name": "Auto-draft email replies with AI using Gmail and OpenAI",
  "tags": [],
  "nodes": [
    {
      "id": "9fb5f101-ad37-4304-b592-f96dee6396fc",
      "name": "Gmail Trigger",
      "type": "n8n-nodes-base.gmailTrigger",
      "position": [
        -1376,
        272
      ],
      "parameters": {
        "simple": false,
        "filters": {},
        "options": {},
        "pollTimes": {
          "item": [
            {
              "mode": "everyHour"
            }
          ]
        }
      },
      "credentials": {
        "gmailOAuth2": {
          "id": "NcFL2qrk70c1a3nM",
          "name": "Gmail Account"
        }
      },
      "typeVersion": 1.2
    },
    {
      "id": "1abc984c-fa4b-41f8-9a1c-a794192462a6",
      "name": "Set Content",
      "type": "n8n-nodes-base.set",
      "position": [
        -1216,
        272
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "48bb2e0c-15a8-4f10-bca7-4d1d67ac7296",
              "name": "emailBody",
              "type": "string",
              "value": "={{ $json.text }}"
            },
            {
              "id": "06a6a58d-58f8-42c7-a4d8-988d52565ec2",
              "name": "threadID",
              "type": "string",
              "value": "={{ $json.threadId }}"
            },
            {
              "id": "e9624de8-55ce-4ceb-a47b-26ce1028f57b",
              "name": "from",
              "type": "string",
              "value": "={{ $json.headers.from }}"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "466274b3-b067-44f6-a083-fcafb4e0816f",
      "name": "OpenAI Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "position": [
        -144,
        256
      ],
      "parameters": {
        "options": {}
      },
      "credentials": {
        "openAiApi": {
          "id": "01Anc0NXpEP1QYtk",
          "name": "OpenAI API"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "635200c9-c30d-4ccc-8a17-a8799a962580",
      "name": "Vector Store Tool",
      "type": "@n8n/n8n-nodes-langchain.toolVectorStore",
      "position": [
        256,
        592
      ],
      "parameters": {
        "name": "documents",
        "description": "Retrieves information about our client support policies and FAQs"
      },
      "typeVersion": 1
    },
    {
      "id": "8f60ce91-bf19-457a-a928-d88881235845",
      "name": "OpenAI Chat Model1",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "position": [
        400,
        864
      ],
      "parameters": {
        "options": {}
      },
      "credentials": {
        "openAiApi": {
          "id": "01Anc0NXpEP1QYtk",
          "name": "OpenAI API"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "936c762e-5693-4d38-9937-0e2f5586bafa",
      "name": "Embeddings OpenAI",
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "position": [
        128,
        896
      ],
      "parameters": {
        "options": {}
      },
      "credentials": {
        "openAiApi": {
          "id": "01Anc0NXpEP1QYtk",
          "name": "OpenAI API"
        }
      },
      "typeVersion": 1.1
    },
    {
      "id": "269101c3-a5aa-4189-b3d4-eaea80396d76",
      "name": "createDraft",
      "type": "n8n-nodes-base.gmailTool",
      "position": [
        240,
        192
      ],
      "webhookId": "aa94fec5-4706-4d8d-89e0-ba0ebe17452e",
      "parameters": {
        "message": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Message', ``, 'string') }}",
        "options": {
          "sendTo": "={{ $('Set Content').item.json.from === 'your-email@example.com' ? $('Set Content').item.json.to : $('Set Content').item.json.from }}",
          "threadId": "={{ $('Set Content').item.json.threadID }}"
        },
        "subject": "={{ $('Gmail Trigger').item.json.headers.subject }}",
        "resource": "draft"
      },
      "credentials": {
        "gmailOAuth2": {
          "id": "NcFL2qrk70c1a3nM",
          "name": "Gmail Account"
        }
      },
      "typeVersion": 2.1
    },
    {
      "id": "0c00511d-761c-4b8f-8946-a4f28887e485",
      "name": "Response",
      "type": "n8n-nodes-base.telegram",
      "position": [
        496,
        0
      ],
      "webhookId": "2ad21cb7-170f-48d3-8f9d-76f384accdfc",
      "parameters": {
        "text": "={{ $json.output }}",
        "chatId": "=YOUR_CHAT_ID",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "credentials": {
        "telegramApi": {
          "id": "hPJ6kkZmtnErV9KN",
          "name": "Telegram Bot"
        }
      },
      "typeVersion": 1.2
    },
    {
      "id": "df232786-7bfd-43fe-9160-6088e75ccdc2",
      "name": "Response Not Customer Support",
      "type": "n8n-nodes-base.telegram",
      "position": [
        -384,
        512
      ],
      "webhookId": "76ad8b08-dfed-4f3a-b220-d4434410d18e",
      "parameters": {
        "text": "=You received an email at {{ $now.format('hh:mm') }} saying:\n\n{{ $('Set Content').item.json.emailBody }}",
        "chatId": "=YOUR_CHAT_ID",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "credentials": {
        "telegramApi": {
          "id": "hPJ6kkZmtnErV9KN",
          "name": "Telegram Bot"
        }
      },
      "typeVersion": 1.2
    },
    {
      "id": "a0ee0467-d10f-429d-98c7-14875de0a7ce",
      "name": "Customer Support?",
      "type": "n8n-nodes-base.switch",
      "position": [
        -560,
        272
      ],
      "parameters": {
        "rules": {
          "values": [
            {
              "outputKey": "Customer Support",
              "conditions": {
                "options": {
                  "version": 2,
                  "leftValue": "",
                  "caseSensitive": true,
                  "typeValidation": "strict"
                },
                "combinator": "and",
                "conditions": [
                  {
                    "id": "ddd5ba35-bc7c-4025-9129-870cf549626d",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "leftValue": "={{ $json.output.customerSupport }}",
                    "rightValue": "true"
                  }
                ]
              },
              "renameOutput": true
            },
            {
              "outputKey": "Not Customer Support",
              "conditions": {
                "options": {
                  "version": 2,
                  "leftValue": "",
                  "caseSensitive": true,
                  "typeValidation": "strict"
                },
                "combinator": "and",
                "conditions": [
                  {
                    "id": "3461ccc2-8323-4c31-b964-618240c03795",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "leftValue": "={{ $json.output.customerSupport }}",
                    "rightValue": "false"
                  }
                ]
              },
              "renameOutput": true
            }
          ]
        },
        "options": {}
      },
      "typeVersion": 3.2,
      "alwaysOutputData": true
    },
    {
      "id": "35c02e5c-68a1-448e-9980-31eabfbbf1c4",
      "name": "OpenRouter Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "position": [
        -1008,
        432
      ],
      "parameters": {
        "options": {}
      },
      "credentials": {
        "openRouterApi": {
          "id": "7hgQRlRMqe6wbGZO",
          "name": "OpenRouter API"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "e8b21459-dbf6-41da-aad3-1fd4f544c660",
      "name": "Structured Output Parser",
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "position": [
        -864,
        432
      ],
      "parameters": {
        "jsonSchemaExample": "{\n\t\"customerSupport\": \"True\"\n}"
      },
      "typeVersion": 1.2
    },
    {
      "id": "c2e12c1b-751d-4f46-b2d1-e93eed52d601",
      "name": "Client/Prospect Related?",
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "position": [
        -1008,
        272
      ],
      "parameters": {
        "text": "=You are analysing an email to determine if it requires a human response.\n\nRETURN customerSupport: TRUE if:\n- Written by a human (not a system/bot)\n- Asking questions about services, proposals, or pricing\n- Requesting help with products, services, or technical issues\n- Reporting bugs or errors\n- Asking about service changes, billing issues, or upgrades\n- Introduction or referral connecting you with a prospect\n- Follow-up on a proposal or discovery call\n- Discussing project scope, timelines, or deliverables\n\nRETURN customerSupport: FALSE if:\n- Automated system notifications (workflow errors, payment receipts, account top-ups)\n- Marketing emails, newsletters, or promotional content\n- Survey requests, feedback forms, or NPS scores\n- Auto-closed ticket notifications from support platforms\n- Subscription/renewal confirmations or receipts\n- LinkedIn connection requests or automated InMails\n- Webinar invitations or event registrations\n- Out-of-office auto-replies\n\nCONTEXT CLUES FOR FALSE:\n- Contains phrases like \"This is an automated message\" or \"Do not reply\"\n- Formatted like a receipt or system notification\n- From noreply@, no-reply@, or automated@ email addresses\n- Contains unsubscribe links or legal disclaimers at the bottom\n\nEmail to analyse:\n{{ $json.emailBody }}\n\nReturn ONLY valid JSON: {\"customerSupport\": true} or {\"customerSupport\": false}",
        "batching": {},
        "messages": {
          "messageValues": [
            {
              "message": "You are an email AI agent"
            },
            {
              "type": "HumanMessagePromptTemplate",
              "message": "=Prompt: Analyse the content of the following email and determine whether it is related to client support or not. If the email appears to be auto-generated or system-generated, such as automated payment notifications, subscription renewals, auto-tops, or transactional confirmations, mark customerSupport as false. Client support inquiries should only be marked as true if they include topics like account setup, onboarding, or service usage; issues with products, services, or integrations; errors, bugs, or unexpected behaviour; requests for modifications, updates, or troubleshooting assistance; billing disputes or inquiries; requests for additional services, upgrades, or plan changes; or general customer inquiries that appear to require human response. However, only if the messages are clearly written by a person. You must read the context of the conversation and if it comes across as a system or auto-generated message, it is not a client support inquiry and doesn't require a reply. If the email is an automated notification, such as a top-up confirmation, system alert, scheduled report, marketing email, newsletter, promotional offer, advertisement, or an unsolicited sales pitch, mark customerSupport as false. Provide the result in JSON format with a field named \"customerSupport\" set to true or false.\n\nExample of an automated email requiring NO RESPONSE:\n\n\"Hi, A Workflow error has been detected in sub-account: [Account Name]. Please login and address the issue at your earliest convenience. Details: Agency Name: [Agency] Sub-Account Name: [Name] Sub-Account ID: [ID] Click below to view any/all errors.\"\n\nHere is another example of an automated email which does NOT require a response:\n\n\"Hi! How Was Your Experience with [Agent Name]? If your ticket was resolved, please fill out the survey below to let us know how [Agent Name] did! It only takes a quick second. Simply click the button above. Your feedback is invaluable, whether positive or negative. We are committed to your success and appreciate your insights. Your ticket – [Ticket Subject] (#[Ticket Number]) – has been marked as Closed. If you think this ticket shouldn't be closed for any reason at all, please reply to this e-mail and let us know. Tickets are marked Closed when: 1. We believe we have resolved your issue or answered all of your questions. or 2. Four days have passed since we requested more information and received no response. Sincerely, Support Team\"\n\nAnother example of an automated email which would return customerSupport as false:\n\n\"Receipt from [Company]. Receipt #XXXX-XXXX. Amount paid $XX.XX. Date paid [Date]. Payment method - XXXX. Summary - Auto-Recharge for Agency of USD XX was successfully added to the wallet. Please, check the billing page for more details. If you have any questions, visit our support site, contact us at billing@example.com, or call us. Something wrong with the email? View in browser. You're receiving this email because you made a purchase at [Company], which partners with Stripe to provide invoicing and payment processing.\"\n\nExample of an email which would return customerSupport as True:\n\n\"[Name], as discussed please connect with [Your Name] re everything we discussed, I relayed with [Your Name] and they can certainly help you! Happy connecting. [Other Name], bringing you in on this chat when [Name] is ready for [service] for their businesses.\"\n"
            }
          ]
        },
        "promptType": "define",
        "hasOutputParser": true
      },
      "typeVersion": 1.7,
      "alwaysOutputData": false
    },
    {
      "id": "f640d916-6038-41dd-96ce-46d0100976c4",
      "name": "Vector Storage",
      "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
      "position": [
        128,
        752
      ],
      "parameters": {
        "options": {},
        "tableName": {
          "__rl": true,
          "mode": "list",
          "value": "documents",
          "cachedResultName": "documents"
        }
      },
      "credentials": {
        "supabaseApi": {
          "id": "sc0CWXFVmz3jZ0wj",
          "name": "Supabase Account"
        }
      },
      "typeVersion": 1.2
    },
    {
      "id": "60ba060b-b29f-4df5-bb16-3aa09b522e9a",
      "name": "Email Draft Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "position": [
        0,
        0
      ],
      "parameters": {
        "text": "=Draft a response to this email:\n\n{{ $('Set Content').item.json.emailBody }}",
        "options": {
          "systemMessage": "=You are an AI assistant that drafts professional email responses. You write emails that are:\n\n- Direct and to the point (no fluff)\n- Professional yet friendly in tone\n- Helpful without being overly formal\n- Solution-focused: what can we do to fix/achieve this?\n\nTASK:\n1. Read the incoming email\n2. Draft an appropriate response following the rules below\n3. Use the \"createDraft\" tool to create the draft email response\n\nCRITICAL RULES:\n1. ALWAYS reply to the sender, never to yourself\n2. Use \"I\" not \"we\" - you're representing an individual, not a corporate team\n3. Keep it short - 2-3 paragraphs max\n4. Use the Vector Store to reference internal docs when needed\n5. Always end with a professional sign-off\n\nCONTEXT: Customise this prompt for your business context. Include details about your services, tech stack, and typical customer inquiries.\n\n---\n\nEXAMPLE 1 - CLIENT SUPPORT:\nIncoming Email: \"Our workflow isn't triggering when new leads come in. Can you take a look?\"\n\nDraft Response:\n\"Hey [Name],\n\nJust had a look - sounds like the webhook might not be firing correctly. Can you check if the trigger conditions are set to 'any new contact' rather than a specific tag? That's usually the culprit.\n\nIf that doesn't sort it, shoot me a screenshot of the workflow trigger settings and I'll jump in to fix it.\n\nBest regards,\n[Your Name]\"\n\n---\n\nEXAMPLE 2 - CLIENT REQUEST:\nIncoming Email: \"I want to add SMS follow-ups to the sequence. Is that possible?\"\n\nDraft Response:\n\"Hey [Name],\n\nYep, we can definitely add SMS to the sequence. It'll sit between the second and third email in the current flow - usually gets better engagement than email alone.\n\nI'll need your SMS provider credentials to set it up. Can you send those through when you get a chance?\n\nBest regards,\n[Your Name]\"\n\n---\n\nEXAMPLE 3 - PROSPECT FOLLOW-UP:\nIncoming Email: \"Thanks for the proposal. Can you clarify how the lead scoring works in the system?\"\n\nDraft Response:\n\"Hey [Name],\n\nLead scoring tracks engagement across emails, link clicks, and replies. Hot leads (opened 3+ emails + clicked) get prioritised for your sales team, while cold leads get longer nurture sequences.\n\nThe system adjusts automatically based on behaviour - so you're not manually sorting through thousands of contacts.\n\nWant to jump on a quick call to walk through how it'd work with your database?\n\nBest regards,\n[Your Name]\"\n\n---\n\nIf you don't have enough info to answer properly, say \"I need a bit more context on [specific thing] - could you send that through please?\""
        },
        "promptType": "define"
      },
      "typeVersion": 1.7
    },
    {
      "id": "main-sticky-note",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1888,
        -16
      ],
      "parameters": {
        "color": 5,
        "width": 480,
        "height": 520,
        "content": "## Auto-draft email replies with AI using Gmail and OpenAI\n\nThis workflow automatically monitors your Gmail inbox and uses AI to draft intelligent email responses. It filters out automated/system emails and only drafts replies to genuine human inquiries that need your attention.\n\n### How it works\n1. **Gmail Trigger** polls your inbox for new emails\n2. **AI Classification** analyses each email to determine if it needs a human response (filters out newsletters, receipts, automated notifications)\n3. **Email Draft Agent** uses OpenAI to generate a contextual draft reply based on your writing style and business context\n4. **Notification** sends you a Telegram message when drafts are created or when non-support emails arrive\n\n### Setup steps\n1. Connect your **Gmail account** (OAuth2 credentials)\n2. Connect your **OpenAI API** key\n3. Connect your **OpenRouter API** key (for email classification)\n4. Set up **Telegram bot** and add your chat ID for notifications\n5. (Optional) Configure **Supabase** vector store with your FAQ/knowledge base documents\n6. Customise the Email Draft Agent system prompt with your business context and writing style examples"
      },
      "typeVersion": 1
    },
    {
      "id": "c161061a-77ad-41fc-904e-2452b20d002e",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1104,
        192
      ],
      "parameters": {
        "color": 7,
        "width": 432,
        "height": 384,
        "content": "### Email Classification\nDetermines if the email needs your attention or is automated/system-generated"
      },
      "typeVersion": 1
    },
    {
      "id": "6419ab0e-7bf9-4465-bf12-927198fddc0f",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        32,
        560
      ],
      "parameters": {
        "color": 7,
        "width": 560,
        "height": 464,
        "content": "### Knowledge Base (Optional)\nVector store for retrieving relevant docs when drafting responses"
      },
      "typeVersion": 1
    },
    {
      "id": "a3a4666f-bca4-412e-858c-f206cc28254e",
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -208,
        -128
      ],
      "parameters": {
        "color": 7,
        "width": 640,
        "height": 528,
        "content": "### Email Drafting Agent\nGenerates AI-powered draft responses. Customise the system prompt with your writing style and business context."
      },
      "typeVersion": 1
    },
    {
      "id": "00d64551-c72a-42da-b815-1812d14f5548",
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1104,
        592
      ],
      "parameters": {
        "color": 6,
        "width": 432,
        "height": 112,
        "content": "### Customisation Required\nAdjust the classification prompt to match your use case. Change the output variable (e.g., needsMyAttention: True/False) if customerSupport isn't relevant for you."
      },
      "typeVersion": 1
    },
    {
      "id": "f6c59bf6-79e8-41d6-bb72-430b8d82d43d",
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -208,
        416
      ],
      "parameters": {
        "color": 6,
        "width": 640,
        "height": 112,
        "content": "### Customisation Required\nUpdate the system prompt with your business details, writing style, and 5-10 example emails to train the AI on your communication style."
      },
      "typeVersion": 1
    },
    {
      "id": "notification-sticky",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -480,
        416
      ],
      "parameters": {
        "color": 7,
        "width": 320,
        "height": 288,
        "content": "### Notifications\nSends Telegram notifications for new drafts and non-support emails"
      },
      "typeVersion": 1
    },
    {
      "id": "input-sticky",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1408,
        192
      ],
      "parameters": {
        "color": 7,
        "width": 256,
        "height": 288,
        "content": "### Email Input\nTriggers on new emails and extracts key fields"
      },
      "typeVersion": 1
    }
  ],
  "active": true,
  "pinData": {},
  "settings": {
    "timezone": "Australia/Brisbane",
    "callerPolicy": "workflowsFromSameOwner",
    "timeSavedMode": "fixed",
    "availableInMCP": false,
    "executionOrder": "v1",
    "executionTimeout": -1,
    "timeSavedPerExecution": 5
  },
  "versionId": "1e6ed2d7-5423-4818-b7aa-7efe70a8a8da",
  "connections": {
    "Set Content": {
      "main": [
        [
          {
            "node": "Client/Prospect Related?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "createDraft": {
      "ai_tool": [
        [
          {
            "node": "Email Draft Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Gmail Trigger": {
      "main": [
        [
          {
            "node": "Set Content",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Vector Storage": {
      "ai_vectorStore": [
        [
          {
            "node": "Vector Store Tool",
            "type": "ai_vectorStore",
            "index": 0
          }
        ]
      ]
    },
    "Customer Support?": {
      "main": [
        [
          {
            "node": "Email Draft Agent",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Response Not Customer Support",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Email Draft Agent": {
      "main": [
        [
          {
            "node": "Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI": {
      "ai_embedding": [
        [
          {
            "node": "Vector Storage",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Email Draft Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Vector Store Tool": {
      "ai_tool": [
        [
          {
            "node": "Email Draft Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "Vector Store Tool",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Client/Prospect Related?",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Client/Prospect Related?": {
      "main": [
        [
          {
            "node": "Customer Support?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser": {
      "ai_outputParser": [
        [
          {
            "node": "Client/Prospect Related?",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    }
  }
}