{
  "id": "",
  "meta": {
    "site": "https://github.com/zengfr/n8n-workflow-all-templates",
    "name": "Back up n8n workflows to Google Drive while preserving folder structure",
    "wechat": "youandme10086",
    "id": 13245,
    "update_time": "2026-02-13"
  },
  "name": "Complete automated n8n workflows backup solution to Google Drive_with n8n tables v2",
  "tags": [],
  "nodes": [
    {
      "id": "353e5f98-b6db-465a-b288-b3312cc1c620",
      "name": "n8n login API1",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        96,
        1088
      ],
      "parameters": {
        "url": "={{ $json.n8n_instance_URL }}/rest/login",
        "method": "POST",
        "options": {
          "response": {
            "response": {
              "fullResponse": true
            }
          }
        },
        "jsonBody": "={\"emailOrLdapLoginId\":\"{{ $json.emailOrLdapLoginId }}\",\"password\":\"{{ $json.password }}\"}",
        "sendBody": true,
        "specifyBody": "json"
      },
      "typeVersion": 4.3
    },
    {
      "id": "f86e0357-e26b-4107-a397-755b009ae3f7",
      "name": "get subfolder(s) structure",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        2848,
        1088
      ],
      "parameters": {
        "url": "={{ $('n8n instance/project access details').item.json.n8n_instance_URL }}/rest/workflows?includeScopes=true&includeFolders=true&skip=0&take=400",
        "options": {},
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Cookie",
              "value": "={{ $json['n8n-auth'] }}"
            }
          ]
        }
      },
      "typeVersion": 4.3
    },
    {
      "id": "70246a13-9d2b-4ba6-b6aa-61db71901729",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2752,
        944
      ],
      "parameters": {
        "color": 6,
        "width": 2048,
        "height": 512,
        "content": "# 3/ Get project folder(s) and add names in n8n tables \"folders\" & \"workflows\" : root and subfolders"
      },
      "typeVersion": 1
    },
    {
      "id": "14c73cfd-c813-4743-803f-824855e5a42f",
      "name": "Merge",
      "type": "n8n-nodes-base.merge",
      "position": [
        7408,
        224
      ],
      "parameters": {
        "mode": "combine",
        "options": {},
        "advanced": true,
        "joinMode": "enrichInput1",
        "mergeByFields": {
          "values": [
            {
              "field1": "data.parentFolder.id",
              "field2": "folderId"
            }
          ]
        }
      },
      "typeVersion": 3.2
    },
    {
      "id": "d9c492ff-090f-4258-91d9-826ed1b2f924",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        5648,
        -272
      ],
      "parameters": {
        "color": 6,
        "width": 1056,
        "height": 304,
        "content": "# 4/ Assign the folder's fullPath value"
      },
      "typeVersion": 1
    },
    {
      "id": "0d4996ec-be61-46e2-b54f-4e0bba8f4d1a",
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        5648,
        112
      ],
      "parameters": {
        "color": 6,
        "width": 2800,
        "height": 384,
        "content": "# 5/ Get workflow + folder relation with full path and add it to \"workflows\" table"
      },
      "typeVersion": 1
    },
    {
      "id": "c5571495-9593-4790-9c36-710061bd7618",
      "name": "Search if folder already exists",
      "type": "n8n-nodes-base.googleDrive",
      "maxTries": 3,
      "position": [
        8768,
        800
      ],
      "parameters": {
        "filter": {
          "driveId": {
            "__rl": true,
            "mode": "list",
            "value": "My Drive",
            "cachedResultUrl": "https://drive.google.com/drive/my-drive",
            "cachedResultName": "My Drive"
          },
          "folderId": {
            "__rl": true,
            "mode": "id",
            "value": "={{ $json.parent_google_folder_Id }}"
          },
          "whatToSearch": "folders"
        },
        "options": {
          "fields": [
            "name",
            "id"
          ]
        },
        "resource": "fileFolder",
        "returnAll": true,
        "queryString": "=mimeType = 'application/vnd.google-apps.folder' and name = '{{ $json[\"folderName\"] }}'",
        "searchMethod": "query"
      },
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "ipWSglDR3WeYHBf5",
          "name": "Google Drive account"
        }
      },
      "retryOnFail": true,
      "typeVersion": 3,
      "alwaysOutputData": true,
      "waitBetweenTries": 5000
    },
    {
      "id": "c9fbcbc1-1891-4722-9546-fd585cce684d",
      "name": "if folder not found => create it",
      "type": "n8n-nodes-base.if",
      "position": [
        9040,
        800
      ],
      "parameters": {
        "options": {},
        "conditions": {
          "options": {
            "version": 3,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "combinator": "and",
          "conditions": [
            {
              "id": "961c3bb2-5f6d-4c4e-b081-1df15c421f07",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              },
              "leftValue": "={{ $json.isEmpty() }}",
              "rightValue": ""
            }
          ]
        }
      },
      "typeVersion": 2.3
    },
    {
      "id": "2777127a-d490-48c8-a581-3949876efe16",
      "name": "Attach the parentFolder if any",
      "type": "n8n-nodes-base.set",
      "position": [
        9360,
        784
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "3bd8e3a9-f787-401a-9326-7f74424b5da5",
              "name": "subfolder",
              "type": "string",
              "value": "={{ $('One run per folder').item.json[\"folderName\"] }}"
            },
            {
              "id": "5bdb5050-cf5e-4c2e-8d52-7ae44eb04f2c",
              "name": "parentFolder",
              "type": "string",
              "value": "={{ $('One run per folder').item.json.parentFolderName }}"
            }
          ]
        },
        "includeOtherFields": true
      },
      "typeVersion": 3.4
    },
    {
      "id": "ae690b2f-2381-495d-b1ea-3b0ec4fed5fc",
      "name": "if parentFolder empty",
      "type": "n8n-nodes-base.if",
      "position": [
        9648,
        784
      ],
      "parameters": {
        "options": {},
        "conditions": {
          "options": {
            "version": 3,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "combinator": "and",
          "conditions": [
            {
              "id": "4a4f7eb5-e1e8-4dec-914c-c55ecef8654e",
              "operator": {
                "type": "string",
                "operation": "equals"
              },
              "leftValue": "={{ $json.parentFolder }}",
              "rightValue": "null"
            }
          ]
        }
      },
      "typeVersion": 2.3
    },
    {
      "id": "287807d7-a4aa-439f-84f1-f54be08d4096",
      "name": "Create folder under the parentFolder",
      "type": "n8n-nodes-base.googleDrive",
      "maxTries": 3,
      "position": [
        10416,
        1072
      ],
      "parameters": {
        "name": "={{ $json.subfolder }}",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive",
          "cachedResultUrl": "https://drive.google.com/drive/my-drive",
          "cachedResultName": "My Drive"
        },
        "options": {},
        "folderId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $json.google_folder_id }}"
        },
        "resource": "folder"
      },
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "ipWSglDR3WeYHBf5",
          "name": "Google Drive account"
        }
      },
      "retryOnFail": true,
      "typeVersion": 3,
      "waitBetweenTries": 5000
    },
    {
      "id": "97328014-4dcd-421f-b536-4ee82743fa9b",
      "name": "Split Out3",
      "type": "n8n-nodes-base.splitOut",
      "position": [
        5712,
        2992
      ],
      "parameters": {
        "options": {},
        "fieldToSplitOut": "data"
      },
      "typeVersion": 1
    },
    {
      "id": "4935fe1e-1b06-4eba-b337-433d8229d495",
      "name": "Merge1",
      "type": "n8n-nodes-base.merge",
      "position": [
        7712,
        3024
      ],
      "parameters": {
        "mode": "combine",
        "options": {},
        "advanced": true,
        "joinMode": "enrichInput1",
        "mergeByFields": {
          "values": [
            {
              "field1": "=wf_folder_name",
              "field2": "folderName"
            }
          ]
        }
      },
      "typeVersion": 3.2
    },
    {
      "id": "c18e40c7-d91e-489d-aa24-12e6bec6211f",
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        5440,
        2480
      ],
      "parameters": {
        "color": 6,
        "width": 5584,
        "height": 976,
        "content": "# 8/ Upload each JSON workflow file into its google drive folder"
      },
      "typeVersion": 1
    },
    {
      "id": "bc8bb33f-6ec5-44b5-a0f1-8a74bad6cc85",
      "name": "Merge2",
      "type": "n8n-nodes-base.merge",
      "position": [
        8736,
        2928
      ],
      "parameters": {
        "mode": "combine",
        "options": {},
        "advanced": true,
        "joinMode": "enrichInput2",
        "mergeByFields": {
          "values": [
            {
              "field1": "wf_name",
              "field2": "name"
            }
          ]
        }
      },
      "typeVersion": 3.2
    },
    {
      "id": "99f98d6d-df6f-43b6-864f-c8a33fc9589d",
      "name": "wf_id + wf_name",
      "type": "n8n-nodes-base.set",
      "position": [
        8496,
        2800
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "b7fc8ea1-5821-461e-b87b-2a84f22155c2",
              "name": "wf_id",
              "type": "string",
              "value": "={{ $json.data.id }}"
            },
            {
              "id": "8d631960-60d3-4019-a1c6-1ef582aca223",
              "name": "wf_name",
              "type": "string",
              "value": "={{ $json.data.name }}"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "944a0897-db89-4367-ba4f-4e793199ca90",
      "name": "root folder : backup_n8n",
      "type": "n8n-nodes-base.set",
      "position": [
        9568,
        2768
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "4d118455-104d-435f-a976-527134ef63ec",
              "name": "main_root_folder",
              "type": "string",
              "value": "={{ $('rename fields7').item.json.google_folder_id }}"
            }
          ]
        },
        "includeOtherFields": true
      },
      "typeVersion": 3.4
    },
    {
      "id": "0b102969-a5ab-402e-98a6-7e432c170e31",
      "name": "Sticky Note7",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        10832,
        800
      ],
      "parameters": {
        "color": 4,
        "width": 336,
        "height": 80,
        "content": "## root folder(s) : full_path = 1"
      },
      "typeVersion": 1
    },
    {
      "id": "06afe40a-8f20-43a7-ba8c-83d1ccece6f1",
      "name": "Sticky Note8",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        11168,
        1136
      ],
      "parameters": {
        "color": 4,
        "width": 352,
        "height": 96,
        "content": "## subfolders"
      },
      "typeVersion": 1
    },
    {
      "id": "c2d29189-0a86-4cf7-89a3-32f533544df5",
      "name": "Merge3",
      "type": "n8n-nodes-base.merge",
      "position": [
        6544,
        1040
      ],
      "parameters": {
        "mode": "combine",
        "options": {},
        "joinMode": "enrichInput2",
        "fieldsToMatchString": "folderName"
      },
      "typeVersion": 3.2
    },
    {
      "id": "7f289285-2807-4764-a544-71d95b13c529",
      "name": "Merge6",
      "type": "n8n-nodes-base.merge",
      "position": [
        10208,
        1072
      ],
      "parameters": {
        "mode": "combine",
        "options": {},
        "combineBy": "combineByPosition"
      },
      "typeVersion": 3.2
    },
    {
      "id": "4642aa2c-ca78-41e6-83fe-7785346e632e",
      "name": "Sticky Note9",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        5440,
        1648
      ],
      "parameters": {
        "color": 6,
        "width": 3264,
        "height": 688,
        "content": "# 7/ Assign \"parent_google_folderid\" value in \"folders\" table"
      },
      "typeVersion": 1
    },
    {
      "id": "db892e02-5c85-4153-9023-b76df635aa94",
      "name": "Aggregate3",
      "type": "n8n-nodes-base.aggregate",
      "position": [
        4960,
        1056
      ],
      "parameters": {
        "options": {},
        "aggregate": "aggregateAllItemData"
      },
      "typeVersion": 1
    },
    {
      "id": "849737f1-cefa-4ceb-b5a4-75a162ba91af",
      "name": "Split Out1",
      "type": "n8n-nodes-base.splitOut",
      "position": [
        3616,
        1072
      ],
      "parameters": {
        "include": "allOtherFields",
        "options": {},
        "fieldToSplitOut": "data"
      },
      "typeVersion": 1
    },
    {
      "id": "09499178-bbd6-4580-a104-3827a952d8d3",
      "name": "Remove Duplicates",
      "type": "n8n-nodes-base.removeDuplicates",
      "position": [
        7712,
        224
      ],
      "parameters": {
        "compare": "selectedFields",
        "options": {},
        "fieldsToCompare": "data.name"
      },
      "typeVersion": 2
    },
    {
      "id": "574b7827-3b64-4a9c-98aa-53aff1b8122b",
      "name": "Schedule Trigger",
      "type": "n8n-nodes-base.scheduleTrigger",
      "position": [
        -784,
        1088
      ],
      "parameters": {
        "rule": {
          "interval": [
            {}
          ]
        }
      },
      "typeVersion": 1.3
    },
    {
      "id": "9ee84265-d3c2-4d88-a31c-8689690927a2",
      "name": "rename fields",
      "type": "n8n-nodes-base.set",
      "position": [
        7984,
        224
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "24db19c2-ca4f-40b5-b7e5-809e01a63e4f",
              "name": "workflow_id",
              "type": "string",
              "value": "={{ $json.data.id }}"
            },
            {
              "id": "d85602c8-ee40-46bf-8bbd-ff8f09ddaf25",
              "name": "workflow_name",
              "type": "string",
              "value": "={{ $json.data.name }}"
            },
            {
              "id": "5c16e433-77bc-4a8d-aada-ac60173d53e7",
              "name": "folder_name",
              "type": "string",
              "value": "={{ $json.data.parentFolder ? $json.data.parentFolder.name : 'root folder'  }}"
            },
            {
              "id": "ecb4b90a-ec90-4fb6-8457-64f1fa13e3fa",
              "name": "folder_id",
              "type": "string",
              "value": "={{ $json.data.parentFolder ? $json.data.parentFolder.id : 'root folder'}}"
            },
            {
              "id": "4cc53ac4-3019-4ac5-8982-7b55a38fe202",
              "name": "parentFolderName",
              "type": "string",
              "value": "={{ $json[\"parentFolderName\"] ? $json[\"parentFolderName\"] : 'root folder' }}"
            },
            {
              "id": "0a8c11cf-34de-4361-89d8-855c276c7334",
              "name": "parentFolderId",
              "type": "string",
              "value": "={{ $json.parentFolderId ? $json.parentFolderId : 'null' }}"
            },
            {
              "id": "190e119f-6a70-4da1-aa0d-47a3457d9226",
              "name": "full_path",
              "type": "string",
              "value": "={{ $json.full_path }}/{{ $json.data.name }}"
            },
            {
              "id": "3ece2341-45e3-4751-babd-769cdfbd0b09",
              "name": "workflow_google_file_id",
              "type": "string",
              "value": ""
            },
            {
              "id": "f4c317f5-2fa2-4901-b902-12678e60bf70",
              "name": "folder_google_id",
              "type": "string",
              "value": ""
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "d896cbc2-ee87-4395-80b6-65df9347b972",
      "name": "rename fields1",
      "type": "n8n-nodes-base.set",
      "position": [
        4288,
        1056
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "2c38083a-7bc0-42fd-a361-143182a1eac1",
              "name": "folderId",
              "type": "string",
              "value": "={{ $json.data.id }}"
            },
            {
              "id": "abb3ce18-4932-406a-b12a-79aed4496a0e",
              "name": "folderName",
              "type": "string",
              "value": "={{ $json.data.name }}"
            },
            {
              "id": "4511394e-a89f-4d12-9147-32f77ccda49a",
              "name": "folderType",
              "type": "string",
              "value": "={{ $json.data.parentFolder ? 'sub folder' : 'root folder' }}"
            },
            {
              "id": "226914ec-f619-4119-825d-19c3daf1fedd",
              "name": "parentFolderName",
              "type": "string",
              "value": "={{ $json.data.parentFolder ? $json.data.parentFolder.name : 'null' }}"
            },
            {
              "id": "0cfdf094-d2ae-4d61-9f27-80853ba1c66a",
              "name": "parentFolderId",
              "type": "string",
              "value": "={{ $json.data.parentFolderId ? $json.data.parentFolderId : 'null'  }}"
            },
            {
              "id": "22eb2393-2987-431e-bdf3-0c4926cedd46",
              "name": "workflowCount",
              "type": "string",
              "value": "={{ $json.data.workflowCount }}"
            },
            {
              "id": "f4817fc1-3bf5-4825-8134-503757cf6ce9",
              "name": "subFolderCount",
              "type": "string",
              "value": "={{ $json.data.subFolderCount }}"
            },
            {
              "id": "cf6ebbcf-28e4-4461-b4ef-12658b0e9d05",
              "name": "google_folder_id",
              "type": "string",
              "value": ""
            },
            {
              "id": "0e11c873-13eb-46b6-a78d-eb9ae5c2e5ba",
              "name": "parent_google_folderid",
              "type": "string",
              "value": ""
            },
            {
              "id": "fc055add-79e0-4155-9a50-56471a2f2370",
              "name": "main_root_folder_name",
              "type": "string",
              "value": ""
            },
            {
              "id": "b79a93b5-246e-49d0-bd32-fa1a8ba4dce8",
              "name": "main_root_folder_google_folder_id",
              "type": "string",
              "value": ""
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "278d5d6a-0728-402e-99df-1efedc47f297",
      "name": "rename main_root_folder fields",
      "type": "n8n-nodes-base.set",
      "position": [
        6160,
        864
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "442e923e-af2c-4901-9e5e-b494e764013b",
              "name": "main_root_folder_name",
              "type": "string",
              "value": "={{ $('Create backup folder \"n8n_backup_folder_structure_ddMMyyyy_HHmmss\"').item.json.name }}"
            },
            {
              "id": "66c62de7-6b55-4cef-b125-af551dc04cc4",
              "name": "main_root_folder_google_folder_id",
              "type": "string",
              "value": "={{ $('Create backup folder \"n8n_backup_folder_structure_ddMMyyyy_HHmmss\"').item.json.id }}"
            }
          ]
        },
        "includeOtherFields": true
      },
      "typeVersion": 3.4
    },
    {
      "id": "e2576b68-8ea5-462d-a1a2-3792789d98da",
      "name": "Create folder under the static \"backup_n8n\" folder",
      "type": "n8n-nodes-base.googleDrive",
      "maxTries": 3,
      "position": [
        10080,
        768
      ],
      "parameters": {
        "name": "={{ $json.subfolder }}",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "options": {},
        "folderId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('One run per folder').item.json.main_root_folder_google_folder_id }}"
        },
        "resource": "folder"
      },
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "ipWSglDR3WeYHBf5",
          "name": "Google Drive account"
        }
      },
      "retryOnFail": true,
      "typeVersion": 3,
      "waitBetweenTries": 5000
    },
    {
      "id": "5875effd-9ba5-45ce-9071-a082696d010d",
      "name": "rename fields2",
      "type": "n8n-nodes-base.set",
      "position": [
        10384,
        768
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "80fa0fad-a41b-4852-b858-c5bee7f41d7b",
              "name": "folderName",
              "type": "string",
              "value": "={{ $json.name }}"
            },
            {
              "id": "861cbaed-fa08-43d3-9d6a-545690409301",
              "name": "google_folder_id",
              "type": "string",
              "value": "={{ $json.id }}"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "f82565fa-81e3-439c-9381-3e17c21b460e",
      "name": "rename fields3",
      "type": "n8n-nodes-base.set",
      "position": [
        10720,
        1072
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "ef6355e7-7c8d-4449-b5ef-bd9263d426ff",
              "name": "folderName",
              "type": "string",
              "value": "={{ $json.name }}"
            },
            {
              "id": "8c8838a6-1c0a-447b-85f0-2f2586ecd6c1",
              "name": "google_folder_id",
              "type": "string",
              "value": "={{ $json.id }}"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "d1286c28-073b-4393-beee-4d04a352027b",
      "name": "get directParentFolderName",
      "type": "n8n-nodes-base.set",
      "position": [
        5936,
        1936
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "ea93a04a-52b0-400b-9b9f-071f8b7b3cb3",
              "name": "directParentFolderName",
              "type": "string",
              "value": "={{ $json.full_path.split('/').length > 1 ? $json.full_path.split('/')[$json.full_path.split('/').length - 2] : $json.main_root_folder_name }}"
            }
          ]
        },
        "includeOtherFields": true
      },
      "typeVersion": 3.4
    },
    {
      "id": "a4360ada-1024-4fbb-95a9-d5708dfe36ea",
      "name": "Split root vs subfolders",
      "type": "n8n-nodes-base.if",
      "position": [
        6208,
        1936
      ],
      "parameters": {
        "options": {},
        "conditions": {
          "options": {
            "version": 3,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "combinator": "and",
          "conditions": [
            {
              "id": "2a1f4632-d430-406c-94c1-a4472a9184db",
              "operator": {
                "type": "string",
                "operation": "equals"
              },
              "leftValue": "={{ $json.parentFolderName }}",
              "rightValue": "null"
            }
          ]
        }
      },
      "typeVersion": 2.3
    },
    {
      "id": "b6c1f647-5f2b-413a-96c0-8ff5884c3c66",
      "name": "Merge4",
      "type": "n8n-nodes-base.merge",
      "position": [
        7056,
        2160
      ],
      "parameters": {
        "mode": "combine",
        "options": {},
        "advanced": true,
        "joinMode": "enrichInput1",
        "mergeByFields": {
          "values": [
            {
              "field1": "parentFolderName_branch",
              "field2": "directParentFolderName"
            }
          ]
        }
      },
      "typeVersion": 3.2
    },
    {
      "id": "779fb573-faaf-46d6-a616-6278c1af673e",
      "name": "Remove Duplicates1",
      "type": "n8n-nodes-base.removeDuplicates",
      "position": [
        7264,
        2160
      ],
      "parameters": {
        "compare": "selectedFields",
        "options": {},
        "fieldsToCompare": "folderName"
      },
      "typeVersion": 2
    },
    {
      "id": "903b2574-97d1-4d27-ade9-33b60454867a",
      "name": "rename fields4",
      "type": "n8n-nodes-base.set",
      "position": [
        7472,
        2160
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "3aef0d40-ce48-4963-9c21-7d6bec3e03fe",
              "name": "folderName",
              "type": "string",
              "value": "={{ $json.folderName }}"
            },
            {
              "id": "3bd77b8c-3005-42f9-b08b-2a5840bba1f2",
              "name": "parent_google_folderid",
              "type": "string",
              "value": "={{ $json.parent_google_folderid_branch }}"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "0776b44b-7cc8-4301-9d49-af532c819225",
      "name": "rename fields5",
      "type": "n8n-nodes-base.set",
      "position": [
        6848,
        1952
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "d5ccb91f-8e02-422a-ae5a-05b4d8c5fa2f",
              "name": "parentFolderName_branch",
              "type": "string",
              "value": "={{ $json.folderName }}"
            },
            {
              "id": "70fa4065-5c40-435d-8151-a876ff059b77",
              "name": "parent_google_folderid_branch",
              "type": "string",
              "value": "={{ $json.google_folder_id }}"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "3b6758e8-5710-4257-85a6-06ec3b770ade",
      "name": "rename fields6",
      "type": "n8n-nodes-base.set",
      "position": [
        7456,
        1808
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "1e49108f-0abe-4ee6-a1ca-d8d79868a053",
              "name": "folderName",
              "type": "string",
              "value": "={{ $json.folderName }}"
            },
            {
              "id": "8655c8f0-124a-4f55-a628-eb301adb5980",
              "name": "parent_google_folderid",
              "type": "string",
              "value": "={{ $json.main_root_folder_google_folder_id }}"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "48cda734-f70b-4f1a-bcd4-5e1a9362fd70",
      "name": "Sticky Note11",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        7952,
        1824
      ],
      "parameters": {
        "color": 4,
        "width": 624,
        "height": 80,
        "content": "## Assign \"parent_google_folderid\" value to root folders"
      },
      "typeVersion": 1
    },
    {
      "id": "9b5f08ed-2b1c-49d8-8780-9dc5fd50f66e",
      "name": "Sticky Note13",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        7952,
        2160
      ],
      "parameters": {
        "color": 4,
        "width": 624,
        "height": 80,
        "content": "## Assign \"parent_google_folderid\" value to sub folders"
      },
      "typeVersion": 1
    },
    {
      "id": "3f4b64a3-f55a-4aa7-bb60-0ced18210aac",
      "name": "If there parentFolder.isEmpty()",
      "type": "n8n-nodes-base.if",
      "position": [
        6304,
        2992
      ],
      "parameters": {
        "options": {},
        "conditions": {
          "options": {
            "version": 3,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "combinator": "and",
          "conditions": [
            {
              "id": "b5b4e356-815f-4f23-bf93-b5a1225098f5",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              },
              "leftValue": "={{ $json.parentFolder.isEmpty() }}",
              "rightValue": ""
            },
            {
              "id": "a0f473c0-72ba-4853-886a-a71b8ae28b55",
              "operator": {
                "name": "filter.operator.equals",
                "type": "string",
                "operation": "equals"
              },
              "leftValue": "",
              "rightValue": ""
            }
          ]
        }
      },
      "typeVersion": 2.3
    },
    {
      "id": "c719f2d7-5ae9-44a6-a851-798130227585",
      "name": "Remove Duplicates2",
      "type": "n8n-nodes-base.removeDuplicates",
      "position": [
        8000,
        3024
      ],
      "parameters": {
        "compare": "selectedFields",
        "options": {},
        "fieldsToCompare": "name"
      },
      "typeVersion": 2
    },
    {
      "id": "5a2bff07-3acf-475f-965c-d6eb6de9fc14",
      "name": "Merge5",
      "type": "n8n-nodes-base.merge",
      "position": [
        7760,
        2720
      ],
      "parameters": {
        "mode": "combine",
        "options": {},
        "combineBy": "combineByPosition"
      },
      "typeVersion": 3.2
    },
    {
      "id": "c681fc03-c4a0-41cc-99b6-dc5cbfe29ff5",
      "name": "rename fields7",
      "type": "n8n-nodes-base.set",
      "position": [
        7984,
        2720
      ],
      "parameters": {
        "include": "except",
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "0f1832a2-e6b1-482d-a8e7-1e50e795091a",
              "name": "id",
              "type": "string",
              "value": "={{ $json.workflow_id }}"
            },
            {
              "id": "947945e7-f906-4247-a779-57b056726f8f",
              "name": "google_folder_id",
              "type": "string",
              "value": "={{ $json.main_root_folder_google_folder_id }}"
            }
          ]
        },
        "excludeFields": "google_folder_id",
        "includeOtherFields": true
      },
      "typeVersion": 3.4
    },
    {
      "id": "aee28764-f53b-4067-90cc-a9e466899e88",
      "name": "Upload file to its folder",
      "type": "n8n-nodes-base.googleDrive",
      "maxTries": 3,
      "position": [
        9808,
        3136
      ],
      "parameters": {
        "name": "={{ $binary.data.fileName }}",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "options": {},
        "folderId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Merge1').item.json.google_folder_id ? $('Merge1').item.json.google_folder_id : $json.main_root_folder }}"
        }
      },
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "ipWSglDR3WeYHBf5",
          "name": "Google Drive account"
        }
      },
      "retryOnFail": true,
      "typeVersion": 3,
      "waitBetweenTries": 5000
    },
    {
      "id": "c6a0f9a5-fb5f-4d08-a7f6-07a36a83275b",
      "name": "root folder : backup_n8n1",
      "type": "n8n-nodes-base.set",
      "position": [
        9568,
        3136
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "4d118455-104d-435f-a976-527134ef63ec",
              "name": "main_root_folder",
              "type": "string",
              "value": "={{ $('Merge1').item.json.main_root_folder_google_folder_id }}"
            }
          ]
        },
        "includeOtherFields": true
      },
      "typeVersion": 3.4
    },
    {
      "id": "7924cb95-ef68-4bd5-8430-d8d9708c48d7",
      "name": "If parentFolder is null",
      "type": "n8n-nodes-base.if",
      "position": [
        9216,
        2928
      ],
      "parameters": {
        "options": {},
        "conditions": {
          "options": {
            "version": 3,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "combinator": "and",
          "conditions": [
            {
              "id": "627fe1c6-3812-4a1e-9bd9-3f5b1224b6dd",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              },
              "leftValue": "={{ $('Merge2').item.json.parentFolder == null}}",
              "rightValue": ""
            }
          ]
        }
      },
      "typeVersion": 2.3
    },
    {
      "id": "3b2d2418-31e3-476d-bd9d-4b8a16e85223",
      "name": "Sticky Note12",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        10256,
        2784
      ],
      "parameters": {
        "color": 4,
        "width": 624,
        "height": 80,
        "content": "## workflows at the main root folder location"
      },
      "typeVersion": 1
    },
    {
      "id": "2f0839fe-90d5-40f1-97fe-b8e89be8f0af",
      "name": "Sticky Note14",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        10320,
        3136
      ],
      "parameters": {
        "color": 4,
        "width": 624,
        "height": 80,
        "content": "## workflows in other folders"
      },
      "typeVersion": 1
    },
    {
      "id": "4ebf8664-2c1f-49f9-825e-0b6f78e986e2",
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -432,
        752
      ],
      "parameters": {
        "color": 6,
        "width": 1104,
        "height": 576,
        "content": "# 1/ Initialize n8n instance access details to reach n8n API "
      },
      "typeVersion": 1
    },
    {
      "id": "d06f6060-c677-4194-84fc-fbfb9c6c123a",
      "name": "If resource == \"folder\"",
      "type": "n8n-nodes-base.if",
      "position": [
        3920,
        1072
      ],
      "parameters": {
        "options": {},
        "conditions": {
          "options": {
            "version": 3,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "combinator": "and",
          "conditions": [
            {
              "id": "57414794-90d0-48a3-8ff7-bb081e889e93",
              "operator": {
                "type": "string",
                "operation": "equals"
              },
              "leftValue": "={{ $json.data.resource }}",
              "rightValue": "=folder"
            }
          ]
        }
      },
      "typeVersion": 2.3
    },
    {
      "id": "fde0a53f-d6c5-4eb1-b825-68c0348e32bc",
      "name": "Define & assign folder's fullPath value",
      "type": "n8n-nodes-base.code",
      "position": [
        6016,
        -176
      ],
      "parameters": {
        "jsCode": "// Add comments for explanation\n// 1. Create a lookup for folders by ID\nconst folderMap = {};\nfor (const item of items) {\n  folderMap[item.json.folderId] = item.json;\n}\n\n// 2. Recursive function to build full path\nfunction buildFullPath(folder) {\n  if (!folder.parentFolderId || folder.parentFolderId === 'null') {\n    return folder['folderName'];\n  }\n\n  const parent = folderMap[folder.parentFolderId];\n  if (!parent) {\n    return folder['folderName']; // Edge case: parent missing\n  }\n\n  return `${buildFullPath(parent)}/${folder['folderName']}`;\n}\n\n// 3. Loop over all folders and generate full_path\nreturn items.map(item => {\n  const folder = item.json;\n  folder.full_path = buildFullPath(folder);\n  return { json: folder };\n});\n"
      },
      "typeVersion": 2
    },
    {
      "id": "405599d3-0650-436a-b742-5578ae0fe078",
      "name": "get all workflows",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        5712,
        208
      ],
      "parameters": {
        "url": "={{ $('n8n instance/project access details').item.json.n8n_instance_URL }}/rest/workflows",
        "options": {},
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Cookie",
              "value": "={{ $('n8n-auth for n8n API').item.json[\"n8n-auth\"] }}"
            }
          ]
        }
      },
      "typeVersion": 4.3
    },
    {
      "id": "f3fa0ced-1e77-43e6-8b14-f3fab9465aff",
      "name": "extract each workflow",
      "type": "n8n-nodes-base.splitOut",
      "position": [
        5920,
        208
      ],
      "parameters": {
        "options": {},
        "fieldToSplitOut": "data"
      },
      "typeVersion": 1
    },
    {
      "id": "38c66395-8691-41b0-b37c-74561c7f4ee7",
      "name": "Create backup folder \"n8n_backup_folder_structure_ddMMyyyy_HHmmss\"",
      "type": "n8n-nodes-base.googleDrive",
      "position": [
        5664,
        1056
      ],
      "parameters": {
        "name": "=n8n_backup_folder_structure_{{ $now.format('ddMMyyyy_HHmmss') }}",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "options": {},
        "folderId": {
          "__rl": true,
          "mode": "list",
          "value": "1d07iU8QVVbctS6KRTUlmxFdiI8z8FlwS",
          "cachedResultUrl": "https://drive.google.com/drive/folders/1d07iU8QVVbctS6KRTUlmxFdiI8z8FlwS",
          "cachedResultName": "backup_n8n"
        },
        "resource": "folder"
      },
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "ipWSglDR3WeYHBf5",
          "name": "Google Drive account"
        }
      },
      "retryOnFail": true,
      "typeVersion": 3,
      "waitBetweenTries": 5000
    },
    {
      "id": "f4bdc2e5-f7cc-4c8d-9c1d-1fdb0d812466",
      "name": "Sort to get root folders first",
      "type": "n8n-nodes-base.sort",
      "position": [
        7632,
        784
      ],
      "parameters": {
        "options": {},
        "sortFieldsUi": {
          "sortField": [
            {
              "fieldName": "order"
            }
          ]
        }
      },
      "typeVersion": 1
    },
    {
      "id": "da116a85-8ef8-47ae-b779-8d1b21621e2c",
      "name": "define full_path length",
      "type": "n8n-nodes-base.set",
      "position": [
        7328,
        1040
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "a1ebcfbe-d91f-482a-a4b8-1c41aec7bdf5",
              "name": "order",
              "type": "string",
              "value": "={{ $json.full_path.split(\"/\").length }}"
            }
          ]
        },
        "includeOtherFields": true
      },
      "typeVersion": 3.4
    },
    {
      "id": "85d843a7-0d1e-4bc2-b635-65efce4f9954",
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        5424,
        624
      ],
      "parameters": {
        "color": 6,
        "width": 6336,
        "height": 816,
        "content": "# 6/ Upload the n8n folder structure in gdrive\n\n## + add the \"google_folder_id\" of each folder in table \"folders\". For example :\n- for uploaded folder https://drive.google.com/drive/u/1/folders/1bbirmn7VdcZknQ0hjzVmthiu4XaAAAB \n- the \"google_folder_id\" is 1bbirmn7VdcZknQ0hjzVmthiu4XaAAAB"
      },
      "typeVersion": 1
    },
    {
      "id": "b19b1161-32c4-437e-8966-d25c8d18ed7e",
      "name": "One run per folder",
      "type": "n8n-nodes-base.splitInBatches",
      "position": [
        7984,
        784
      ],
      "parameters": {
        "options": {}
      },
      "typeVersion": 3
    },
    {
      "id": "90af4c43-0bc2-4950-b340-84a939b610ec",
      "name": "get all workflows1",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        5504,
        2992
      ],
      "parameters": {
        "url": "={{ $('n8n instance/project access details').item.json.n8n_instance_URL }}/rest/workflows",
        "options": {},
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Cookie",
              "value": "={{ $('n8n-auth for n8n API').item.json['n8n-auth'] }}"
            }
          ]
        }
      },
      "typeVersion": 4.3
    },
    {
      "id": "da1acb00-2d43-4923-9154-27e9ea81710f",
      "name": "keep only workflows not archived",
      "type": "n8n-nodes-base.filter",
      "position": [
        6176,
        208
      ],
      "parameters": {
        "options": {},
        "conditions": {
          "options": {
            "version": 3,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "combinator": "and",
          "conditions": [
            {
              "id": "c4cd3177-e9ec-41e6-b816-8d1c10259e90",
              "operator": {
                "type": "boolean",
                "operation": "false",
                "singleValue": true
              },
              "leftValue": "={{ $json.isArchived }}",
              "rightValue": false
            }
          ]
        }
      },
      "typeVersion": 2.3
    },
    {
      "id": "542df680-a30d-4911-a171-ef0f8756c802",
      "name": "keep only workflows not archived1",
      "type": "n8n-nodes-base.filter",
      "position": [
        6000,
        2992
      ],
      "parameters": {
        "options": {},
        "conditions": {
          "options": {
            "version": 3,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "combinator": "and",
          "conditions": [
            {
              "id": "c4cd3177-e9ec-41e6-b816-8d1c10259e90",
              "operator": {
                "type": "boolean",
                "operation": "false",
                "singleValue": true
              },
              "leftValue": "={{ $json.isArchived }}",
              "rightValue": false
            }
          ]
        }
      },
      "typeVersion": 2.3
    },
    {
      "id": "9eb5293a-239c-4a55-aaf0-534ae9d04301",
      "name": "add wf_folder_name",
      "type": "n8n-nodes-base.set",
      "position": [
        7088,
        3008
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "cc2d4972-7616-4fd9-a753-911a58696cec",
              "name": "wf_folder_name",
              "type": "string",
              "value": "={{ $json.parentFolder.name }}"
            }
          ]
        },
        "includeOtherFields": true
      },
      "typeVersion": 3.4
    },
    {
      "id": "2bf58b1a-dd01-4d2e-8eb7-cfaeb7af907a",
      "name": "remove the [] wrapper to re-create imported wf later",
      "type": "n8n-nodes-base.code",
      "notes": "remove the [] wrapper to re-create imported wf",
      "position": [
        8512,
        3072
      ],
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "return $json.data"
      },
      "notesInFlow": true,
      "typeVersion": 2
    },
    {
      "id": "6da35838-625d-4946-91a3-d824b9d8f767",
      "name": "n8n-auth for n8n API",
      "type": "n8n-nodes-base.set",
      "position": [
        464,
        1088
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "6b1740b2-6608-458e-987a-c5193fe90c0e",
              "name": "n8n-auth",
              "type": "string",
              "value": "={{ $json.headers[\"set-cookie\"][0] }}"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "b85e1a76-c677-45ae-a951-7111c1f2344b",
      "name": "Convert workflow to JSON file",
      "type": "n8n-nodes-base.convertToFile",
      "position": [
        8976,
        2928
      ],
      "parameters": {
        "mode": "each",
        "options": {
          "fileName": "={{ $json.name }}"
        },
        "operation": "toJson"
      },
      "typeVersion": 1.1
    },
    {
      "id": "23f8f662-0981-4d87-a65b-27b5322ea043",
      "name": "Upload file to gdrive main root folder",
      "type": "n8n-nodes-base.googleDrive",
      "maxTries": 3,
      "position": [
        9808,
        2768
      ],
      "parameters": {
        "name": "={{ $binary.data.fileName }}",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "options": {},
        "folderId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('rename fields7').item.json.google_folder_id }}"
        }
      },
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "ipWSglDR3WeYHBf5",
          "name": "Google Drive account"
        }
      },
      "retryOnFail": true,
      "typeVersion": 3,
      "waitBetweenTries": 5000
    },
    {
      "id": "f5dd2c4b-afe4-4f5e-bc7f-4003318457e8",
      "name": "Sticky Note10",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1680,
        496
      ],
      "parameters": {
        "width": 784,
        "height": 1120,
        "content": "## Backup n8n workflows to Google Drive with automatic cleanup\n\nThis template solves that for any n8n setup (cloud or self hosted)  by exporting a perfect mirrored setup of a whole n8n project, preserving the nested folder structure and the workflows within it. \n\n\n## Who’s it for\nThis workflow is ideal for any n8n user, from beginner to advanced solo/team “flowgrammer” who wants to have a reliable, safe, automated and easy to access backup solution that reflects a perfect mirror of their n8n setup. \n\n## What it does\n* **Scheduled Execution**: The workflow runs automatically according to the schedule, could be up to X times a day (or can be triggered manually).\n\n* **Creates backup Folder**: It creates a new overall backup folder with a naming convention as `n8n_backup_folder_structure_DDMMYYYY_HHmmss` (i.e “n8n_backup_folder_structure_02022026_123343”) where the whole n8n nested folder structure along with workflows (JSON files) will be saved.\n\nFor example if an n8n workflow instance look like this, then same structure will be preserved and reflected on google drive along with the workflows within each folder : \n\n\n```\n \nprojects-root-folder/\n\t└── Your-project-folder-name/\n\t\t└── Utilities/\n└──Error_management/\n\t└── error_alerting.json\n└──Log_analysis/\n└── Reports/\n\t└── Clients/\n\t\t└──Client_A/\n\t\t└──Client_B/\n└── client_reporting_standard.json\n       └── ...\n└── workflow_test.json\n```\n## How to set up\n1.  **Configure Credentials**: Make sure you have valid credentials for:\n    * **n8n API**: To allow the workflow to access its own list of workflows.\n    * **Google Drive**: To allow the workflow to create folders and upload files.\n\n2.  **Set Your Variables**: In the first `Set` node named **\"n8n instance/project access details\"**:\n    * `n8n_instance_URL`: Paste your n8n instance URL without the “/” at the end. For example : https://myautomations.app.n8n.cloud\n    * `emailOrLdapLoginId`: your login email address\n    * `password`: your password\n\n3.  **Create your main backup folder**: Create on your google drive space the main folder where all your backup will be uploaded. For example “my_n8n_backup” and then select it in the node “Create backup folder \"n8n_backup_folder_structure_ddMMyyyy_HHmmss\"” from the List under “Parent Folder”,\n\n## You're all set to lauch the workflow !"
      },
      "typeVersion": 1
    },
    {
      "id": "e29c0c51-1b51-48a9-8538-53f913414b3c",
      "name": "n8n instance/project access details",
      "type": "n8n-nodes-base.set",
      "position": [
        -336,
        1088
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "9a4ebecf-d383-40d8-966f-c5db06ea0aaf",
              "name": "n8n_instance_URL",
              "type": "string",
              "value": "xxxxx"
            },
            {
              "id": "982bcee4-6bc4-4eae-b468-6a25e8b9215e",
              "name": "emailOrLdapLoginId",
              "type": "string",
              "value": "xxxxx"
            },
            {
              "id": "ec91ebf5-ab0a-4565-8abe-ad29c040a1fe",
              "name": "password",
              "type": "string",
              "value": "xxxx"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "8e9f019e-a48d-484a-91a0-5e1e55d216d7",
      "name": "Sticky Note15",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -416,
        976
      ],
      "parameters": {
        "color": 3,
        "width": 288,
        "height": 272,
        "content": "## Add your n8n URL and credentials here\n### URL without the \"/\" at the end\n"
      },
      "typeVersion": 1
    },
    {
      "id": "60372854-c402-4b58-aea2-4e9931cc89c2",
      "name": "create n8n table \"folders\"",
      "type": "n8n-nodes-base.httpRequest",
      "onError": "continueErrorOutput",
      "position": [
        1232,
        -32
      ],
      "parameters": {
        "url": "={{ $('n8n instance/project access details').item.json.n8n_instance_URL }}/rest/projects/{{ $json.data[0].id }}/data-tables",
        "method": "POST",
        "options": {},
        "jsonBody": "{\n  \"name\":\"folders\",\n  \"columns\":[],\n  \"hasHeaders\":true\n}",
        "sendBody": true,
        "sendHeaders": true,
        "specifyBody": "json",
        "headerParameters": {
          "parameters": [
            {
              "name": "Cookie",
              "value": "={{ $('n8n-auth for n8n API').item.json[\"n8n-auth\"] }}"
            }
          ]
        }
      },
      "typeVersion": 4.3
    },
    {
      "id": "30f3b04c-9739-41bd-8b29-eec8e8ffbe0e",
      "name": "create n8n table \"workflows\"",
      "type": "n8n-nodes-base.httpRequest",
      "onError": "continueErrorOutput",
      "position": [
        1264,
        544
      ],
      "parameters": {
        "url": "={{ $('n8n instance/project access details').item.json.n8n_instance_URL }}/rest/projects/{{ $json.data[0].id }}/data-tables",
        "method": "POST",
        "options": {},
        "jsonBody": "{\n  \"name\":\"workflows\",\n  \"columns\":[],\n  \"hasHeaders\":true\n}",
        "sendBody": true,
        "sendHeaders": true,
        "specifyBody": "json",
        "headerParameters": {
          "parameters": [
            {
              "name": "Cookie",
              "value": "={{ $('n8n-auth for n8n API').item.json[\"n8n-auth\"] }}"
            }
          ]
        }
      },
      "typeVersion": 4.3
    },
    {
      "id": "ae42de8f-155f-49ca-a61b-ce7b0cc97abe",
      "name": "\"folders\" table columns list",
      "type": "n8n-nodes-base.code",
      "position": [
        1520,
        -48
      ],
      "parameters": {
        "jsCode": "// Define your field names\nconst fields = [\n  \"folderId\",\n  \"folderName\",\n  \"folderType\",\n  \"parentFolderName\",\n  \"parentFolderId\",\n  \"workflowCount\",\n  \"subFolderCount\",\n  \"google_folder_id\",\n  \"parent_google_folderid\",\n  \"main_root_folder_name\",\n  \"main_root_folder_google_folder_id\",\n  \"full_path\"\n];\n\n// Return a flat array of items (each as an object with 'json')\nreturn fields.map(field => {\n  return { json: { name: field, type: \"string\" } };\n});\n"
      },
      "typeVersion": 2
    },
    {
      "id": "a9f65691-5465-44e9-aa31-f0faf22ae11e",
      "name": "\"workflows\" table columns list",
      "type": "n8n-nodes-base.code",
      "position": [
        1536,
        528
      ],
      "parameters": {
        "jsCode": "// Define the 9 field names\nconst fields = [\n  \"workflow_id\",\n  \"workflow_name\",\n  \"folder_name\",\n  \"folder_id\",\n  \"parentFolderName\",\n  \"parentFolderId\",\n  \"full_path\",\n  \"workflow_google_file_id\",\n  \"folder_google_id\"\n];\n\n// Return one item per field\nreturn fields.map(field => {\n  return { json: { name: field, type: \"string\" } };\n});\n"
      },
      "typeVersion": 2
    },
    {
      "id": "ba8dda5a-d0a5-4940-9ad5-45a5e0dd96b7",
      "name": "get projectId",
      "type": "n8n-nodes-base.httpRequest",
      "onError": "continueErrorOutput",
      "position": [
        912,
        272
      ],
      "parameters": {
        "url": "={{ $('n8n instance/project access details').item.json.n8n_instance_URL }}/rest/projects",
        "options": {},
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Cookie",
              "value": "={{ $json[\"n8n-auth\"] }}"
            }
          ]
        }
      },
      "typeVersion": 4.3
    },
    {
      "id": "c4136acf-042f-4052-966b-f27678c154e9",
      "name": "add columns to \"folders\" table",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        1760,
        -48
      ],
      "parameters": {
        "url": "={{ $('n8n instance/project access details').item.json.n8n_instance_URL }}/rest/projects/{{ $('get projectId').item.json.data[0].id }}/data-tables/{{ $('create n8n table \"folders\"').item.json.data.id }}/columns",
        "method": "POST",
        "options": {},
        "jsonBody": "={{ $json }}",
        "sendBody": true,
        "sendHeaders": true,
        "specifyBody": "json",
        "headerParameters": {
          "parameters": [
            {
              "name": "Cookie",
              "value": "={{ $('n8n-auth for n8n API').item.json[\"n8n-auth\"] }}"
            }
          ]
        }
      },
      "typeVersion": 4.3
    },
    {
      "id": "09719b22-787b-4f6e-b8a8-f6a166d5767b",
      "name": "add columns to \"workflows\" table",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        1776,
        528
      ],
      "parameters": {
        "url": "={{ $('n8n instance/project access details').item.json.n8n_instance_URL }}/rest/projects/{{ $('get projectId').item.json.data[0].id }}/data-tables/{{ $('create n8n table \"workflows\"').item.json.data.id }}/columns",
        "method": "POST",
        "options": {},
        "jsonBody": "={{ $json }}",
        "sendBody": true,
        "sendHeaders": true,
        "specifyBody": "json",
        "headerParameters": {
          "parameters": [
            {
              "name": "Cookie",
              "value": "={{ $('n8n-auth for n8n API').item.json[\"n8n-auth\"] }}"
            }
          ]
        }
      },
      "typeVersion": 4.3
    },
    {
      "id": "ffe0c949-f1a2-424c-9062-eee5166488dd",
      "name": "get all folders2",
      "type": "n8n-nodes-base.dataTable",
      "position": [
        6000,
        1056
      ],
      "parameters": {
        "operation": "get",
        "returnAll": true,
        "dataTableId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Use dataTableIds for \"folders\" & \"workflows\"').item.json.folders_dataTableId }}"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "5d288e33-5c69-454f-9830-4ff6ca52f467",
      "name": "add backup_folder google_id to \"folders\"",
      "type": "n8n-nodes-base.dataTable",
      "position": [
        6368,
        864
      ],
      "parameters": {
        "columns": {
          "value": {},
          "schema": [
            {
              "id": "subFolderCount",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "subFolderCount",
              "defaultMatch": false
            },
            {
              "id": "folderName",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "folderName",
              "defaultMatch": false
            },
            {
              "id": "main_root_folder_google_folder_id",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "main_root_folder_google_folder_id",
              "defaultMatch": false
            },
            {
              "id": "full_path",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "full_path",
              "defaultMatch": false
            },
            {
              "id": "folderId",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "folderId",
              "defaultMatch": false
            },
            {
              "id": "main_root_folder_name",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "main_root_folder_name",
              "defaultMatch": false
            },
            {
              "id": "parent_google_folderid",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "parent_google_folderid",
              "defaultMatch": false
            },
            {
              "id": "google_folder_id",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "google_folder_id",
              "defaultMatch": false
            },
            {
              "id": "parentFolderId",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "parentFolderId",
              "defaultMatch": false
            },
            {
              "id": "folderType",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "folderType",
              "defaultMatch": false
            },
            {
              "id": "parentFolderName",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "parentFolderName",
              "defaultMatch": false
            },
            {
              "id": "workflowCount",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "workflowCount",
              "defaultMatch": false
            }
          ],
          "mappingMode": "autoMapInputData",
          "matchingColumns": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "filters": {
          "conditions": [
            {
              "keyName": "folderName",
              "keyValue": "={{ $json.folderName }}"
            }
          ]
        },
        "options": {},
        "operation": "upsert",
        "dataTableId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Use dataTableIds for \"folders\" & \"workflows\"').item.json.folders_dataTableId }}"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "a7b4bbd9-614e-4705-9aed-c4c7ce6ee2cb",
      "name": "Add data about folder : google_folder_id1",
      "type": "n8n-nodes-base.dataTable",
      "position": [
        10592,
        768
      ],
      "parameters": {
        "columns": {
          "value": {},
          "schema": [
            {
              "id": "subFolderCount",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "subFolderCount",
              "defaultMatch": false
            },
            {
              "id": "folderName",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "folderName",
              "defaultMatch": false
            },
            {
              "id": "main_root_folder_google_folder_id",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "main_root_folder_google_folder_id",
              "defaultMatch": false
            },
            {
              "id": "full_path",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "full_path",
              "defaultMatch": false
            },
            {
              "id": "folderId",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "folderId",
              "defaultMatch": false
            },
            {
              "id": "main_root_folder_name",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "main_root_folder_name",
              "defaultMatch": false
            },
            {
              "id": "parent_google_folderid",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "parent_google_folderid",
              "defaultMatch": false
            },
            {
              "id": "google_folder_id",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "google_folder_id",
              "defaultMatch": false
            },
            {
              "id": "parentFolderId",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "parentFolderId",
              "defaultMatch": false
            },
            {
              "id": "folderType",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "folderType",
              "defaultMatch": false
            },
            {
              "id": "parentFolderName",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "parentFolderName",
              "defaultMatch": false
            },
            {
              "id": "workflowCount",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "workflowCount",
              "defaultMatch": false
            }
          ],
          "mappingMode": "autoMapInputData",
          "matchingColumns": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "filters": {
          "conditions": [
            {
              "keyName": "folderName",
              "keyValue": "={{ $json.folderName }}"
            }
          ]
        },
        "options": {},
        "operation": "upsert",
        "dataTableId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Use dataTableIds for \"folders\" & \"workflows\"').item.json.folders_dataTableId }}"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "7f18d1b6-aae3-4a7a-a888-e1fa04e2225d",
      "name": "get  parent_google_folderid value",
      "type": "n8n-nodes-base.dataTable",
      "position": [
        9888,
        1088
      ],
      "parameters": {
        "filters": {
          "conditions": [
            {
              "keyName": "folderName",
              "keyValue": "={{ $json.parentFolder }}"
            }
          ]
        },
        "operation": "get",
        "returnAll": true,
        "dataTableId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Use dataTableIds for \"folders\" & \"workflows\"').item.json.folders_dataTableId }}"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "2bfeff9b-6c03-48fc-ba9b-03165a76f4da",
      "name": "get all folders1",
      "type": "n8n-nodes-base.dataTable",
      "position": [
        5680,
        1936
      ],
      "parameters": {
        "operation": "get",
        "returnAll": true,
        "dataTableId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Use dataTableIds for \"folders\" & \"workflows\"').item.json.folders_dataTableId }}"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "40959868-2327-4f12-965d-4cef319aa33c",
      "name": "parentFolder",
      "type": "n8n-nodes-base.dataTable",
      "position": [
        6640,
        1952
      ],
      "parameters": {
        "filters": {
          "conditions": [
            {
              "keyName": "folderName",
              "keyValue": "={{ $json.directParentFolderName }}"
            }
          ]
        },
        "operation": "get",
        "returnAll": true,
        "dataTableId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Use dataTableIds for \"folders\" & \"workflows\"').item.json.folders_dataTableId }}"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "edc5622f-360e-41f2-b6b7-d24af882eb8c",
      "name": "Upsert row(s)4",
      "type": "n8n-nodes-base.dataTable",
      "position": [
        7680,
        1808
      ],
      "parameters": {
        "columns": {
          "value": {},
          "schema": [
            {
              "id": "subFolderCount",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "subFolderCount",
              "defaultMatch": false
            },
            {
              "id": "folderName",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "folderName",
              "defaultMatch": false
            },
            {
              "id": "main_root_folder_google_folder_id",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "main_root_folder_google_folder_id",
              "defaultMatch": false
            },
            {
              "id": "full_path",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "full_path",
              "defaultMatch": false
            },
            {
              "id": "folderId",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "folderId",
              "defaultMatch": false
            },
            {
              "id": "main_root_folder_name",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "main_root_folder_name",
              "defaultMatch": false
            },
            {
              "id": "parent_google_folderid",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "parent_google_folderid",
              "defaultMatch": false
            },
            {
              "id": "google_folder_id",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "google_folder_id",
              "defaultMatch": false
            },
            {
              "id": "parentFolderId",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "parentFolderId",
              "defaultMatch": false
            },
            {
              "id": "folderType",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "folderType",
              "defaultMatch": false
            },
            {
              "id": "parentFolderName",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "parentFolderName",
              "defaultMatch": false
            },
            {
              "id": "workflowCount",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "workflowCount",
              "defaultMatch": false
            }
          ],
          "mappingMode": "autoMapInputData",
          "matchingColumns": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "filters": {
          "conditions": [
            {
              "keyName": "folderName",
              "keyValue": "={{ $json.folderName }}"
            }
          ]
        },
        "options": {},
        "operation": "upsert",
        "dataTableId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Use dataTableIds for \"folders\" & \"workflows\"').item.json.folders_dataTableId }}"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "d008fc5f-d83b-4c49-afec-b048b2ec3c64",
      "name": "Upsert row(s)5",
      "type": "n8n-nodes-base.dataTable",
      "position": [
        7680,
        2160
      ],
      "parameters": {
        "columns": {
          "value": {},
          "schema": [
            {
              "id": "subFolderCount",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "subFolderCount",
              "defaultMatch": false
            },
            {
              "id": "folderName",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "folderName",
              "defaultMatch": false
            },
            {
              "id": "main_root_folder_google_folder_id",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "main_root_folder_google_folder_id",
              "defaultMatch": false
            },
            {
              "id": "full_path",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "full_path",
              "defaultMatch": false
            },
            {
              "id": "folderId",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "folderId",
              "defaultMatch": false
            },
            {
              "id": "main_root_folder_name",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "main_root_folder_name",
              "defaultMatch": false
            },
            {
              "id": "parent_google_folderid",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "parent_google_folderid",
              "defaultMatch": false
            },
            {
              "id": "google_folder_id",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "google_folder_id",
              "defaultMatch": false
            },
            {
              "id": "parentFolderId",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "parentFolderId",
              "defaultMatch": false
            },
            {
              "id": "folderType",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "folderType",
              "defaultMatch": false
            },
            {
              "id": "parentFolderName",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "parentFolderName",
              "defaultMatch": false
            },
            {
              "id": "workflowCount",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "workflowCount",
              "defaultMatch": false
            }
          ],
          "mappingMode": "autoMapInputData",
          "matchingColumns": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "filters": {
          "conditions": [
            {
              "keyName": "folderName",
              "keyValue": "={{ $json.folderName }}"
            }
          ]
        },
        "options": {},
        "operation": "upsert",
        "dataTableId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Use dataTableIds for \"folders\" & \"workflows\"').item.json.folders_dataTableId }}"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "d33372f5-8355-4829-9d97-2de00c5e8881",
      "name": "Get row(s)3",
      "type": "n8n-nodes-base.dataTable",
      "position": [
        7216,
        2704
      ],
      "parameters": {
        "limit": "=1",
        "operation": "get",
        "dataTableId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Use dataTableIds for \"folders\" & \"workflows\"').item.json.folders_dataTableId }}"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "41574184-5846-4391-8e4b-6d4543bd1f61",
      "name": "get main root folder details1",
      "type": "n8n-nodes-base.dataTable",
      "position": [
        7488,
        2832
      ],
      "parameters": {
        "filters": {
          "conditions": [
            {
              "keyName": "folder_name",
              "keyValue": "root folder"
            }
          ]
        },
        "operation": "get",
        "returnAll": true,
        "dataTableId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Use dataTableIds for \"folders\" & \"workflows\"').item.json.workflows_dataTableId }}"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "a0ddc061-ca4f-484f-bc06-e1e23155ebe6",
      "name": "get related folder details1",
      "type": "n8n-nodes-base.dataTable",
      "position": [
        6944,
        3184
      ],
      "parameters": {
        "filters": {
          "conditions": [
            {
              "keyName": "folderName",
              "keyValue": "={{ $json.parentFolder ? $json.parentFolder.name : 'NA' }}"
            }
          ]
        },
        "operation": "get",
        "returnAll": true,
        "dataTableId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Use dataTableIds for \"folders\" & \"workflows\"').item.json.folders_dataTableId }}"
        }
      },
      "typeVersion": 1,
      "alwaysOutputData": true
    },
    {
      "id": "33f1e445-5844-4151-a915-bfdf68ee96df",
      "name": "add workflow file and folder google IDs2",
      "type": "n8n-nodes-base.dataTable",
      "position": [
        10016,
        2768
      ],
      "parameters": {
        "columns": {
          "value": {
            "workflow_name": "={{ $json.name }}",
            "folder_google_id": "={{ $json.parents[0] }}",
            "workflow_google_file_id": "={{ $json.id }}"
          },
          "schema": [
            {
              "id": "folder_id",
              "type": "string",
              "display": true,
              "removed": true,
              "readOnly": false,
              "required": false,
              "displayName": "folder_id",
              "defaultMatch": false
            },
            {
              "id": "folder_google_id",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "folder_google_id",
              "defaultMatch": false
            },
            {
              "id": "folder_name",
              "type": "string",
              "display": true,
              "removed": true,
              "readOnly": false,
              "required": false,
              "displayName": "folder_name",
              "defaultMatch": false
            },
            {
              "id": "workflow_id",
              "type": "string",
              "display": true,
              "removed": true,
              "readOnly": false,
              "required": false,
              "displayName": "workflow_id",
              "defaultMatch": false
            },
            {
              "id": "full_path",
              "type": "string",
              "display": true,
              "removed": true,
              "readOnly": false,
              "required": false,
              "displayName": "full_path",
              "defaultMatch": false
            },
            {
              "id": "workflow_google_file_id",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "workflow_google_file_id",
              "defaultMatch": false
            },
            {
              "id": "parentFolderName",
              "type": "string",
              "display": true,
              "removed": true,
              "readOnly": false,
              "required": false,
              "displayName": "parentFolderName",
              "defaultMatch": false
            },
            {
              "id": "workflow_name",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "workflow_name",
              "defaultMatch": false
            },
            {
              "id": "parentFolderId",
              "type": "string",
              "display": true,
              "removed": true,
              "readOnly": false,
              "required": false,
              "displayName": "parentFolderId",
              "defaultMatch": false
            }
          ],
          "mappingMode": "defineBelow",
          "matchingColumns": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "filters": {
          "conditions": [
            {
              "keyName": "workflow_name",
              "keyValue": "={{ $json.name }}"
            }
          ]
        },
        "options": {},
        "operation": "update",
        "dataTableId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Use dataTableIds for \"folders\" & \"workflows\"').item.json.workflows_dataTableId }}"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "994e3ed3-c144-4389-8600-2329cacb2e87",
      "name": "add workflow file and folder google IDs",
      "type": "n8n-nodes-base.dataTable",
      "position": [
        10096,
        3136
      ],
      "parameters": {
        "columns": {
          "value": {
            "workflow_name": "={{ $json.name }}",
            "folder_google_id": "={{ $json.parents[0] }}",
            "workflow_google_file_id": "={{ $json.id }}"
          },
          "schema": [
            {
              "id": "folder_id",
              "type": "string",
              "display": true,
              "removed": true,
              "readOnly": false,
              "required": false,
              "displayName": "folder_id",
              "defaultMatch": false
            },
            {
              "id": "folder_google_id",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "folder_google_id",
              "defaultMatch": false
            },
            {
              "id": "folder_name",
              "type": "string",
              "display": true,
              "removed": true,
              "readOnly": false,
              "required": false,
              "displayName": "folder_name",
              "defaultMatch": false
            },
            {
              "id": "workflow_id",
              "type": "string",
              "display": true,
              "removed": true,
              "readOnly": false,
              "required": false,
              "displayName": "workflow_id",
              "defaultMatch": false
            },
            {
              "id": "full_path",
              "type": "string",
              "display": true,
              "removed": true,
              "readOnly": false,
              "required": false,
              "displayName": "full_path",
              "defaultMatch": false
            },
            {
              "id": "workflow_google_file_id",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "workflow_google_file_id",
              "defaultMatch": false
            },
            {
              "id": "parentFolderName",
              "type": "string",
              "display": true,
              "removed": true,
              "readOnly": false,
              "required": false,
              "displayName": "parentFolderName",
              "defaultMatch": false
            },
            {
              "id": "workflow_name",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "workflow_name",
              "defaultMatch": false
            },
            {
              "id": "parentFolderId",
              "type": "string",
              "display": true,
              "removed": true,
              "readOnly": false,
              "required": false,
              "displayName": "parentFolderId",
              "defaultMatch": false
            }
          ],
          "mappingMode": "defineBelow",
          "matchingColumns": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "filters": {
          "conditions": [
            {
              "keyName": "workflow_name",
              "keyValue": "={{ $json.name }}"
            }
          ]
        },
        "options": {},
        "operation": "update",
        "dataTableId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Use dataTableIds for \"folders\" & \"workflows\"').item.json.workflows_dataTableId }}"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "3f39516d-4637-42bb-bab4-2d7d8ce877d9",
      "name": "Add data about folder : google_folder_id",
      "type": "n8n-nodes-base.dataTable",
      "position": [
        10928,
        1072
      ],
      "parameters": {
        "columns": {
          "value": {},
          "schema": [
            {
              "id": "subFolderCount",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "subFolderCount",
              "defaultMatch": false
            },
            {
              "id": "folderName",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "folderName",
              "defaultMatch": false
            },
            {
              "id": "main_root_folder_google_folder_id",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "main_root_folder_google_folder_id",
              "defaultMatch": false
            },
            {
              "id": "full_path",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "full_path",
              "defaultMatch": false
            },
            {
              "id": "folderId",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "folderId",
              "defaultMatch": false
            },
            {
              "id": "main_root_folder_name",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "main_root_folder_name",
              "defaultMatch": false
            },
            {
              "id": "parent_google_folderid",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "parent_google_folderid",
              "defaultMatch": false
            },
            {
              "id": "google_folder_id",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "google_folder_id",
              "defaultMatch": false
            },
            {
              "id": "parentFolderId",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "parentFolderId",
              "defaultMatch": false
            },
            {
              "id": "folderType",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "folderType",
              "defaultMatch": false
            },
            {
              "id": "parentFolderName",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "parentFolderName",
              "defaultMatch": false
            },
            {
              "id": "workflowCount",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "workflowCount",
              "defaultMatch": false
            }
          ],
          "mappingMode": "autoMapInputData",
          "matchingColumns": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "filters": {
          "conditions": [
            {
              "keyName": "folderName",
              "keyValue": "={{ $json.folderName }}"
            }
          ]
        },
        "options": {},
        "operation": "upsert",
        "dataTableId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Use dataTableIds for \"folders\" & \"workflows\"').item.json.folders_dataTableId }}"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "0a2c60bf-5a4b-4b32-b9ec-b4f323f5780a",
      "name": "exclude field \"id\"",
      "type": "n8n-nodes-base.set",
      "position": [
        7376,
        3184
      ],
      "parameters": {
        "include": "except",
        "options": {},
        "excludeFields": "id",
        "includeOtherFields": true
      },
      "typeVersion": 3.4
    },
    {
      "id": "a707ef0f-a370-4ae0-a415-e46f67fba187",
      "name": "Sticky Note16",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        880,
        -128
      ],
      "parameters": {
        "color": 6,
        "width": 1648,
        "height": 1232,
        "content": "# 2/ Create the n8n data tables \"folders\" & \"workflows\""
      },
      "typeVersion": 1
    },
    {
      "id": "096fc147-74d2-4dd7-8688-f79f10514f66",
      "name": "Purge data in \"folders\"",
      "type": "n8n-nodes-base.dataTable",
      "position": [
        2016,
        352
      ],
      "parameters": {
        "filters": {
          "conditions": [
            {
              "keyValue": "0",
              "condition": "gte"
            }
          ]
        },
        "options": {},
        "operation": "deleteRows",
        "dataTableId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $json[\"data.data\"].id }}"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "c2b8911b-b57b-43a0-8040-741a3610716d",
      "name": "Sticky Note17",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -48,
        864
      ],
      "parameters": {
        "width": 672,
        "height": 416,
        "content": "## Connect to the account using API to get the \"set-cookie\" token value returned from the header that will later be used to authenticate with n8n API : \n\n### {{ $json.headers[\"set-cookie\"][0] }}\n"
      },
      "typeVersion": 1
    },
    {
      "id": "1e871cc8-0afa-4aaa-9380-d0365f317479",
      "name": "Sticky Note18",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1216,
        -496
      ],
      "parameters": {
        "width": 912,
        "height": 320,
        "content": "## n8n tables used to store the folder/subfolders and workflow structure details\n\n### We use n8n table instead of google sheet because gsheet has a very limitative API quotas limit that will slow down the workflow execution : 60 requests per minute per project per user\n### Gsheet API quotas limit here : https://developers.google.com/workspace/sheets/api/limits\n### While n8n table can accept much more data at once without failing\n"
      },
      "typeVersion": 1
    },
    {
      "id": "910196ac-5119-4b3b-9ad2-a77f2d2acc52",
      "name": "Insert data into table \"folders\"",
      "type": "n8n-nodes-base.dataTable",
      "position": [
        4640,
        1056
      ],
      "parameters": {
        "columns": {
          "value": {},
          "schema": [
            {
              "id": "main_root_folder_google_folder_id",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "main_root_folder_google_folder_id",
              "defaultMatch": false
            },
            {
              "id": "subFolderCount",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "subFolderCount",
              "defaultMatch": false
            },
            {
              "id": "folderType",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "folderType",
              "defaultMatch": false
            },
            {
              "id": "parentFolderName",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "parentFolderName",
              "defaultMatch": false
            },
            {
              "id": "parentFolderId",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "parentFolderId",
              "defaultMatch": false
            },
            {
              "id": "full_path",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "full_path",
              "defaultMatch": false
            },
            {
              "id": "workflowCount",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "workflowCount",
              "defaultMatch": false
            },
            {
              "id": "parent_google_folderid",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "parent_google_folderid",
              "defaultMatch": false
            },
            {
              "id": "folderId",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "folderId",
              "defaultMatch": false
            },
            {
              "id": "folderName",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "folderName",
              "defaultMatch": false
            },
            {
              "id": "main_root_folder_name",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "main_root_folder_name",
              "defaultMatch": false
            },
            {
              "id": "google_folder_id",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "google_folder_id",
              "defaultMatch": false
            }
          ],
          "mappingMode": "autoMapInputData",
          "matchingColumns": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "filters": {
          "conditions": [
            {
              "keyName": "folderName",
              "keyValue": "={{ $json.folderName }}"
            }
          ]
        },
        "options": {},
        "operation": "upsert",
        "dataTableId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Use dataTableIds for \"folders\" & \"workflows\"').item.json.folders_dataTableId }}"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "c2031d14-e395-4b6f-a014-ddb001ed18fb",
      "name": "Get all folders",
      "type": "n8n-nodes-base.dataTable",
      "position": [
        5728,
        -176
      ],
      "parameters": {
        "operation": "get",
        "returnAll": true,
        "dataTableId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Use dataTableIds for \"folders\" & \"workflows\"').item.json.folders_dataTableId }}"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "6227887d-2399-4dcf-b77e-89bae6bdcf05",
      "name": "Insert \"full_path\" value for each folder",
      "type": "n8n-nodes-base.dataTable",
      "position": [
        6240,
        -176
      ],
      "parameters": {
        "columns": {
          "value": {},
          "schema": [
            {
              "id": "subFolderCount",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "subFolderCount",
              "defaultMatch": false
            },
            {
              "id": "folderName",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "folderName",
              "defaultMatch": false
            },
            {
              "id": "main_root_folder_google_folder_id",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "main_root_folder_google_folder_id",
              "defaultMatch": false
            },
            {
              "id": "full_path",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "full_path",
              "defaultMatch": false
            },
            {
              "id": "folderId",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "folderId",
              "defaultMatch": false
            },
            {
              "id": "main_root_folder_name",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "main_root_folder_name",
              "defaultMatch": false
            },
            {
              "id": "parent_google_folderid",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "parent_google_folderid",
              "defaultMatch": false
            },
            {
              "id": "google_folder_id",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "google_folder_id",
              "defaultMatch": false
            },
            {
              "id": "parentFolderId",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "parentFolderId",
              "defaultMatch": false
            },
            {
              "id": "folderType",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "folderType",
              "defaultMatch": false
            },
            {
              "id": "parentFolderName",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "parentFolderName",
              "defaultMatch": false
            },
            {
              "id": "workflowCount",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "workflowCount",
              "defaultMatch": false
            }
          ],
          "mappingMode": "autoMapInputData",
          "matchingColumns": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "filters": {
          "conditions": [
            {
              "keyName": "folderName",
              "keyValue": "={{ $json.folderName }}"
            }
          ]
        },
        "options": {},
        "operation": "upsert",
        "dataTableId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Use dataTableIds for \"folders\" & \"workflows\"').item.json.folders_dataTableId }}"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "b95a02af-5864-4dcd-82c0-04e74fc8181c",
      "name": "Match workflow with folder details",
      "type": "n8n-nodes-base.dataTable",
      "position": [
        6960,
        320
      ],
      "parameters": {
        "filters": {
          "conditions": [
            {
              "keyName": "folderId",
              "keyValue": "={{ $json.data.parentFolder ? $json.data.parentFolder.id : '0' }}"
            }
          ]
        },
        "operation": "get",
        "returnAll": true,
        "dataTableId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Use dataTableIds for \"folders\" & \"workflows\"').item.json.folders_dataTableId }}"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "3b345bf0-1c4d-4dbe-9461-e2459dda3d88",
      "name": "Insert workflow details into \"workflows\" table",
      "type": "n8n-nodes-base.dataTable",
      "position": [
        8224,
        224
      ],
      "parameters": {
        "columns": {
          "value": {},
          "schema": [
            {
              "id": "folder_id",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "folder_id",
              "defaultMatch": false
            },
            {
              "id": "folder_google_id",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "folder_google_id",
              "defaultMatch": false
            },
            {
              "id": "folder_name",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "folder_name",
              "defaultMatch": false
            },
            {
              "id": "workflow_id",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "workflow_id",
              "defaultMatch": false
            },
            {
              "id": "full_path",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "full_path",
              "defaultMatch": false
            },
            {
              "id": "workflow_google_file_id",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "workflow_google_file_id",
              "defaultMatch": false
            },
            {
              "id": "parentFolderName",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "parentFolderName",
              "defaultMatch": false
            },
            {
              "id": "workflow_name",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "workflow_name",
              "defaultMatch": false
            },
            {
              "id": "parentFolderId",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "parentFolderId",
              "defaultMatch": false
            }
          ],
          "mappingMode": "autoMapInputData",
          "matchingColumns": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "filters": {
          "conditions": [
            {
              "keyName": "workflow_id",
              "keyValue": "={{ $json.workflow_id }}"
            }
          ]
        },
        "options": {},
        "operation": "upsert",
        "dataTableId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Use dataTableIds for \"folders\" & \"workflows\"').item.json.workflows_dataTableId }}"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "9747e84a-bc88-4d98-9eac-6e163d3c1940",
      "name": "Sticky Note19",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        6672,
        688
      ],
      "parameters": {
        "width": 1216,
        "height": 640,
        "content": "## We order the folders to be created on google drive by ascending order based on \"full_path\" length value : \n\n### The smallest full_path length will be the first.\n### We start from the top root folders, and go down into the folders' path level by level,\n### For example for the below structure : \n\n```\n├── Utilities/\n_________└──Error_management\n_________└──Log_analysis\n├── Reports/\n_________└──Clients\n__________________└──Client_A\n__________________└──Client_B\n__________________└──etc\n```\n\n### The processing order will be as below :\n\n1. Utilities : full_path = 1\n2. Reports : full_path = 1\n3. Error_management : full_path = 2\n4. Log_analysis : full_path = 2\n5. Clients : full_path = 2\n6. Client_A : full_path = 3\n7. Client_B : full_path = 3\n"
      },
      "typeVersion": 1
    },
    {
      "id": "749420e2-c29f-4656-8b55-4453c3ecb978",
      "name": "Get the parentFolderName if it exists",
      "type": "n8n-nodes-base.dataTable",
      "position": [
        8256,
        800
      ],
      "parameters": {
        "limit": 1,
        "filters": {
          "conditions": [
            {
              "keyName": "folderName",
              "keyValue": "={{ $json.parentFolderName }}"
            }
          ]
        },
        "operation": "get",
        "dataTableId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Use dataTableIds for \"folders\" & \"workflows\"').item.json.folders_dataTableId }}"
        }
      },
      "typeVersion": 1,
      "alwaysOutputData": true
    },
    {
      "id": "72a59751-51e2-4737-be98-35d7f392c5f0",
      "name": "get parentFolderId if it exists",
      "type": "n8n-nodes-base.set",
      "position": [
        8496,
        800
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "7fd1e7ab-97d9-4c5b-a780-7c122f0840b0",
              "name": "=parent_google_folder_Id",
              "type": "string",
              "value": "={{ Object.keys($json).length === 0  ? $('Create backup folder \"n8n_backup_folder_structure_ddMMyyyy_HHmmss\"').item.json.id : $json.google_folder_id  }}"
            },
            {
              "id": "e53f2bef-2ab1-4cef-95fb-96ca1120a0f6",
              "name": "parent_folderName",
              "type": "string",
              "value": "={{ $json.parentFolderName }}"
            }
          ]
        },
        "includeOtherFields": true
      },
      "typeVersion": 3.4
    },
    {
      "id": "ab1f6c8e-b132-47c6-811e-2b031b65dc93",
      "name": "Sticky Note20",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        7632,
        1664
      ],
      "parameters": {
        "width": 1024,
        "height": 640,
        "content": "## We get the id of each created folder into google drive (previous step) and assign the value to corresponding folder name in \"folders\" table\n\n"
      },
      "typeVersion": 1
    },
    {
      "id": "04569e71-a969-406d-ae76-b56949cec793",
      "name": "Sticky Note21",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        6496,
        2496
      ],
      "parameters": {
        "width": 3648,
        "height": 80,
        "content": "## Branch for workflow(s) at the main_root of your project"
      },
      "typeVersion": 1
    },
    {
      "id": "fb6b344c-022c-419c-8bc5-3a92d3ca8407",
      "name": "Sticky Note22",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        6512,
        3344
      ],
      "parameters": {
        "width": 3664,
        "height": 80,
        "content": "## Branch for workflow(s) under at list one folder of your project"
      },
      "typeVersion": 1
    },
    {
      "id": "038cf8c9-c8e2-416c-8601-ec7ea861e29e",
      "name": "Get each workflow JSON data",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        8240,
        2944
      ],
      "parameters": {
        "url": "={{ $('n8n instance/project access details').item.json.n8n_instance_URL }}/rest/workflows/{{ $json.id }}",
        "options": {},
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Cookie",
              "value": "={{ $('n8n-auth for n8n API').item.json[\"n8n-auth\"] }}"
            }
          ]
        }
      },
      "typeVersion": 4.3
    },
    {
      "id": "3df5fa30-f739-41a0-ad27-2e06c8e25962",
      "name": "GET each workflow JSON data",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        6480,
        208
      ],
      "parameters": {
        "url": "={{ $('n8n instance/project access details').item.json.n8n_instance_URL }}/rest/workflows/{{ $json.id }}",
        "options": {},
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Cookie",
              "value": "={{ $('n8n-auth for n8n API').item.json[\"n8n-auth\"] }}"
            }
          ]
        }
      },
      "typeVersion": 4.3
    },
    {
      "id": "eaceb550-3bea-4e39-bc8e-927f01c41ecf",
      "name": "Aggregate",
      "type": "n8n-nodes-base.aggregate",
      "position": [
        6576,
        2720
      ],
      "parameters": {
        "options": {},
        "aggregate": "aggregateAllItemData"
      },
      "typeVersion": 1
    },
    {
      "id": "16fd3a60-760d-40ad-a94b-d31aeb3261fd",
      "name": "Insert one row in \"folders\" for the main_root_backup_folder",
      "type": "n8n-nodes-base.dataTable",
      "position": [
        7472,
        2624
      ],
      "parameters": {
        "columns": {
          "value": {
            "folderId": "NA",
            "full_path": "/",
            "folderName": "main_root_backup_folder",
            "folderType": "main_root",
            "workflowCount": "NA",
            "parentFolderId": "NA",
            "subFolderCount": "NA",
            "google_folder_id": "={{ $json.main_root_folder_google_folder_id }}",
            "parentFolderName": "NA",
            "main_root_folder_name": "NA",
            "parent_google_folderid": "NA",
            "main_root_folder_google_folder_id": "NA"
          },
          "schema": [
            {
              "id": "subFolderCount",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "subFolderCount",
              "defaultMatch": false
            },
            {
              "id": "folderName",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "folderName",
              "defaultMatch": false
            },
            {
              "id": "main_root_folder_google_folder_id",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "main_root_folder_google_folder_id",
              "defaultMatch": false
            },
            {
              "id": "full_path",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "full_path",
              "defaultMatch": false
            },
            {
              "id": "folderId",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "folderId",
              "defaultMatch": false
            },
            {
              "id": "main_root_folder_name",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "main_root_folder_name",
              "defaultMatch": false
            },
            {
              "id": "parent_google_folderid",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "parent_google_folderid",
              "defaultMatch": false
            },
            {
              "id": "google_folder_id",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "google_folder_id",
              "defaultMatch": false
            },
            {
              "id": "parentFolderId",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "parentFolderId",
              "defaultMatch": false
            },
            {
              "id": "folderType",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "folderType",
              "defaultMatch": false
            },
            {
              "id": "parentFolderName",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "parentFolderName",
              "defaultMatch": false
            },
            {
              "id": "workflowCount",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "workflowCount",
              "defaultMatch": false
            }
          ],
          "mappingMode": "defineBelow",
          "matchingColumns": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {},
        "dataTableId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Use dataTableIds for \"folders\" & \"workflows\"').item.json.folders_dataTableId }}"
        }
      },
      "executeOnce": true,
      "typeVersion": 1
    },
    {
      "id": "44dd20e1-3648-4bea-b4b8-9d550aed1fc2",
      "name": "get n8n table \"id\"",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        1392,
        256
      ],
      "parameters": {
        "url": "={{ $('n8n instance/project access details').item.json.n8n_instance_URL }}/rest/projects/{{ $('get projectId').item.json.data[0].id }}/data-tables",
        "options": {},
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Cookie",
              "value": "={{ $('n8n-auth for n8n API').item.json['n8n-auth'] }}"
            }
          ]
        }
      },
      "typeVersion": 4.3
    },
    {
      "id": "498e9dac-5af4-4340-ba35-69f57b453446",
      "name": "Split Out",
      "type": "n8n-nodes-base.splitOut",
      "position": [
        1600,
        256
      ],
      "parameters": {
        "include": "allOtherFields",
        "options": {},
        "fieldToSplitOut": "data.data"
      },
      "typeVersion": 1
    },
    {
      "id": "dc511cb1-5268-490b-8e5d-05297c8e5b89",
      "name": "get n8n table \"id\"1",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        1408,
        832
      ],
      "parameters": {
        "url": "={{ $('n8n instance/project access details').item.json.n8n_instance_URL }}/rest/projects/{{ $('get projectId').item.json.data[0].id }}/data-tables",
        "options": {},
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Cookie",
              "value": "={{ $('n8n-auth for n8n API').item.json['n8n-auth'] }}"
            }
          ]
        }
      },
      "typeVersion": 4.3
    },
    {
      "id": "f70596fd-5049-4662-a737-cd8b2591e53b",
      "name": "Split Out2",
      "type": "n8n-nodes-base.splitOut",
      "position": [
        1616,
        832
      ],
      "parameters": {
        "include": "allOtherFields",
        "options": {},
        "fieldToSplitOut": "data.data"
      },
      "typeVersion": 1
    },
    {
      "id": "2abcd1e5-9872-4398-bf56-01817e1b9c56",
      "name": "Filter on \"folders\" table",
      "type": "n8n-nodes-base.filter",
      "position": [
        1808,
        256
      ],
      "parameters": {
        "options": {},
        "conditions": {
          "options": {
            "version": 3,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "combinator": "and",
          "conditions": [
            {
              "id": "a4fab1f0-abfa-4a62-aafd-15b54f498ad4",
              "operator": {
                "type": "string",
                "operation": "equals"
              },
              "leftValue": "={{ $json[\"data.data\"].name }}",
              "rightValue": "=folders"
            }
          ]
        }
      },
      "typeVersion": 2.3
    },
    {
      "id": "fc39223c-44c1-4f5b-b3b6-108f5add1311",
      "name": "Filter on \"workflows\" table",
      "type": "n8n-nodes-base.filter",
      "position": [
        1824,
        832
      ],
      "parameters": {
        "options": {},
        "conditions": {
          "options": {
            "version": 3,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "combinator": "and",
          "conditions": [
            {
              "id": "a4fab1f0-abfa-4a62-aafd-15b54f498ad4",
              "operator": {
                "type": "string",
                "operation": "equals"
              },
              "leftValue": "={{ $json[\"data.data\"].name }}",
              "rightValue": "=workflows"
            }
          ]
        }
      },
      "typeVersion": 2.3
    },
    {
      "id": "7fcf4576-ce0d-4915-9409-d434ace3b7af",
      "name": "Purge data in \"workflows\"",
      "type": "n8n-nodes-base.dataTable",
      "position": [
        2016,
        912
      ],
      "parameters": {
        "filters": {
          "conditions": [
            {
              "keyValue": "0",
              "condition": "gte"
            }
          ]
        },
        "options": {},
        "operation": "deleteRows",
        "dataTableId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $json[\"data.data\"].id }}"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "2d5246d5-1666-4257-aee9-35b691fad2e2",
      "name": "dataTableId \"folders\"",
      "type": "n8n-nodes-base.set",
      "position": [
        2576,
        96
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "86c7b475-8f0e-4003-b032-7645735ec0d6",
              "name": "folders_dataTableId",
              "type": "string",
              "value": "={{ $json[\"data.data\"] ? $json[\"data.data\"].id : $json.data.dataTableId }}"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "27f482ad-f392-4a19-b18f-ebc115faecfa",
      "name": "dataTableId \"workflows\"",
      "type": "n8n-nodes-base.set",
      "position": [
        2592,
        672
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "86c7b475-8f0e-4003-b032-7645735ec0d6",
              "name": "workflows_dataTableId",
              "type": "string",
              "value": "={{ $json[\"data.data\"] ? $json[\"data.data\"].id : $json.data.dataTableId }}"
            }
          ]
        }
      },
      "typeVersion": 3.4
    },
    {
      "id": "c5bdbbf0-7fbd-4ffb-bdba-8aa721a65a63",
      "name": "Merge dataTableIds for \"folders\" & \"workflows\"",
      "type": "n8n-nodes-base.merge",
      "position": [
        2816,
        384
      ],
      "parameters": {
        "mode": "combine",
        "options": {},
        "combineBy": "combineByPosition"
      },
      "typeVersion": 3.2
    },
    {
      "id": "8f5abf8e-71b4-499e-adca-705ce3bf2ac5",
      "name": "Use dataTableIds for \"folders\" & \"workflows\"",
      "type": "n8n-nodes-base.merge",
      "position": [
        3280,
        1072
      ],
      "parameters": {
        "mode": "combine",
        "options": {},
        "combineBy": "combineByPosition"
      },
      "typeVersion": 3.2
    },
    {
      "id": "fa12dad5-457d-4844-94a2-09aef3fcef3c",
      "name": "Loop Over Items",
      "type": "n8n-nodes-base.splitInBatches",
      "position": [
        6992,
        2720
      ],
      "parameters": {
        "options": {}
      },
      "typeVersion": 3
    },
    {
      "id": "5db5fb21-64f9-4458-98c5-8aebc35d13de",
      "name": "one item per workflow at main_root_folder",
      "type": "n8n-nodes-base.code",
      "position": [
        6768,
        2720
      ],
      "parameters": {
        "jsCode": "// This code generates 5 items with index values from 1 to 5\nconst items = [];\n\nfor (let i = 1; i <= $input.first().json.data.length ; i++) {\n  items.push({\n    json: {\n      index: i\n    }\n  });\n}\n\nreturn items;\n"
      },
      "typeVersion": 2
    },
    {
      "id": "c47adb94-e5e8-4158-a09c-b05cc826c3c0",
      "name": "Sticky Note23",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        5472,
        944
      ],
      "parameters": {
        "color": 3,
        "width": 496,
        "height": 288,
        "content": "## Create manually your google drive folder \"backup_n8n\" and select it in this node"
      },
      "typeVersion": 1
    },
    {
      "id": "601c7ebe-97fd-45a7-a819-36ac78b8e481",
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2544,
        -80
      ],
      "parameters": {
        "width": 512,
        "height": 944,
        "content": "## Capture both n8n dataTableId for \"folders\" and \"workflows\" to be used later on in n8n \"data table\" nodes to refer each table"
      },
      "typeVersion": 1
    }
  ],
  "active": true,
  "pinData": {},
  "settings": {
    "binaryMode": "separate",
    "callerPolicy": "workflowsFromSameOwner",
    "errorWorkflow": "PwSXDoLTZJ4OOmnR",
    "timeSavedMode": "fixed",
    "availableInMCP": false,
    "executionOrder": "v1"
  },
  "versionId": "82b056dc-24ae-45b5-b30c-31145d81bfa0",
  "connections": {
    "Merge": {
      "main": [
        [
          {
            "node": "Remove Duplicates",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge1": {
      "main": [
        [
          {
            "node": "Remove Duplicates2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge2": {
      "main": [
        [
          {
            "node": "Convert workflow to JSON file",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge3": {
      "main": [
        [
          {
            "node": "define full_path length",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge4": {
      "main": [
        [
          {
            "node": "Remove Duplicates1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge5": {
      "main": [
        [
          {
            "node": "rename fields7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge6": {
      "main": [
        [
          {
            "node": "Create folder under the parentFolder",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate": {
      "main": [
        [
          {
            "node": "one item per workflow at main_root_folder",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out": {
      "main": [
        [
          {
            "node": "Filter on \"folders\" table",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate3": {
      "main": [
        [
          {
            "node": "get all workflows",
            "type": "main",
            "index": 0
          },
          {
            "node": "Get all folders",
            "type": "main",
            "index": 0
          },
          {
            "node": "Create backup folder \"n8n_backup_folder_structure_ddMMyyyy_HHmmss\"",
            "type": "main",
            "index": 0
          },
          {
            "node": "get all folders1",
            "type": "main",
            "index": 0
          },
          {
            "node": "get all workflows1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out1": {
      "main": [
        [
          {
            "node": "If resource == \"folder\"",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out2": {
      "main": [
        [
          {
            "node": "Filter on \"workflows\" table",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out3": {
      "main": [
        [
          {
            "node": "keep only workflows not archived1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s)3": {
      "main": [
        [
          {
            "node": "Insert one row in \"folders\" for the main_root_backup_folder",
            "type": "main",
            "index": 0
          },
          {
            "node": "get main root folder details1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "parentFolder": {
      "main": [
        [
          {
            "node": "rename fields5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get projectId": {
      "main": [
        [
          {
            "node": "create n8n table \"folders\"",
            "type": "main",
            "index": 0
          },
          {
            "node": "create n8n table \"workflows\"",
            "type": "main",
            "index": 0
          }
        ],
        []
      ]
    },
    "rename fields": {
      "main": [
        [
          {
            "node": "Insert workflow details into \"workflows\" table",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "n8n login API1": {
      "main": [
        [
          {
            "node": "n8n-auth for n8n API",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "rename fields1": {
      "main": [
        [
          {
            "node": "Insert data into table \"folders\"",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "rename fields2": {
      "main": [
        [
          {
            "node": "Add data about folder : google_folder_id1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "rename fields3": {
      "main": [
        [
          {
            "node": "Add data about folder : google_folder_id",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "rename fields4": {
      "main": [
        [
          {
            "node": "Upsert row(s)5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "rename fields5": {
      "main": [
        [
          {
            "node": "Merge4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "rename fields6": {
      "main": [
        [
          {
            "node": "Upsert row(s)4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "rename fields7": {
      "main": [
        [
          {
            "node": "Get each workflow JSON data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get all folders": {
      "main": [
        [
          {
            "node": "Define & assign folder's fullPath value",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [
          {
            "node": "Get row(s)3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "wf_id + wf_name": {
      "main": [
        [
          {
            "node": "Merge2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "n8n instance/project access details",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get all folders1": {
      "main": [
        [
          {
            "node": "get directParentFolderName",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get all folders2": {
      "main": [
        [
          {
            "node": "Merge3",
            "type": "main",
            "index": 1
          },
          {
            "node": "rename main_root_folder fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Remove Duplicates": {
      "main": [
        [
          {
            "node": "rename fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get all workflows": {
      "main": [
        [
          {
            "node": "extract each workflow",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "One run per folder": {
      "main": [
        [],
        [
          {
            "node": "Get the parentFolderName if it exists",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Remove Duplicates1": {
      "main": [
        [
          {
            "node": "rename fields4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Remove Duplicates2": {
      "main": [
        [
          {
            "node": "Get each workflow JSON data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "add wf_folder_name": {
      "main": [
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "exclude field \"id\"": {
      "main": [
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "get all workflows1": {
      "main": [
        [
          {
            "node": "Split Out3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get n8n table \"id\"": {
      "main": [
        [
          {
            "node": "Split Out",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get n8n table \"id\"1": {
      "main": [
        [
          {
            "node": "Split Out2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "n8n-auth for n8n API": {
      "main": [
        [
          {
            "node": "get projectId",
            "type": "main",
            "index": 0
          },
          {
            "node": "get subfolder(s) structure",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "dataTableId \"folders\"": {
      "main": [
        [
          {
            "node": "Merge dataTableIds for \"folders\" & \"workflows\"",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "extract each workflow": {
      "main": [
        [
          {
            "node": "keep only workflows not archived",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "if parentFolder empty": {
      "main": [
        [
          {
            "node": "Create folder under the static \"backup_n8n\" folder",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Merge6",
            "type": "main",
            "index": 0
          },
          {
            "node": "get  parent_google_folderid value",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If parentFolder is null": {
      "main": [
        [
          {
            "node": "root folder : backup_n8n",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "root folder : backup_n8n1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If resource == \"folder\"": {
      "main": [
        [
          {
            "node": "rename fields1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "dataTableId \"workflows\"": {
      "main": [
        [
          {
            "node": "Merge dataTableIds for \"folders\" & \"workflows\"",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "define full_path length": {
      "main": [
        [
          {
            "node": "Sort to get root folders first",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split root vs subfolders": {
      "main": [
        [
          {
            "node": "rename fields6",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Merge4",
            "type": "main",
            "index": 1
          },
          {
            "node": "parentFolder",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "root folder : backup_n8n": {
      "main": [
        [
          {
            "node": "Upload file to gdrive main root folder",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Filter on \"folders\" table": {
      "main": [
        [
          {
            "node": "Purge data in \"folders\"",
            "type": "main",
            "index": 0
          },
          {
            "node": "dataTableId \"folders\"",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Upload file to its folder": {
      "main": [
        [
          {
            "node": "add workflow file and folder google IDs",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "root folder : backup_n8n1": {
      "main": [
        [
          {
            "node": "Upload file to its folder",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "create n8n table \"folders\"": {
      "main": [
        [
          {
            "node": "\"folders\" table columns list",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "get n8n table \"id\"",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get directParentFolderName": {
      "main": [
        [
          {
            "node": "Split root vs subfolders",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get subfolder(s) structure": {
      "main": [
        [
          {
            "node": "Use dataTableIds for \"folders\" & \"workflows\"",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Filter on \"workflows\" table": {
      "main": [
        [
          {
            "node": "Purge data in \"workflows\"",
            "type": "main",
            "index": 0
          },
          {
            "node": "dataTableId \"workflows\"",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "GET each workflow JSON data": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          },
          {
            "node": "Match workflow with folder details",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get each workflow JSON data": {
      "main": [
        [
          {
            "node": "wf_id + wf_name",
            "type": "main",
            "index": 0
          },
          {
            "node": "remove the [] wrapper to re-create imported wf later",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get related folder details1": {
      "main": [
        [
          {
            "node": "exclude field \"id\"",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "\"folders\" table columns list": {
      "main": [
        [
          {
            "node": "add columns to \"folders\" table",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "create n8n table \"workflows\"": {
      "main": [
        [
          {
            "node": "\"workflows\" table columns list",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "get n8n table \"id\"1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert workflow to JSON file": {
      "main": [
        [
          {
            "node": "If parentFolder is null",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get main root folder details1": {
      "main": [
        [
          {
            "node": "Merge5",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "\"workflows\" table columns list": {
      "main": [
        [
          {
            "node": "add columns to \"workflows\" table",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Attach the parentFolder if any": {
      "main": [
        [
          {
            "node": "if parentFolder empty",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Sort to get root folders first": {
      "main": [
        [
          {
            "node": "One run per folder",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "add columns to \"folders\" table": {
      "main": [
        [
          {
            "node": "dataTableId \"folders\"",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "rename main_root_folder fields": {
      "main": [
        [
          {
            "node": "add backup_folder google_id to \"folders\"",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If there parentFolder.isEmpty()": {
      "main": [
        [
          {
            "node": "Aggregate",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "add wf_folder_name",
            "type": "main",
            "index": 0
          },
          {
            "node": "get related folder details1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search if folder already exists": {
      "main": [
        [
          {
            "node": "if folder not found => create it",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get parentFolderId if it exists": {
      "main": [
        [
          {
            "node": "Search if folder already exists",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Insert data into table \"folders\"": {
      "main": [
        [
          {
            "node": "Aggregate3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "add columns to \"workflows\" table": {
      "main": [
        [
          {
            "node": "dataTableId \"workflows\"",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "if folder not found => create it": {
      "main": [
        [
          {
            "node": "Attach the parentFolder if any",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "keep only workflows not archived": {
      "main": [
        [
          {
            "node": "GET each workflow JSON data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "get  parent_google_folderid value": {
      "main": [
        [
          {
            "node": "Merge6",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "keep only workflows not archived1": {
      "main": [
        [
          {
            "node": "If there parentFolder.isEmpty()",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Match workflow with folder details": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "n8n instance/project access details": {
      "main": [
        [
          {
            "node": "n8n login API1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create folder under the parentFolder": {
      "main": [
        [
          {
            "node": "rename fields3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get the parentFolderName if it exists": {
      "main": [
        [
          {
            "node": "get parentFolderId if it exists",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Upload file to gdrive main root folder": {
      "main": [
        [
          {
            "node": "add workflow file and folder google IDs2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Define & assign folder's fullPath value": {
      "main": [
        [
          {
            "node": "Insert \"full_path\" value for each folder",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Add data about folder : google_folder_id": {
      "main": [
        [
          {
            "node": "One run per folder",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "add backup_folder google_id to \"folders\"": {
      "main": [
        [
          {
            "node": "Merge3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Add data about folder : google_folder_id1": {
      "main": [
        [
          {
            "node": "One run per folder",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "one item per workflow at main_root_folder": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Use dataTableIds for \"folders\" & \"workflows\"": {
      "main": [
        [
          {
            "node": "Split Out1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge dataTableIds for \"folders\" & \"workflows\"": {
      "main": [
        [
          {
            "node": "Use dataTableIds for \"folders\" & \"workflows\"",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create folder under the static \"backup_n8n\" folder": {
      "main": [
        [
          {
            "node": "rename fields2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "remove the [] wrapper to re-create imported wf later": {
      "main": [
        [
          {
            "node": "Merge2",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Insert one row in \"folders\" for the main_root_backup_folder": {
      "main": [
        []
      ]
    },
    "Create backup folder \"n8n_backup_folder_structure_ddMMyyyy_HHmmss\"": {
      "main": [
        [
          {
            "node": "get all folders2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}