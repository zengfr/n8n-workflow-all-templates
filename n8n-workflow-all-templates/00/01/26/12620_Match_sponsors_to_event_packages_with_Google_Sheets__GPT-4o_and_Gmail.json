{
  "id": "lOjrv5FMUcjl813N",
  "meta": {
    "site": "https://github.com/zengfr/n8n-workflow-all-templates",
    "name": "Match sponsors to event packages with Google Sheets, GPT-4o and Gmail",
    "wechat": "youandme10086",
    "id": 12620,
    "update_time": "2026-02-13"
  },
  "name": "Sponsor-Package Matching Agent",
  "tags": [],
  "nodes": [
    {
      "id": "2ef0c959-c1f2-4988-a5f0-4a8d5c2ee137",
      "name": "Workflow Configuration",
      "type": "n8n-nodes-base.set",
      "position": [
        -16592,
        2240
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "id-1",
              "name": "sponsorsSheetId",
              "type": "string",
              "value": "<__PLACEHOLDER_VALUE__Google Sheets ID for Sponsors sheet__>"
            },
            {
              "id": "id-2",
              "name": "packagesSheetId",
              "type": "string",
              "value": "<__PLACEHOLDER_VALUE__Google Sheets ID for Packages sheet__>"
            },
            {
              "id": "id-3",
              "name": "logSheetId",
              "type": "string",
              "value": "<__PLACEHOLDER_VALUE__Google Sheets ID for Match Log sheet__>"
            }
          ]
        },
        "includeOtherFields": true
      },
      "typeVersion": 3.4
    },
    {
      "id": "b4511320-1417-4b1a-ba39-c0cb41fd23d1",
      "name": "Fetch Sponsors Sheet",
      "type": "n8n-nodes-base.googleSheets",
      "position": [
        -16352,
        2240
      ],
      "parameters": {
        "options": {
          "returnFirstMatch": false
        },
        "sheetName": {
          "__rl": true,
          "mode": "name",
          "value": "Sponsors"
        },
        "documentId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Workflow Configuration').first().json.sponsorsSheetId }}"
        }
      },
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "WfiC2GpB20wrykIM",
          "name": "Google Sheets account"
        }
      },
      "typeVersion": 4.7
    },
    {
      "id": "76c089d7-c997-4304-a28c-76164f08d30c",
      "name": "Fetch Packages Sheet",
      "type": "n8n-nodes-base.googleSheets",
      "position": [
        -16352,
        2416
      ],
      "parameters": {
        "options": {},
        "sheetName": {
          "__rl": true,
          "mode": "name",
          "value": "Packages"
        },
        "documentId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Workflow Configuration').first().json.packagesSheetId }}"
        }
      },
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "WfiC2GpB20wrykIM",
          "name": "Google Sheets account"
        }
      },
      "typeVersion": 4.7
    },
    {
      "id": "ae087b7f-3c54-45f6-a271-0e6dc3ff1c27",
      "name": "Aggregate Packages",
      "type": "n8n-nodes-base.aggregate",
      "position": [
        -16048,
        2416
      ],
      "parameters": {
        "options": {},
        "aggregate": "aggregateAllItemData",
        "destinationFieldName": "allPackages"
      },
      "typeVersion": 1
    },
    {
      "id": "a2188ca0-86b8-438f-87d9-c643328e0e3e",
      "name": "AI Match Packages",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "position": [
        -15520,
        2240
      ],
      "parameters": {
        "modelId": {
          "__rl": true,
          "mode": "id",
          "value": "gpt-4o"
        },
        "options": {},
        "responses": {
          "values": [
            {
              "content": "=You are an AI sponsor-package matching assistant.\n\nYour task is to analyze the sponsor details and recommend the top 1-3 most suitable sponsorship packages from the available options.\n\nSponsor Details:\n- Name: {{ $json.SponsorName }}\n- Industry: {{ $json.Industry }}\n- Budget: {{ $json.Budget }}\n- Goals: {{ $json.Goals }}\n- Notes: {{ $json.Notes }}\n\nAvailable Packages:\n{{ $json.allPackages }}\n\nFor each recommended package, provide:\n1. Package name\n2. Match score (0-100)\n3. Brief reason why it fits\n\nReturn your response as valid JSON in this exact format:\n{\n  \"recommendations\": [\n    {\n      \"packageName\": \"Package Name\",\n      \"score\": 95,\n      \"reason\": \"Brief explanation\"\n    }\n  ],\n  \"summaryText\": \"A brief summary paragraph explaining the overall recommendation strategy for this sponsor.\"\n}"
            }
          ]
        },
        "builtInTools": {}
      },
      "credentials": {
        "openAiApi": {
          "id": "ZhlmkjuQcokHH8w4",
          "name": "n8n free OpenAI API credits"
        }
      },
      "typeVersion": 2
    },
    {
      "id": "6337d359-e2e9-4f1d-824c-b1dbf1b79a6d",
      "name": "Parse AI Response",
      "type": "n8n-nodes-base.set",
      "position": [
        -15200,
        2240
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "id-1",
              "name": "aiResponse",
              "type": "object",
              "value": "={{ JSON.parse($json.message.content) }}"
            },
            {
              "id": "id-2",
              "name": "topPackage",
              "type": "string",
              "value": "={{ JSON.parse($json.message.content).recommendations[0].packageName }}"
            },
            {
              "id": "id-3",
              "name": "topScore",
              "type": "number",
              "value": "={{ JSON.parse($json.message.content).recommendations[0].score }}"
            }
          ]
        },
        "includeOtherFields": true
      },
      "typeVersion": 3.4
    },
    {
      "id": "650edd2b-198a-4322-b946-133973e9fff7",
      "name": "Log Match Results",
      "type": "n8n-nodes-base.googleSheets",
      "position": [
        -14624,
        2416
      ],
      "parameters": {
        "columns": {
          "value": {
            "TopScore": "={{ $json.matchScore }}",
            "Timestamp": "={{ $now.toISO() }}",
            "SponsorName": "={{ $json.SponsorName }}",
            "RecommendedPackages": "={{ $json.topMatches.map(m => m.packageName).join(', ') }}"
          },
          "schema": [
            {
              "id": "SponsorName",
              "required": false,
              "displayName": "SponsorName",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "RecommendedPackages",
              "required": false,
              "displayName": "RecommendedPackages",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "TopScore",
              "required": false,
              "displayName": "TopScore",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Timestamp",
              "required": false,
              "displayName": "Timestamp",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            }
          ],
          "mappingMode": "defineBelow",
          "matchingColumns": [
            "SponsorName",
            "RecommendedPackages",
            "TopScore",
            "Timestamp"
          ]
        },
        "options": {},
        "operation": "append",
        "sheetName": {
          "__rl": true,
          "mode": "name",
          "value": "MatchLog"
        },
        "documentId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $('Workflow Configuration').first().json.logSheetId }}"
        }
      },
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "WfiC2GpB20wrykIM",
          "name": "Google Sheets account"
        }
      },
      "typeVersion": 4.7
    },
    {
      "id": "fc545f80-989f-4589-8f8d-25eb3cfb93db",
      "name": "Loop Over Sponsors",
      "type": "n8n-nodes-base.splitInBatches",
      "position": [
        -16048,
        2240
      ],
      "parameters": {
        "options": {
          "reset": false
        }
      },
      "typeVersion": 3
    },
    {
      "id": "60703abb-672a-454c-966b-9fc3561802a2",
      "name": "Merge Sponsor with Packages",
      "type": "n8n-nodes-base.merge",
      "position": [
        -15856,
        2240
      ],
      "parameters": {
        "mode": "combine",
        "options": {
          "includeUnpaired": true
        },
        "combineBy": "combineByPosition"
      },
      "typeVersion": 3.2
    },
    {
      "id": "6d9a3ca2-e933-44c4-b422-a90f7ed9e953",
      "name": "Prepare AI Context",
      "type": "n8n-nodes-base.set",
      "position": [
        -15696,
        2240
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "id-1",
              "name": "allPackages",
              "type": "string",
              "value": "={{ $input.last().json.allPackages }}"
            }
          ]
        },
        "includeOtherFields": true
      },
      "typeVersion": 3.4
    },
    {
      "id": "b8054279-33cf-496f-a649-caa7b82b648d",
      "name": "Parse Matches",
      "type": "n8n-nodes-base.code",
      "position": [
        -15040,
        2240
      ],
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "const aiOutput = $json.message?.content || $json.aiResponse;\nlet matches;\n\ntry {\n  matches = typeof aiOutput === 'string' ? JSON.parse(aiOutput) : aiOutput;\n} catch (e) {\n  matches = { recommendations: [] };\n}\n\nconst topMatches = matches.recommendations?.slice(0, 3) || [];\nconst bestPackage = topMatches[0] || {};\nconst matchScore = bestPackage.score || 0;\n\nreturn {\n  json: {\n    ...$json,\n    topMatches,\n    bestPackage,\n    matchScore,\n    aiResponse: matches\n  }\n};"
      },
      "typeVersion": 2
    },
    {
      "id": "f592bade-7bcf-4141-8488-353cd5819475",
      "name": "Filter Low Scores",
      "type": "n8n-nodes-base.if",
      "position": [
        -14880,
        2240
      ],
      "parameters": {
        "options": {},
        "conditions": {
          "options": {
            "leftValue": "",
            "caseSensitive": false,
            "typeValidation": "loose"
          },
          "combinator": "and",
          "conditions": [
            {
              "id": "id-1",
              "operator": {
                "type": "number",
                "operation": "gte"
              },
              "leftValue": "={{ $json.matchScore }}",
              "rightValue": "70"
            }
          ]
        }
      },
      "typeVersion": 2.2
    },
    {
      "id": "0e119cca-2263-448b-adee-7e9b6e1744e6",
      "name": "Send match email summary",
      "type": "n8n-nodes-base.gmail",
      "position": [
        -14624,
        2240
      ],
      "webhookId": "943c57c7-350d-4d13-af64-fce804b5f52c",
      "parameters": {
        "sendTo": "={{ $json.OwnerEmail }}",
        "message": "=<h2>Hi {{ $json.SponsorName }},</h2>\n\n<p>Based on your profile (<strong>{{ $json.Industry }}</strong>, ${{ $json.Budget }} budget), here are your top package matches:</p>\n\n<h3>Recommended Packages:</h3>\n<ul>\n{{ $json.topMatches.map(m => `<li><strong>${m.packageName}</strong> (Score: ${m.score}/100)<br><em>${m.reason}</em></li>`).join(\"\") }}\n</ul>\n\n<p><strong>Best option:</strong> {{ $json.bestPackage.packageName }}</p>\n\n<p>Reply to discuss!</p>\n\n<p><em>This recommendation was generated by AI based on your sponsor profile.</em></p>",
        "options": {},
        "subject": "=ðŸŽ¯ {{ $json.SponsorName }} - Top Package Matches (Score: {{ $json.matchScore }})"
      },
      "credentials": {
        "gmailOAuth2": {
          "id": "ln8P2XbqMlOmDZVl",
          "name": "Gmail account"
        }
      },
      "typeVersion": 2.1
    },
    {
      "id": "dc272f8b-b590-4a64-b615-a56ebc466f12",
      "cid": "Ikx1Y2FzIFBleXJpbiI",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "notes": "Â© 2025 Lucas Peyrin",
      "creator": "Lucas Peyrin",
      "position": [
        -17120,
        1680
      ],
      "parameters": {
        "width": 508,
        "height": 896,
        "content": "# **Ai sponsor matching agent**\n\n### **What it does:** \nMatches sponsors to packages using Google Sheets + GPT-4o + Gmail\n\n### **Why it matters:** \nNo hardcoded IDsâ€”100% configurable. Error-proof filtering + analytics tracking.\n\n### **How it works**\n1. Reads sponsors (Industry/Budget/Goals/Email)+Packages(Price/Benefits) from Sheets\n2. Loops 1 sponsor â†’ attaches ALL packages context  \n3. GPT-4o scores TOP3 fits (JSON: pkg/score/reason)\n4. IF score>7 â†’ personalized Gmail + log history\n\n### **Setup steps**\n- Vars: SPONSORS_SHEET_ID, PACKAGES_SHEET_ID, GMAIL_FROM, OPENAI key\n- Sheets cols: Sponsors=Name/Ind/Budget/Goals/OwnerEmail\n- Test: Add 3 sponsors/5 pkgs â†’ execute\n\n"
      },
      "typeVersion": 1
    },
    {
      "id": "931d32d3-f1bd-472f-b413-f9ffde081409",
      "cid": "Ikx1Y2FzIFBleXJpbiI",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "notes": "Â© 2025 Lucas Peyrin",
      "creator": "Lucas Peyrin",
      "position": [
        -16448,
        2032
      ],
      "parameters": {
        "color": 7,
        "width": 324,
        "height": 548,
        "content": "#### Data sources\n\nThis node reads sponsors and packages from two Google Sheets.\n\n* Sponsors: Name, lndustry, Budget, Goals, Email  \n* Packages: Name, Price, Benefits  "
      },
      "typeVersion": 1
    },
    {
      "id": "59fe7b00-714c-41e9-9164-4f05dc76d6e6",
      "cid": "Ikx1Y2FzIFBleXJpbiI",
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "notes": "Â© 2025 Lucas Peyrin",
      "creator": "Lucas Peyrin",
      "position": [
        -15568,
        2032
      ],
      "parameters": {
        "color": 7,
        "width": 324,
        "height": 548,
        "content": "#### AI matching engine\n\nIn this node, GPT analyzes sponsor profile + full package catalog, scores 1-10 + reasoning per package\n  \n1. GPT scores TOP3 (JSON)  \n2. IF >7 â†’ proceed  \n"
      },
      "typeVersion": 1
    },
    {
      "id": "2795f97a-a555-4e2b-9ec7-b40ec5b4eb8c",
      "cid": "Ikx1Y2FzIFBleXJpbiI",
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "notes": "Â© 2025 Lucas Peyrin",
      "creator": "Lucas Peyrin",
      "position": [
        -14704,
        2032
      ],
      "parameters": {
        "color": 7,
        "width": 324,
        "height": 548,
        "content": "#### Outreach + Analytics\n\nThis node:\n\n1. Sends personalized email per sponsor with top matches (Package and Score)\n\n2. Records match history : who + what + scores to Google Sheets"
      },
      "typeVersion": 1
    },
    {
      "id": "dae66de8-8af6-4190-8d1b-51f7ff57a132",
      "name": "Execute to Start",
      "type": "n8n-nodes-base.scheduleTrigger",
      "position": [
        -16912,
        2240
      ],
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "weeks",
              "triggerAtDay": [
                1,
                2,
                3,
                4,
                5
              ],
              "triggerAtHour": 9
            }
          ]
        }
      },
      "typeVersion": 1.3
    },
    {
      "id": "7e0add80-9e88-4f67-9395-ce077d5ea118",
      "cid": "Ikx1Y2FzIFBleXJpbiI",
      "name": "Sticky Note12",
      "type": "n8n-nodes-base.stickyNote",
      "notes": "Â© 2025 Lucas Peyrin",
      "creator": "Lucas Peyrin",
      "position": [
        -14256,
        1376
      ],
      "parameters": {
        "width": 540,
        "height": 1200,
        "content": "## Was this helpful? Get in touch! \n\n[![clic](https://vptkuqoipqbebipqjnqw.supabase.co/storage/v1/object/public/Milo%20Bravo/seeAxWUupcOOXY5tntexZ_video.gif)](https://tally.so/r/EkKGgB)\n\nI really hope this automation helped you. Your feedback is incredibly valuable and helps me create better resources for business and the n8n community.\n\n### **Have Feedback, a Question, or a Project Idea?**\n\nI've streamlined the way we connect. It all starts with one simple form that takes less than 10 seconds. After that, you'll chat with my AI assistant who will gather the key details and pass them directly on to me.\n\n####  **[Start the conversation here](https://tally.so/r/EkKGgB)** \n\n*   **Give Feedback:** Share your thoughts on this templateâ€”whether you found a typo, encountered an unexpected error, have a suggestion, or just want to say thanks!\n\n*   **n8n Consulting:** Have a complex business challenge or need a custom workflow built from scratch? Let's partner on a powerful automation solution tailored to your specific needs.\n\n*   **Join your team:** We can work together to get you launched with confidence. \n\n---\n\nHappy Automating!\n[Milo Bravo](https://linkedin.com/in/MiloBravo/) | BRaiA Labs | Automation & BI Systems + AI Integration\n"
      },
      "typeVersion": 1
    }
  ],
  "active": false,
  "pinData": {},
  "settings": {
    "callerPolicy": "workflowsFromSameOwner",
    "availableInMCP": false,
    "executionOrder": "v1",
    "saveManualExecutions": true,
    "saveExecutionProgress": true,
    "saveDataErrorExecution": "all"
  },
  "versionId": "5d6f9f4e-d06e-49f7-b7be-35284fc6ebef",
  "connections": {
    "Parse Matches": {
      "main": [
        [
          {
            "node": "Filter Low Scores",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Execute to Start": {
      "main": [
        [
          {
            "node": "Workflow Configuration",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Match Packages": {
      "main": [
        [
          {
            "node": "Parse AI Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Filter Low Scores": {
      "main": [
        [
          {
            "node": "Send match email summary",
            "type": "main",
            "index": 0
          },
          {
            "node": "Log Match Results",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Log Match Results": {
      "main": [
        [
          {
            "node": "Loop Over Sponsors",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse AI Response": {
      "main": [
        [
          {
            "node": "Parse Matches",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate Packages": {
      "main": [
        [
          {
            "node": "Merge Sponsor with Packages",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Loop Over Sponsors": {
      "main": [
        [
          {
            "node": "Merge Sponsor with Packages",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare AI Context": {
      "main": [
        [
          {
            "node": "AI Match Packages",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch Packages Sheet": {
      "main": [
        [
          {
            "node": "Aggregate Packages",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch Sponsors Sheet": {
      "main": [
        [
          {
            "node": "Loop Over Sponsors",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Workflow Configuration": {
      "main": [
        [
          {
            "node": "Fetch Sponsors Sheet",
            "type": "main",
            "index": 0
          },
          {
            "node": "Fetch Packages Sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge Sponsor with Packages": {
      "main": [
        [
          {
            "node": "Prepare AI Context",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}