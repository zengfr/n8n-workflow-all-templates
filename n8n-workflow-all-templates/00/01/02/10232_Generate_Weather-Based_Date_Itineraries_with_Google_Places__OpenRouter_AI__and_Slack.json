{
  "id": "jVI0RwYxGpONwzYU",
  "meta": {
    "site": "https://github.com/zengfr/n8n-workflow-all-templates",
    "name": "Generate Weather-Based Date Itineraries with Google Places, OpenRouter AI, and Slack",
    "wechat": "youandme10086",
    "id": 10232,
    "update_time": "2025-11-10"
  },
  "name": "Generate Local Date Itineraries with Google Places, AI, and Slack Sharing",
  "tags": [],
  "nodes": [
    {
      "id": "6630f4ed-c7e1-4f96-90e3-ba09ad5fb82d",
      "name": "Run Workflow Manually",
      "type": "n8n-nodes-base.manualTrigger",
      "position": [
        -2160,
        848
      ],
      "parameters": {},
      "typeVersion": 1
    },
    {
      "id": "f9a75e8b-d993-4de0-8fa3-c9325d54aedd",
      "name": "Note: Set Parameters",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2032,
        576
      ],
      "parameters": {
        "color": 7,
        "width": 288,
        "height": 192,
        "content": "## Node: Set Parameters\nConfigure the starting point and constraints.\n- `startLat`, `startLng`, `radius`, `timeLimitMin`\n- Optional: `placeType`, `language`, `minRating`.\n**Tip:** Keep API keys in **Credentials**, not here."
      },
      "typeVersion": 1
    },
    {
      "id": "18fc0230-da4f-4554-bdc3-f0ec6306d66d",
      "name": "Note: Get Nearby Spots",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1840,
        1040
      ],
      "parameters": {
        "color": 7,
        "width": 288,
        "height": 192,
        "content": "## Node: Get Nearby Spots\nCall **Google Places Nearby Search**.\n- Endpoint: `/maps/api/place/nearbysearch/json`\n- Use a **Google credential** (no inline `key=`).\n- You can change `type` (default `cafe`) and `radius`."
      },
      "typeVersion": 1
    },
    {
      "id": "3011df46-a5d8-4f24-b3f7-30a7cd57e28f",
      "name": "Note: Select Top 3 Spots",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1616,
        544
      ],
      "parameters": {
        "color": 7,
        "width": 288,
        "height": 192,
        "content": "## Node: Select Top 3 Spots\nRank and filter places.\n- Sort by rating (desc), optionally by reviews.\n- Keep top 3; drop duplicates/unrated.\n- Keep total time within `timeLimitMin` (walking)."
      },
      "typeVersion": 1
    },
    {
      "id": "087b797c-7901-4c10-9e9b-cea34aac0b17",
      "name": "Note: Create Google Maps Link",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1296,
        1168
      ],
      "parameters": {
        "color": 7,
        "width": 288,
        "height": 192,
        "content": "## Node: Create Google Maps Link\nBuild a **walking route URL** for Google Maps.\n- origin ‚Üí waypoints (top spots) ‚Üí destination\n- Embed as: `üó∫Ô∏è <https://‚Ä¶|View the route on Google Maps>`"
      },
      "typeVersion": 1
    },
    {
      "id": "a60fc744-b76c-48e1-bf1c-5b949c24c7b7",
      "name": "Note: Merge Chat + Map",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1008,
        1008
      ],
      "parameters": {
        "color": 7,
        "width": 288,
        "height": 192,
        "content": "## Node: Merge Chat + Map\nCombine the itinerary text with the route link.\n- Ensures the Slack message contains both contents."
      },
      "typeVersion": 1
    },
    {
      "id": "ca58d64e-9656-4d9f-a4e9-ee2dc6e190a3",
      "name": "Note: Slack Output",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        416,
        592
      ],
      "parameters": {
        "color": 7,
        "width": 288,
        "height": 192,
        "content": "## Node: Slack Output\nPost to Slack.\n- Set the channel (e.g., `#general`).\n- Enable `mrkdwn`, disable link/media unfurling.\n- Message = itinerary text(s) + route link."
      },
      "typeVersion": 1
    },
    {
      "id": "5509f466-b357-41b0-8a5e-0f1121f4fd56",
      "name": "Note: OpenRouter Chat Model",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1280,
        368
      ],
      "parameters": {
        "color": 7,
        "width": 288,
        "height": 192,
        "content": "## Node: OpenRouter Chat Model\nLanguage model used by **Thinking Date Plan**.\n- Set your **OpenRouter credential**.\n- Keep prompts lightweight; avoid secrets in text."
      },
      "typeVersion": 1
    },
    {
      "id": "75a671f0-ef1d-4027-a069-e2b5249f0a32",
      "name": "Note: Thinking Date Plan",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1280,
        112
      ],
      "parameters": {
        "color": 7,
        "width": 288,
        "height": 192,
        "content": "## Node: Thinking Date Plan\nGenerate a friendly itinerary in Markdown with an LLM.\n- Include: order, stay time, one-line tip.\n- Output should be Japanese; Markdown only.\n- No Google Maps URL here (added later)."
      },
      "typeVersion": 1
    },
    {
      "id": "5dc8fa19-8d00-4f4e-9b3e-2bf1d54e2430",
      "name": "Note: Run Workflow Manually",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2272,
        1008
      ],
      "parameters": {
        "color": 7,
        "width": 288,
        "height": 192,
        "content": "## Node: Run Workflow Manually\nTest the workflow with a manual trigger first.\n- Good for validation and screenshots.\n- You can later replace it with **Schedule** or **Webhook**."
      },
      "typeVersion": 1
    },
    {
      "id": "f84ce2b7-d8f9-4946-9a63-d2faaab0cc27",
      "name": "Note: Format Message for Slack",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -208,
        592
      ],
      "parameters": {
        "color": 7,
        "width": 288,
        "height": 208,
        "content": "## Node: Format Message for Slack\nPrepare a clean JSON structure for Slack.\n- Keep `text` (EN) / `text_ja` (JA) and `mapsUrl`.\n- Use concise, readable Markdown."
      },
      "typeVersion": 1
    },
    {
      "id": "c4c1a586-a48d-46c0-9705-b5927142932e",
      "name": "Note: Translate Plan (EN ‚Üî JA)",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        32,
        1056
      ],
      "parameters": {
        "color": 7,
        "width": 288,
        "height": 192,
        "content": "## Node: Translate Plan (EN ‚Üî JA)\nTranslate with **DeepL**.\n- Target: `EN-US` (you can change locale).\n- Credential required; keep **mrkdwn** rendering in mind."
      },
      "typeVersion": 1
    },
    {
      "id": "ba7edab9-f196-4fdf-a80d-fcb4b03511c0",
      "name": "Set Parameters1",
      "type": "n8n-nodes-base.set",
      "position": [
        -1936,
        848
      ],
      "parameters": {
        "values": {
          "string": [
            {
              "name": "startLat",
              "value": "35.7073"
            },
            {
              "name": "startLng",
              "value": "139.6656"
            },
            {
              "name": "radius",
              "value": "2000"
            },
            {
              "name": "timeLimitMin",
              "value": "120"
            }
          ]
        },
        "options": {}
      },
      "typeVersion": 1
    },
    {
      "id": "c799de6c-ac35-4b6e-90ea-c39d74dae838",
      "name": "Get Nearby Spots1",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        -1712,
        848
      ],
      "parameters": {
        "url": "https://maps.googleapis.com/maps/api/place/nearbysearch/json",
        "options": {},
        "queryParametersUi": {
          "parameter": [
            {
              "name": "location",
              "value": "=35.7073,139.6656"
            },
            {
              "name": "radius",
              "value": "=2000"
            },
            {
              "name": "type",
              "value": "`cafe"
            },
            {
              "name": "language",
              "value": "ja"
            },
            {
              "name": "key",
              "value": "="
            },
            {}
          ]
        }
      },
      "typeVersion": 1
    },
    {
      "id": "6d19cd88-2da3-44de-9d44-8bec779adee7",
      "name": "Select Top 3 Spots1",
      "type": "n8n-nodes-base.function",
      "position": [
        -1488,
        848
      ],
      "parameters": {
        "functionCode": "const results = $json.results || [];\nconst sorted = results\n  .map(r => ({ name: r.name, address: r.vicinity, rating: r.rating || 0, place_id: r.place_id }))\n  .sort((a,b) => b.rating - a.rating)\n  .slice(0,3);\nreturn [{ spots: sorted }];"
      },
      "typeVersion": 1
    },
    {
      "id": "11767a3b-3396-4c0b-b195-b77e69ee5c0b",
      "name": "Merge Chat + Map1",
      "type": "n8n-nodes-base.merge",
      "position": [
        -912,
        848
      ],
      "parameters": {
        "mode": "combine",
        "options": {},
        "combinationMode": "multiplex"
      },
      "typeVersion": 2
    },
    {
      "id": "06c7cd4a-2c3f-4f0a-bc74-6cf2f5d16c7a",
      "name": "Slack Output1",
      "type": "n8n-nodes-base.slack",
      "position": [
        336,
        848
      ],
      "parameters": {
        "text": "==üìò *‰ªäÊó•„ÅÆ„Éá„Éº„Éà„Éó„É©„É≥ÊèêÊ°à„Åß„ÅôÔºö*\n\nüáØüáµ *Êó•Êú¨Ë™û„Éó„É©„É≥:*\n{{$('Format Message for Slack').item.json.text_ja}}\n\n---\n\nüåê *English version:*\n{{$json.text}}\n\n{{$('Format Message for Slack').item.json.mapsUrl}}\n\nWeather:\n{{ $('AI Weather Emoji Generator').item.json.text }}",
        "channel": "#general",
        "attachments": [],
        "otherOptions": {
          "mrkdwn": true,
          "unfurl_links": false,
          "unfurl_media": false
        },
        "authentication": "oAuth2"
      },
      "credentials": {
        "slackOAuth2Api": {
          "id": "2kyw7TSL5VT4S3md",
          "name": "Slack account 8"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "e165a610-9c00-40e0-967e-07edd24abe49",
      "name": "Sticky Note17",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2784,
        448
      ],
      "parameters": {
        "width": 384,
        "height": 1504,
        "content": "## üß© What this template does\n\nThis workflow builds a 120-minute local date course around your starting point by querying Google Places for nearby spots, selecting the top candidates, fetching real-time weather data, letting an AI generate a matching emoji, and drafting a friendly itinerary summary with an LLM in both English and Japanese.\nIt then posts the full bilingual plan with a walking route link and weather emoji to Slack.\n\n## üë• Who it‚Äôs for\n\nMakers and teams who want a plug-and-play bilingual local itinerary generator with weather awareness ‚Äî no custom code required.\n\n## ‚öôÔ∏è How it works\n\nTrigger ‚Äì Manual (or schedule/webhook).\n\nDiscovery ‚Äì Google Places nearby search within a configurable radius.\n\nSelection ‚Äì Rank by rating and pick the top 3.\n\nWeather ‚Äì Fetch current weather (via OpenWeatherMap).\n\nEmoji ‚Äì Use an AI model to match the weather with an emoji üå§Ô∏è.\n\nPlanning ‚Äì An LLM writes the itinerary in Markdown (JP + EN).\n\nRoute ‚Äì Compose a Google Maps walking route URL.\n\nShare ‚Äì Post the bilingual itinerary, route link, and weather emoji to Slack.\n\n## üß∞ Requirements\n\nn8n (Cloud or self-hosted)\n\nGoogle Maps Platform (Places API)\n\nOpenWeatherMap API key\n\nSlack Bot (chat:write)\n\nLLM provider (e.g., OpenRouter or DeepL for translation)\n\n## üöÄ Setup (quick)\n\nOpen Set ‚Üí Fields: Config and fill in coords/radius/time limit.\n\nConnect Credentials for Google, OpenWeatherMap, Slack, and your LLM.\n\nTest the workflow and confirm the bilingual plan + weather emoji appear in Slack.\n\n## üõ† Customize\n\nAdjust ranking filters (type, min rating).\n\nModify translation settings (target language or tone).\n\nChange output layout (side-by-side vs separated).\n\nTune emoji logic or travel mode.\n\nAdd error handling, retries, or logging for production use."
      },
      "typeVersion": 1
    },
    {
      "id": "97a1ba3e-9bfb-484d-b27f-b3a851f00e85",
      "name": "Translate Plan (EN ‚Üî JA)1",
      "type": "n8n-nodes-base.deepL",
      "position": [
        112,
        848
      ],
      "parameters": {
        "text": "={{ $json.text }}",
        "translateTo": "EN-US",
        "additionalFields": {}
      },
      "credentials": {
        "deepLApi": {
          "id": "S5c8ArKkbeIQQU5Z",
          "name": "DeepL account 3"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "862eb4aa-3ec0-4a11-a65b-bcdd6ecff1a8",
      "name": "Thinking Date Plan1",
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "position": [
        -1264,
        592
      ],
      "parameters": {
        "text": "=‰ª•‰∏ã„ÅÆ3„Å§„ÅÆ„Çπ„Éù„ÉÉ„Éà„Çí„ÇÇ„Å®„Å´120ÂàÜ‰ª•ÂÜÖ„ÅÆ„Éá„Éº„Éà„Éó„É©„É≥„Çí‰Ωú„Å£„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ\nÂá∫Âäõ„Å´„ÅØGoogle„Éû„ÉÉ„Éó„ÅÆURL„ÅØÂê´„ÇÅ„Åö„ÄÅMarkdownÂΩ¢Âºè„Åß„Ç≥„Éº„ÇπÂÜÖÂÆπ„Å†„Åë„ÇíÊõ∏„ÅÑ„Å¶„Åè„Å†„Åï„ÅÑ\n\n„Çπ„Éù„ÉÉ„ÉàÊÉÖÂ†±:\n1. {{$json.spots[0].name}}Ôºà‰ΩèÊâÄÔºö{{$json.spots[0].address}}ÔºèË©ï‰æ°Ôºö{{$json.spots[0].rating}}Ôºâ\n2. {{$json.spots[1].name}}Ôºà‰ΩèÊâÄÔºö{{$json.spots[1].address}}ÔºèË©ï‰æ°Ôºö{{$json.spots[1].rating}}Ôºâ\n3. {{$json.spots[2].name}}Ôºà‰ΩèÊâÄÔºö{{$json.spots[2].address}}ÔºèË©ï‰æ°Ôºö{{$json.spots[2].rating}}Ôºâ\n",
        "batching": {},
        "messages": {
          "messageValues": [
            {
              "message": "„ÅÇ„Å™„Åü„ÅØÊù±‰∫¨„ÅÆ„Éá„Éº„Éà„Ç≥„É≥„Ç∑„Çß„É´„Ç∏„É•„Åß„Åô„ÄÇ„É¶„Éº„Ç∂„Éº„ÅåË®™„Çå„Çã„Çπ„Éù„ÉÉ„ÉàÊÉÖÂ†±„Çí„ÇÇ„Å®„Å´„ÄÅ120ÂàÜ‰ª•ÂÜÖ„ÅßÊ•Ω„Åó„ÇÅ„Çã„Éá„Éº„Éà„Ç≥„Éº„Çπ„ÇíÊèêÊ°à„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇË°å„ÅçÈ†Ü„ÉªÊªûÂú®ÊôÇÈñì„Éª‰∏ÄË®Ä„Ç≥„É°„É≥„Éà„ÇíÂê´„ÇÅ„ÄÅ„ÇÑ„Åï„Åó„ÅÑÊó•Êú¨Ë™û„ÅßMarkdownÂΩ¢Âºè„ÅßÂá∫Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ"
            },
            {
              "type": "HumanMessagePromptTemplate",
              "message": "‰ª•‰∏ã„ÅÆ„Çπ„Éù„ÉÉ„ÉàÊÉÖÂ†±„Çí„ÇÇ„Å®„Å´„ÄÅ120ÂàÜ‰ª•ÂÜÖ„ÅßÁÑ°ÁêÜ„Å™„ÅèÂõû„Çå„ÇãÈ†ÜÂ∫è„ÅÆ„Éá„Éº„Éà„Éó„É©„É≥„Çí‰Ωú„Å£„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ{{JSON.stringify($json.spots, null, 2)}}"
            }
          ]
        },
        "promptType": "define"
      },
      "typeVersion": 1.7
    },
    {
      "id": "2b87cd1c-3c95-4eb5-ad53-eb69c2e5441a",
      "name": "OpenRouter Chat Model1",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "position": [
        -1200,
        816
      ],
      "parameters": {
        "options": {}
      },
      "credentials": {
        "openRouterApi": {
          "id": "fMR5QJezr3tD108w",
          "name": "Á∞°Êòì„Éá„É¢"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "96bb07b3-4297-4bf6-a2ea-2ca4bf2abf58",
      "name": "OpenRouter Chat Model2",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "position": [
        -400,
        1072
      ],
      "parameters": {
        "options": {}
      },
      "credentials": {
        "openRouterApi": {
          "id": "fMR5QJezr3tD108w",
          "name": "Á∞°Êòì„Éá„É¢"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "348a72b1-2474-4ef6-8934-bb63e7fe982d",
      "name": "AI Weather Emoji Generator",
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "position": [
        -464,
        848
      ],
      "parameters": {
        "text": "=Given the following weather description, output one emoji that best represents the weather condition.\n\nWeather description: {{$json.weather[0].description}}\n\nExamples:\n- clear sky ‚Üí ‚òÄÔ∏è\n- few clouds ‚Üí üå§Ô∏è\n- overcast clouds ‚Üí ‚òÅÔ∏è\n- light rain ‚Üí üå¶Ô∏è\n- heavy rain ‚Üí üåßÔ∏è\n- thunderstorm ‚Üí ‚õàÔ∏è\n- snow ‚Üí ‚ùÑÔ∏è\n- mist or fog ‚Üí üå´Ô∏è\n- haze ‚Üí üåÅ\n- wind ‚Üí üí®\n\nRespond with only one emoji, no explanation or text.",
        "batching": {},
        "messages": {
          "messageValues": [
            {
              "message": "„ÅÇ„Å™„Åü„ÅØÊù±‰∫¨„ÅÆ„Éá„Éº„Éà„Ç≥„É≥„Ç∑„Çß„É´„Ç∏„É•„Åß„Åô„ÄÇ„É¶„Éº„Ç∂„Éº„ÅåË®™„Çå„Çã„Çπ„Éù„ÉÉ„ÉàÊÉÖÂ†±„Çí„ÇÇ„Å®„Å´„ÄÅ120ÂàÜ‰ª•ÂÜÖ„ÅßÊ•Ω„Åó„ÇÅ„Çã„Éá„Éº„Éà„Ç≥„Éº„Çπ„ÇíÊèêÊ°à„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇË°å„ÅçÈ†Ü„ÉªÊªûÂú®ÊôÇÈñì„Éª‰∏ÄË®Ä„Ç≥„É°„É≥„Éà„ÇíÂê´„ÇÅ„ÄÅ„ÇÑ„Åï„Åó„ÅÑÊó•Êú¨Ë™û„ÅßMarkdownÂΩ¢Âºè„ÅßÂá∫Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ"
            },
            {
              "type": "HumanMessagePromptTemplate",
              "message": "‰ª•‰∏ã„ÅÆ„Çπ„Éù„ÉÉ„ÉàÊÉÖÂ†±„Çí„ÇÇ„Å®„Å´„ÄÅ120ÂàÜ‰ª•ÂÜÖ„ÅßÁÑ°ÁêÜ„Å™„ÅèÂõû„Çå„ÇãÈ†ÜÂ∫è„ÅÆ„Éá„Éº„Éà„Éó„É©„É≥„Çí‰Ωú„Å£„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ{{JSON.stringify($json.spots, null, 2)}}"
            }
          ]
        },
        "promptType": "define"
      },
      "typeVersion": 1.7
    },
    {
      "id": "6b309f6e-1d95-42fd-a0be-b6ea9a9ef8c4",
      "name": "Get Current Weather",
      "type": "n8n-nodes-base.openWeatherMap",
      "position": [
        -688,
        848
      ],
      "parameters": {
        "latitude": "={{ $('Get Nearby Spots1').item.json.results[0].geometry.viewport.northeast.lat }}",
        "longitude": "={{ $('Get Nearby Spots1').item.json.results[0].geometry.viewport.northeast.lng }}",
        "locationSelection": "coordinates"
      },
      "credentials": {
        "openWeatherMapApi": {
          "id": "7hhu6HhmBJSh6zIy",
          "name": "OpenWeatherMap account 3"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "b0522365-69cb-4b2d-b865-253a38d1b6a8",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -800,
        560
      ],
      "parameters": {
        "color": 7,
        "width": 320,
        "height": 256,
        "content": "## Get Current Weather\nüå¶Ô∏è Fetch current weather data from OpenWeatherMap.\n\n- Input: Coordinates (lat, lon)\n- Output: JSON (weather[0].main, weather[0].description, weather[0].icon)\n- Used for: Emoji generation and Slack summary\n\nüí°Tip: Use Metric format for ¬∞C output."
      },
      "typeVersion": 1
    },
    {
      "id": "3ad9d0b8-4961-4b47-a6f4-03cdf1d21e64",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -480,
        1248
      ],
      "parameters": {
        "color": 7,
        "width": 320,
        "height": 304,
        "content": "## AI Weather Emoji Generator\n\nü§ñ Convert weather text into a matching emoji.\n\n- Input: weather[0].main or description\n- Model: OpenRouter Chat (gpt-4o / gpt-4o-mini)\n- Output: Emoji representing the current weather\n\nExample:\n\"Clear\" ‚Üí ‚òÄÔ∏è\n\"Rain\" ‚Üí üåßÔ∏è\n\"Snow\" ‚Üí ‚ùÑÔ∏è\n\"Thunderstorm\" ‚Üí ‚õàÔ∏è"
      },
      "typeVersion": 1
    },
    {
      "id": "2309d554-5378-48a2-a443-83c36a2491c1",
      "name": "Create Google Maps Link",
      "type": "n8n-nodes-base.function",
      "position": [
        -1200,
        992
      ],
      "parameters": {
        "functionCode": "const spots = $json.spots || [];\nif (!spots.length) return { mapsUrl: 'No spots found', mrkdwn: true };\n\nconst formatSpot = (s) => {\n  const name = s.name || '';\n  const address = s.address || '';\n  \n  if (!address.includes('‰∏≠ÈáéÂå∫') && !address.includes('Êùâ‰∏¶Âå∫') && !address.includes('Êù±‰∫¨ÈÉΩ')) {\n    return `Êù±‰∫¨ÈÉΩ‰∏≠ÈáéÂå∫ ${name}`;\n  }\n  return `${name} ${address}`;\n};\n\nconst waypoints = spots.slice(0, -1).map(s => formatSpot(s)).join('|');\nconst origin = '‰∏≠ÈáéÈßÖ Êù±‰∫¨ÈÉΩ‰∏≠ÈáéÂå∫';\nconst destination = formatSpot(spots[spots.length - 1]);\n\nconst url = encodeURI(\n  `https://www.google.com/maps/dir/?api=1&origin=${origin}&destination=${destination}&travelmode=walking&waypoints=${waypoints}`\n);\n\n// üëá text ‚Üí mapsUrl „Å´Â§âÊõ¥ÔºÅ\nreturn {\n  mapsUrl: `üó∫Ô∏è <${url}|View the route on Google Maps>`,\n  mrkdwn: true\n};"
      },
      "typeVersion": 1
    },
    {
      "id": "198c0819-c27d-4bcb-9226-927cd16c28a0",
      "name": "Format Message for Slack",
      "type": "n8n-nodes-base.code",
      "position": [
        -112,
        848
      ],
      "parameters": {
        "jsCode": "return {\n  text_ja: $('Merge Chat + Map1').first().json.text,\n  text: $('Merge Chat + Map1').first().json.text,\n  mapsUrl: $('Merge Chat + Map1').first().json.mapsUrl,\n};"
      },
      "typeVersion": 2
    }
  ],
  "active": false,
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "6295df07-4c6b-47e9-95ad-014b0c73e87e",
  "connections": {
    "Set Parameters1": {
      "main": [
        [
          {
            "node": "Get Nearby Spots1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Nearby Spots1": {
      "main": [
        [
          {
            "node": "Select Top 3 Spots1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge Chat + Map1": {
      "main": [
        [
          {
            "node": "Get Current Weather",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Current Weather": {
      "main": [
        [
          {
            "node": "AI Weather Emoji Generator",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Select Top 3 Spots1": {
      "main": [
        [
          {
            "node": "Create Google Maps Link",
            "type": "main",
            "index": 0
          },
          {
            "node": "Thinking Date Plan1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Thinking Date Plan1": {
      "main": [
        [
          {
            "node": "Merge Chat + Map1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Run Workflow Manually": {
      "main": [
        [
          {
            "node": "Set Parameters1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "Thinking Date Plan1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter Chat Model2": {
      "ai_languageModel": [
        [
          {
            "node": "AI Weather Emoji Generator",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Create Google Maps Link": {
      "main": [
        [
          {
            "node": "Merge Chat + Map1",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Format Message for Slack": {
      "main": [
        [
          {
            "node": "Translate Plan (EN ‚Üî JA)1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Weather Emoji Generator": {
      "main": [
        [
          {
            "node": "Format Message for Slack",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Translate Plan (EN ‚Üî JA)1": {
      "main": [
        [
          {
            "node": "Slack Output1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}